(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["vendors~2a42e354"],{

/***/ "GAND":
/*!********************************************************************!*\
  !*** ./node_modules/aurelia-webpack-plugin/runtime/empty-entry.js ***!
  \********************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("// This file contains an empty module that does nothing.\n// It's meant to be added as an entry point to the main bundle\n// and helps reliably adding some Aurelia dependencies that are attached \n// to no module in particular, such as `includeAll` results or `aureliaApp`.\n//\n// Trying to attach those dependencies to, for example, 'aurelia-bootstrapper' \n// is unreliable if 'aurelia-bootstrapper' is in a DLL outside the bundle.\n//\n// Trying to attach to 'aurelia-loader-webpack' works well, unless a user\n// configures a customized loader instead (unlikely, but in theory supported).\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiR0FORC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9hdXJlbGlhLXdlYnBhY2stcGx1Z2luL3J1bnRpbWUvZW1wdHktZW50cnkuanM/MTgwMyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGlzIGZpbGUgY29udGFpbnMgYW4gZW1wdHkgbW9kdWxlIHRoYXQgZG9lcyBub3RoaW5nLlxuLy8gSXQncyBtZWFudCB0byBiZSBhZGRlZCBhcyBhbiBlbnRyeSBwb2ludCB0byB0aGUgbWFpbiBidW5kbGVcbi8vIGFuZCBoZWxwcyByZWxpYWJseSBhZGRpbmcgc29tZSBBdXJlbGlhIGRlcGVuZGVuY2llcyB0aGF0IGFyZSBhdHRhY2hlZCBcbi8vIHRvIG5vIG1vZHVsZSBpbiBwYXJ0aWN1bGFyLCBzdWNoIGFzIGBpbmNsdWRlQWxsYCByZXN1bHRzIG9yIGBhdXJlbGlhQXBwYC5cbi8vXG4vLyBUcnlpbmcgdG8gYXR0YWNoIHRob3NlIGRlcGVuZGVuY2llcyB0bywgZm9yIGV4YW1wbGUsICdhdXJlbGlhLWJvb3RzdHJhcHBlcicgXG4vLyBpcyB1bnJlbGlhYmxlIGlmICdhdXJlbGlhLWJvb3RzdHJhcHBlcicgaXMgaW4gYSBETEwgb3V0c2lkZSB0aGUgYnVuZGxlLlxuLy9cbi8vIFRyeWluZyB0byBhdHRhY2ggdG8gJ2F1cmVsaWEtbG9hZGVyLXdlYnBhY2snIHdvcmtzIHdlbGwsIHVubGVzcyBhIHVzZXJcbi8vIGNvbmZpZ3VyZXMgYSBjdXN0b21pemVkIGxvYWRlciBpbnN0ZWFkICh1bmxpa2VseSwgYnV0IGluIHRoZW9yeSBzdXBwb3J0ZWQpLlxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///GAND\n");

/***/ }),

/***/ "GmYv":
/*!*************************************************************************!*\
  !*** ./node_modules/aurelia-webpack-plugin/runtime/pal-loader-entry.js ***!
  \*************************************************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var aurelia_pal__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! aurelia-pal */ \"70NS\");\n// With default aurelia-loader-webpack config, this module is added as an extra entry\n// before any other code executes so that PAL.Loader is properly configured.\n// There are several tricky points worth noticing.\n// \n// We don't add aurelia-loader-webpack itself as an entry point (used to until 2.0 RC2)\n// because it (transitively) brings too much bagage with itself, most notably polyfills.\n// This made it super-hard to add other polyfills before Aurelia's and led to various bugs.\n//\n// We don't add custom code in aurelia-pal or aurelia-loader or aurelia-bootstrapper to detect\n// the Webpack environment and configure the loader because they might live in a DLL.\n// If they do, they would bring aurelia-loader-webpack along in the DLL and this is a special \n// library that *has to be in the main chunk.*\n//\n// The over-complicated design I've settled upon in the end is to use this special module\n// as an entry point that configures aurelia-loader-webpack. It has minimal static imports:\n// just aurelia-pal, which itself has no other dependencies and doesn't run much code.\n// It hacks the loader field into a getter so that it can synchronously load aurelia-loader-webpack\n// just in time when it is demanded by aurelia-bootstrapper.\n// This enables users to load polyfills before aurelia-loader-webpack is actually loaded.\n\n\n\nvar Loader;\n\nObject.defineProperty(aurelia_pal__WEBPACK_IMPORTED_MODULE_0__[\"PLATFORM\"], \"Loader\", {\n  get: function() {\n    return Loader || (Loader = __webpack_require__(/*! aurelia-loader-webpack */ \"5jyU\").WebpackLoader);\n  },\n  set: function(value) {\n    Loader = value;\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiR21Zdi5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9hdXJlbGlhLXdlYnBhY2stcGx1Z2luL3J1bnRpbWUvcGFsLWxvYWRlci1lbnRyeS5qcz8xYTY2Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIFdpdGggZGVmYXVsdCBhdXJlbGlhLWxvYWRlci13ZWJwYWNrIGNvbmZpZywgdGhpcyBtb2R1bGUgaXMgYWRkZWQgYXMgYW4gZXh0cmEgZW50cnlcbi8vIGJlZm9yZSBhbnkgb3RoZXIgY29kZSBleGVjdXRlcyBzbyB0aGF0IFBBTC5Mb2FkZXIgaXMgcHJvcGVybHkgY29uZmlndXJlZC5cbi8vIFRoZXJlIGFyZSBzZXZlcmFsIHRyaWNreSBwb2ludHMgd29ydGggbm90aWNpbmcuXG4vLyBcbi8vIFdlIGRvbid0IGFkZCBhdXJlbGlhLWxvYWRlci13ZWJwYWNrIGl0c2VsZiBhcyBhbiBlbnRyeSBwb2ludCAodXNlZCB0byB1bnRpbCAyLjAgUkMyKVxuLy8gYmVjYXVzZSBpdCAodHJhbnNpdGl2ZWx5KSBicmluZ3MgdG9vIG11Y2ggYmFnYWdlIHdpdGggaXRzZWxmLCBtb3N0IG5vdGFibHkgcG9seWZpbGxzLlxuLy8gVGhpcyBtYWRlIGl0IHN1cGVyLWhhcmQgdG8gYWRkIG90aGVyIHBvbHlmaWxscyBiZWZvcmUgQXVyZWxpYSdzIGFuZCBsZWQgdG8gdmFyaW91cyBidWdzLlxuLy9cbi8vIFdlIGRvbid0IGFkZCBjdXN0b20gY29kZSBpbiBhdXJlbGlhLXBhbCBvciBhdXJlbGlhLWxvYWRlciBvciBhdXJlbGlhLWJvb3RzdHJhcHBlciB0byBkZXRlY3Rcbi8vIHRoZSBXZWJwYWNrIGVudmlyb25tZW50IGFuZCBjb25maWd1cmUgdGhlIGxvYWRlciBiZWNhdXNlIHRoZXkgbWlnaHQgbGl2ZSBpbiBhIERMTC5cbi8vIElmIHRoZXkgZG8sIHRoZXkgd291bGQgYnJpbmcgYXVyZWxpYS1sb2FkZXItd2VicGFjayBhbG9uZyBpbiB0aGUgRExMIGFuZCB0aGlzIGlzIGEgc3BlY2lhbCBcbi8vIGxpYnJhcnkgdGhhdCAqaGFzIHRvIGJlIGluIHRoZSBtYWluIGNodW5rLipcbi8vXG4vLyBUaGUgb3Zlci1jb21wbGljYXRlZCBkZXNpZ24gSSd2ZSBzZXR0bGVkIHVwb24gaW4gdGhlIGVuZCBpcyB0byB1c2UgdGhpcyBzcGVjaWFsIG1vZHVsZVxuLy8gYXMgYW4gZW50cnkgcG9pbnQgdGhhdCBjb25maWd1cmVzIGF1cmVsaWEtbG9hZGVyLXdlYnBhY2suIEl0IGhhcyBtaW5pbWFsIHN0YXRpYyBpbXBvcnRzOlxuLy8ganVzdCBhdXJlbGlhLXBhbCwgd2hpY2ggaXRzZWxmIGhhcyBubyBvdGhlciBkZXBlbmRlbmNpZXMgYW5kIGRvZXNuJ3QgcnVuIG11Y2ggY29kZS5cbi8vIEl0IGhhY2tzIHRoZSBsb2FkZXIgZmllbGQgaW50byBhIGdldHRlciBzbyB0aGF0IGl0IGNhbiBzeW5jaHJvbm91c2x5IGxvYWQgYXVyZWxpYS1sb2FkZXItd2VicGFja1xuLy8ganVzdCBpbiB0aW1lIHdoZW4gaXQgaXMgZGVtYW5kZWQgYnkgYXVyZWxpYS1ib290c3RyYXBwZXIuXG4vLyBUaGlzIGVuYWJsZXMgdXNlcnMgdG8gbG9hZCBwb2x5ZmlsbHMgYmVmb3JlIGF1cmVsaWEtbG9hZGVyLXdlYnBhY2sgaXMgYWN0dWFsbHkgbG9hZGVkLlxuXG5pbXBvcnQgeyBQTEFURk9STSB9IGZyb20gXCJhdXJlbGlhLXBhbFwiO1xuXG52YXIgTG9hZGVyO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoUExBVEZPUk0sIFwiTG9hZGVyXCIsIHtcbiAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gTG9hZGVyIHx8IChMb2FkZXIgPSByZXF1aXJlKFwiYXVyZWxpYS1sb2FkZXItd2VicGFja1wiKS5XZWJwYWNrTG9hZGVyKTtcbiAgfSxcbiAgc2V0OiBmdW5jdGlvbih2YWx1ZSkge1xuICAgIExvYWRlciA9IHZhbHVlO1xuICB9XG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///GmYv\n");

/***/ }),

/***/ "aurelia-ui-virtualization":
/*!*************************************************************************************************!*\
  !*** ./node_modules/aurelia-ui-virtualization/dist/native-modules/aurelia-ui-virtualization.js ***!
  \*************************************************************************************************/
/*! exports provided: configure, VirtualRepeat, InfiniteScrollNext, VirtualizationEvents */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* WEBPACK VAR INJECTION */(function(Promise) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"configure\", function() { return configure; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"VirtualRepeat\", function() { return VirtualRepeat; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"InfiniteScrollNext\", function() { return InfiniteScrollNext; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"VirtualizationEvents\", function() { return VirtualizationEvents; });\n/* harmony import */ var aurelia_binding__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! aurelia-binding */ \"X5gX\");\n/* harmony import */ var aurelia_templating__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! aurelia-templating */ \"hij8\");\n/* harmony import */ var aurelia_templating_resources__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! aurelia-templating-resources */ \"aurelia-templating-resources\");\n/* harmony import */ var aurelia_pal__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! aurelia-pal */ \"70NS\");\n/* harmony import */ var aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! aurelia-dependency-injection */ \"3U8n\");\n\n\n\n\n\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nfunction __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\n\nvar rebindView = function (repeat, view, collectionIndex, collection) {\r\n    view.bindingContext[repeat.local] = collection[collectionIndex];\r\n    Object(aurelia_templating_resources__WEBPACK_IMPORTED_MODULE_2__[\"updateOverrideContext\"])(view.overrideContext, collectionIndex, collection.length);\r\n};\r\nvar rebindAndMoveView = function (repeat, view, index, moveToBottom) {\r\n    var items = repeat.items;\r\n    var viewSlot = repeat.viewSlot;\r\n    Object(aurelia_templating_resources__WEBPACK_IMPORTED_MODULE_2__[\"updateOverrideContext\"])(view.overrideContext, index, items.length);\r\n    view.bindingContext[repeat.local] = items[index];\r\n    if (moveToBottom) {\r\n        viewSlot.children.push(viewSlot.children.shift());\r\n        repeat.templateStrategy.moveViewLast(view, repeat.bottomBufferEl);\r\n    }\r\n    else {\r\n        viewSlot.children.unshift(viewSlot.children.splice(-1, 1)[0]);\r\n        repeat.templateStrategy.moveViewFirst(view, repeat.topBufferEl);\r\n    }\r\n};\r\nvar calcMinViewsRequired = function (scrollerHeight, itemHeight) {\r\n    return Math$floor(scrollerHeight / itemHeight) + 1;\r\n};\r\nvar Math$abs = Math.abs;\r\nvar Math$max = Math.max;\r\nvar Math$min = Math.min;\r\nvar Math$round = Math.round;\r\nvar Math$floor = Math.floor;\r\nvar $isNaN = isNaN;\n\nvar doc = document;\r\nvar htmlElement = doc.documentElement;\r\nvar $raf = requestAnimationFrame;\n\nvar getScrollerElement = function (element) {\r\n    var current = element.parentNode;\r\n    while (current !== null && current !== htmlElement) {\r\n        if (hasOverflowScroll(current)) {\r\n            return current;\r\n        }\r\n        current = current.parentNode;\r\n    }\r\n    return htmlElement;\r\n};\r\nvar getElementDistanceToTopOfDocument = function (element) {\r\n    var box = element.getBoundingClientRect();\r\n    var scrollTop = window.pageYOffset;\r\n    var clientTop = htmlElement.clientTop;\r\n    var top = box.top + scrollTop - clientTop;\r\n    return Math$round(top);\r\n};\r\nvar hasOverflowScroll = function (element) {\r\n    var style = window.getComputedStyle(element);\r\n    return style && (style.overflowY === 'scroll' || style.overflow === 'scroll' || style.overflowY === 'auto' || style.overflow === 'auto');\r\n};\r\nvar getStyleValues = function (element) {\r\n    var styles = [];\r\n    for (var _i = 1; _i < arguments.length; _i++) {\r\n        styles[_i - 1] = arguments[_i];\r\n    }\r\n    var currentStyle = window.getComputedStyle(element);\r\n    var value = 0;\r\n    var styleValue = 0;\r\n    for (var i = 0, ii = styles.length; ii > i; ++i) {\r\n        styleValue = parseFloat(currentStyle[styles[i]]);\r\n        value += $isNaN(styleValue) ? 0 : styleValue;\r\n    }\r\n    return value;\r\n};\r\nvar calcOuterHeight = function (element) {\r\n    var height = element.getBoundingClientRect().height;\r\n    height += getStyleValues(element, 'marginTop', 'marginBottom');\r\n    return height;\r\n};\r\nvar calcScrollHeight = function (element) {\r\n    var height = element.getBoundingClientRect().height;\r\n    height -= getStyleValues(element, 'borderTopWidth', 'borderBottomWidth');\r\n    return height;\r\n};\r\nvar insertBeforeNode = function (view, bottomBuffer) {\r\n    bottomBuffer.parentNode.insertBefore(view.lastChild, bottomBuffer);\r\n};\r\nvar getDistanceToParent = function (child, parent) {\r\n    var offsetParent = child.offsetParent;\r\n    var childOffsetTop = child.offsetTop;\r\n    if (offsetParent === null || offsetParent === parent) {\r\n        return childOffsetTop;\r\n    }\r\n    else {\r\n        if (offsetParent.contains(parent)) {\r\n            return childOffsetTop - parent.offsetTop;\r\n        }\r\n        else {\r\n            return childOffsetTop + getDistanceToParent(offsetParent, parent);\r\n        }\r\n    }\r\n};\n\nvar ArrayVirtualRepeatStrategy = (function (_super) {\r\n    __extends(ArrayVirtualRepeatStrategy, _super);\r\n    function ArrayVirtualRepeatStrategy() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    ArrayVirtualRepeatStrategy.prototype.createFirstRow = function (repeat) {\r\n        var overrideContext = Object(aurelia_templating_resources__WEBPACK_IMPORTED_MODULE_2__[\"createFullOverrideContext\"])(repeat, repeat.items[0], 0, 1);\r\n        return repeat.addView(overrideContext.bindingContext, overrideContext);\r\n    };\r\n    ArrayVirtualRepeatStrategy.prototype.initCalculation = function (repeat, items) {\r\n        var itemCount = items.length;\r\n        if (!(itemCount > 0)) {\r\n            return 1;\r\n        }\r\n        var scrollerInfo = repeat.getScrollerInfo();\r\n        var existingViewCount = repeat.viewCount();\r\n        if (itemCount > 0 && existingViewCount === 0) {\r\n            this.createFirstRow(repeat);\r\n        }\r\n        var firstView = repeat.firstView();\r\n        var itemHeight = calcOuterHeight(firstView.firstChild);\r\n        if (itemHeight === 0) {\r\n            return 0;\r\n        }\r\n        repeat.itemHeight = itemHeight;\r\n        var scroll_el_height = scrollerInfo.height;\r\n        var elementsInView = repeat.minViewsRequired = calcMinViewsRequired(scroll_el_height, itemHeight);\r\n        return 2 | 4;\r\n    };\r\n    ArrayVirtualRepeatStrategy.prototype.onAttached = function (repeat) {\r\n        if (repeat.items.length < repeat.minViewsRequired) {\r\n            repeat.getMore(0, true, this.isNearBottom(repeat, repeat.lastViewIndex()), true);\r\n        }\r\n    };\r\n    ArrayVirtualRepeatStrategy.prototype.getViewRange = function (repeat, scrollerInfo) {\r\n        var topBufferEl = repeat.topBufferEl;\r\n        var scrollerEl = repeat.scrollerEl;\r\n        var itemHeight = repeat.itemHeight;\r\n        var realScrollTop = 0;\r\n        var isFixedHeightContainer = scrollerInfo.scroller !== htmlElement;\r\n        if (isFixedHeightContainer) {\r\n            var topBufferDistance = getDistanceToParent(topBufferEl, scrollerEl);\r\n            var scrollerScrollTop = scrollerInfo.scrollTop;\r\n            realScrollTop = Math$max(0, scrollerScrollTop - Math$abs(topBufferDistance));\r\n        }\r\n        else {\r\n            realScrollTop = pageYOffset - repeat.distanceToTop;\r\n        }\r\n        var realViewCount = repeat.minViewsRequired * 2;\r\n        var firstVisibleIndex = Math$max(0, itemHeight > 0 ? Math$floor(realScrollTop / itemHeight) : 0);\r\n        var lastVisibleIndex = Math$min(repeat.items.length - 1, firstVisibleIndex + (realViewCount - 1));\r\n        firstVisibleIndex = Math$max(0, Math$min(firstVisibleIndex, lastVisibleIndex - (realViewCount - 1)));\r\n        return [firstVisibleIndex, lastVisibleIndex];\r\n    };\r\n    ArrayVirtualRepeatStrategy.prototype.updateBuffers = function (repeat, firstIndex) {\r\n        var itemHeight = repeat.itemHeight;\r\n        var itemCount = repeat.items.length;\r\n        repeat.topBufferHeight = firstIndex * itemHeight;\r\n        repeat.bottomBufferHeight = (itemCount - firstIndex - repeat.viewCount()) * itemHeight;\r\n        repeat.updateBufferElements(true);\r\n    };\r\n    ArrayVirtualRepeatStrategy.prototype.isNearTop = function (repeat, firstIndex) {\r\n        var itemCount = repeat.items.length;\r\n        return itemCount > 0\r\n            ? firstIndex < repeat.edgeDistance\r\n            : false;\r\n    };\r\n    ArrayVirtualRepeatStrategy.prototype.isNearBottom = function (repeat, lastIndex) {\r\n        var itemCount = repeat.items.length;\r\n        return lastIndex === -1\r\n            ? true\r\n            : itemCount > 0\r\n                ? lastIndex > (itemCount - repeat.edgeDistance)\r\n                : false;\r\n    };\r\n    ArrayVirtualRepeatStrategy.prototype.instanceChanged = function (repeat, items, first) {\r\n        if (this._inPlaceProcessItems(repeat, items, first)) {\r\n            this._remeasure(repeat, repeat.itemHeight, repeat.minViewsRequired * 2, items.length, repeat.$first);\r\n        }\r\n    };\r\n    ArrayVirtualRepeatStrategy.prototype.instanceMutated = function (repeat, array, splices) {\r\n        this._standardProcessInstanceMutated(repeat, array, splices);\r\n    };\r\n    ArrayVirtualRepeatStrategy.prototype._inPlaceProcessItems = function ($repeat, items, firstIndex) {\r\n        var repeat = $repeat;\r\n        var currItemCount = items.length;\r\n        if (currItemCount === 0) {\r\n            repeat.removeAllViews(true, false);\r\n            repeat.resetCalculation();\r\n            repeat.__queuedSplices = repeat.__array = undefined;\r\n            return false;\r\n        }\r\n        var max_views_count = repeat.minViewsRequired * 2;\r\n        var realViewsCount = repeat.viewCount();\r\n        while (realViewsCount > currItemCount) {\r\n            realViewsCount--;\r\n            repeat.removeView(realViewsCount, true, false);\r\n        }\r\n        while (realViewsCount > max_views_count) {\r\n            realViewsCount--;\r\n            repeat.removeView(realViewsCount, true, false);\r\n        }\r\n        realViewsCount = Math$min(realViewsCount, max_views_count);\r\n        var local = repeat.local;\r\n        var lastIndex = currItemCount - 1;\r\n        if (firstIndex + realViewsCount > lastIndex) {\r\n            firstIndex = Math$max(0, currItemCount - realViewsCount);\r\n        }\r\n        repeat.$first = firstIndex;\r\n        for (var i = 0; i < realViewsCount; i++) {\r\n            var currIndex = i + firstIndex;\r\n            var view = repeat.view(i);\r\n            var last = currIndex === currItemCount - 1;\r\n            var middle = currIndex !== 0 && !last;\r\n            var bindingContext = view.bindingContext;\r\n            var overrideContext = view.overrideContext;\r\n            if (bindingContext[local] === items[currIndex]\r\n                && overrideContext.$index === currIndex\r\n                && overrideContext.$middle === middle\r\n                && overrideContext.$last === last) {\r\n                continue;\r\n            }\r\n            bindingContext[local] = items[currIndex];\r\n            overrideContext.$first = currIndex === 0;\r\n            overrideContext.$middle = middle;\r\n            overrideContext.$last = last;\r\n            overrideContext.$index = currIndex;\r\n            var odd = currIndex % 2 === 1;\r\n            overrideContext.$odd = odd;\r\n            overrideContext.$even = !odd;\r\n            repeat.updateBindings(view);\r\n        }\r\n        var minLength = Math$min(max_views_count, currItemCount);\r\n        for (var i = realViewsCount; i < minLength; i++) {\r\n            var overrideContext = Object(aurelia_templating_resources__WEBPACK_IMPORTED_MODULE_2__[\"createFullOverrideContext\"])(repeat, items[i], i, currItemCount);\r\n            repeat.addView(overrideContext.bindingContext, overrideContext);\r\n        }\r\n        return true;\r\n    };\r\n    ArrayVirtualRepeatStrategy.prototype._standardProcessInstanceMutated = function ($repeat, array, splices) {\r\n        var _this = this;\r\n        var repeat = $repeat;\r\n        if (repeat.__queuedSplices) {\r\n            for (var i = 0, ii = splices.length; i < ii; ++i) {\r\n                var _a = splices[i], index = _a.index, removed = _a.removed, addedCount = _a.addedCount;\r\n                Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_0__[\"mergeSplice\"])(repeat.__queuedSplices, index, removed, addedCount);\r\n            }\r\n            repeat.__array = array.slice(0);\r\n            return;\r\n        }\r\n        if (array.length === 0) {\r\n            repeat.removeAllViews(true, false);\r\n            repeat.resetCalculation();\r\n            repeat.__queuedSplices = repeat.__array = undefined;\r\n            return;\r\n        }\r\n        var maybePromise = this._runSplices(repeat, array.slice(0), splices);\r\n        if (maybePromise instanceof Promise) {\r\n            var queuedSplices_1 = repeat.__queuedSplices = [];\r\n            var runQueuedSplices_1 = function () {\r\n                if (!queuedSplices_1.length) {\r\n                    repeat.__queuedSplices = repeat.__array = undefined;\r\n                    return;\r\n                }\r\n                var nextPromise = _this._runSplices(repeat, repeat.__array, queuedSplices_1) || Promise.resolve();\r\n                nextPromise.then(runQueuedSplices_1);\r\n            };\r\n            maybePromise.then(runQueuedSplices_1);\r\n        }\r\n    };\r\n    ArrayVirtualRepeatStrategy.prototype._runSplices = function (repeat, newArray, splices) {\r\n        var firstIndex = repeat.$first;\r\n        var totalRemovedCount = 0;\r\n        var totalAddedCount = 0;\r\n        var splice;\r\n        var i = 0;\r\n        var spliceCount = splices.length;\r\n        var newArraySize = newArray.length;\r\n        var allSplicesAreInplace = true;\r\n        for (i = 0; spliceCount > i; i++) {\r\n            splice = splices[i];\r\n            var removedCount = splice.removed.length;\r\n            var addedCount = splice.addedCount;\r\n            totalRemovedCount += removedCount;\r\n            totalAddedCount += addedCount;\r\n            if (removedCount !== addedCount) {\r\n                allSplicesAreInplace = false;\r\n            }\r\n        }\r\n        if (allSplicesAreInplace) {\r\n            var lastIndex = repeat.lastViewIndex();\r\n            var repeatViewSlot = repeat.viewSlot;\r\n            for (i = 0; spliceCount > i; i++) {\r\n                splice = splices[i];\r\n                for (var collectionIndex = splice.index; collectionIndex < splice.index + splice.addedCount; collectionIndex++) {\r\n                    if (collectionIndex >= firstIndex && collectionIndex <= lastIndex) {\r\n                        var viewIndex = collectionIndex - firstIndex;\r\n                        var overrideContext = Object(aurelia_templating_resources__WEBPACK_IMPORTED_MODULE_2__[\"createFullOverrideContext\"])(repeat, newArray[collectionIndex], collectionIndex, newArraySize);\r\n                        repeat.removeView(viewIndex, true, true);\r\n                        repeat.insertView(viewIndex, overrideContext.bindingContext, overrideContext);\r\n                    }\r\n                }\r\n            }\r\n            return;\r\n        }\r\n        var firstIndexAfterMutation = firstIndex;\r\n        var itemHeight = repeat.itemHeight;\r\n        var originalSize = newArraySize + totalRemovedCount - totalAddedCount;\r\n        var currViewCount = repeat.viewCount();\r\n        var newViewCount = currViewCount;\r\n        if (originalSize === 0 && itemHeight === 0) {\r\n            repeat.resetCalculation();\r\n            repeat.itemsChanged();\r\n            return;\r\n        }\r\n        var all_splices_are_positive_and_before_view_port = totalRemovedCount === 0\r\n            && totalAddedCount > 0\r\n            && splices.every(function (splice) { return splice.index <= firstIndex; });\r\n        if (all_splices_are_positive_and_before_view_port) {\r\n            repeat.$first = firstIndex + totalAddedCount - 1;\r\n            repeat.topBufferHeight += totalAddedCount * itemHeight;\r\n            repeat.enableScroll();\r\n            var scrollerInfo = repeat.getScrollerInfo();\r\n            var scroller_scroll_top = scrollerInfo.scrollTop;\r\n            var top_buffer_distance = getDistanceToParent(repeat.topBufferEl, scrollerInfo.scroller);\r\n            var real_scroll_top = Math$max(0, scroller_scroll_top === 0\r\n                ? 0\r\n                : (scroller_scroll_top - top_buffer_distance));\r\n            var first_index_after_scroll_adjustment = real_scroll_top === 0\r\n                ? 0\r\n                : Math$floor(real_scroll_top / itemHeight);\r\n            if (scroller_scroll_top > top_buffer_distance\r\n                && first_index_after_scroll_adjustment === firstIndex) {\r\n                repeat.updateBufferElements(false);\r\n                repeat.scrollerEl.scrollTop = real_scroll_top + totalAddedCount * itemHeight;\r\n                this._remeasure(repeat, itemHeight, newViewCount, newArraySize, firstIndex);\r\n                return;\r\n            }\r\n        }\r\n        var lastViewIndex = repeat.lastViewIndex();\r\n        var all_splices_are_after_view_port = currViewCount > repeat.minViewsRequired\r\n            && splices.every(function (s) { return s.index > lastViewIndex; });\r\n        if (all_splices_are_after_view_port) {\r\n            repeat.bottomBufferHeight = Math$max(0, newArraySize - firstIndex - currViewCount) * itemHeight;\r\n            repeat.updateBufferElements(true);\r\n        }\r\n        else {\r\n            var viewsRequiredCount = repeat.minViewsRequired * 2;\r\n            if (viewsRequiredCount === 0) {\r\n                var scrollerInfo = repeat.getScrollerInfo();\r\n                var minViewsRequired = calcMinViewsRequired(scrollerInfo.height, itemHeight);\r\n                repeat.minViewsRequired = minViewsRequired;\r\n                viewsRequiredCount = minViewsRequired * 2;\r\n            }\r\n            for (i = 0; spliceCount > i; ++i) {\r\n                var _a = splices[i], addedCount = _a.addedCount, removedCount = _a.removed.length, spliceIndex = _a.index;\r\n                var removeDelta = removedCount - addedCount;\r\n                if (firstIndexAfterMutation > spliceIndex) {\r\n                    firstIndexAfterMutation = Math$max(0, firstIndexAfterMutation - removeDelta);\r\n                }\r\n            }\r\n            newViewCount = 0;\r\n            if (newArraySize <= repeat.minViewsRequired) {\r\n                firstIndexAfterMutation = 0;\r\n                newViewCount = newArraySize;\r\n            }\r\n            else {\r\n                if (newArraySize <= viewsRequiredCount) {\r\n                    newViewCount = newArraySize;\r\n                    firstIndexAfterMutation = 0;\r\n                }\r\n                else {\r\n                    newViewCount = viewsRequiredCount;\r\n                }\r\n            }\r\n            var newTopBufferItemCount = newArraySize >= firstIndexAfterMutation\r\n                ? firstIndexAfterMutation\r\n                : 0;\r\n            var viewCountDelta = newViewCount - currViewCount;\r\n            if (viewCountDelta > 0) {\r\n                for (i = 0; viewCountDelta > i; ++i) {\r\n                    var collectionIndex = firstIndexAfterMutation + currViewCount + i;\r\n                    var overrideContext = Object(aurelia_templating_resources__WEBPACK_IMPORTED_MODULE_2__[\"createFullOverrideContext\"])(repeat, newArray[collectionIndex], collectionIndex, newArray.length);\r\n                    repeat.addView(overrideContext.bindingContext, overrideContext);\r\n                }\r\n            }\r\n            else {\r\n                var ii = Math$abs(viewCountDelta);\r\n                for (i = 0; ii > i; ++i) {\r\n                    repeat.removeView(newViewCount, true, false);\r\n                }\r\n            }\r\n            var newBotBufferItemCount = Math$max(0, newArraySize - newTopBufferItemCount - newViewCount);\r\n            repeat.$first = firstIndexAfterMutation;\r\n            repeat.topBufferHeight = newTopBufferItemCount * itemHeight;\r\n            repeat.bottomBufferHeight = newBotBufferItemCount * itemHeight;\r\n            repeat.updateBufferElements(true);\r\n        }\r\n        this._remeasure(repeat, itemHeight, newViewCount, newArraySize, firstIndexAfterMutation);\r\n    };\r\n    ArrayVirtualRepeatStrategy.prototype.updateAllViews = function (repeat, startIndex) {\r\n        var views = repeat.viewSlot.children;\r\n        var viewLength = views.length;\r\n        var collection = repeat.items;\r\n        var delta = Math$floor(repeat.topBufferHeight / repeat.itemHeight);\r\n        var collectionIndex = 0;\r\n        var view;\r\n        for (; viewLength > startIndex; ++startIndex) {\r\n            collectionIndex = startIndex + delta;\r\n            view = repeat.view(startIndex);\r\n            rebindView(repeat, view, collectionIndex, collection);\r\n            repeat.updateBindings(view);\r\n        }\r\n    };\r\n    ArrayVirtualRepeatStrategy.prototype.remeasure = function (repeat) {\r\n        this._remeasure(repeat, repeat.itemHeight, repeat.viewCount(), repeat.items.length, repeat.firstViewIndex());\r\n    };\r\n    ArrayVirtualRepeatStrategy.prototype._remeasure = function (repeat, itemHeight, newViewCount, newArraySize, firstIndex) {\r\n        var scrollerInfo = repeat.getScrollerInfo();\r\n        var scroller_scroll_top = scrollerInfo.scrollTop;\r\n        var top_buffer_distance = getDistanceToParent(repeat.topBufferEl, scrollerInfo.scroller);\r\n        var real_scroll_top = Math$max(0, scroller_scroll_top === 0\r\n            ? 0\r\n            : (scroller_scroll_top - top_buffer_distance));\r\n        var first_index_after_scroll_adjustment = real_scroll_top === 0\r\n            ? 0\r\n            : Math$floor(real_scroll_top / itemHeight);\r\n        if (first_index_after_scroll_adjustment + newViewCount >= newArraySize) {\r\n            first_index_after_scroll_adjustment = Math$max(0, newArraySize - newViewCount);\r\n        }\r\n        var top_buffer_item_count_after_scroll_adjustment = first_index_after_scroll_adjustment;\r\n        var bot_buffer_item_count_after_scroll_adjustment = Math$max(0, newArraySize - top_buffer_item_count_after_scroll_adjustment - newViewCount);\r\n        repeat.$first = first_index_after_scroll_adjustment;\r\n        repeat.topBufferHeight = top_buffer_item_count_after_scroll_adjustment * itemHeight;\r\n        repeat.bottomBufferHeight = bot_buffer_item_count_after_scroll_adjustment * itemHeight;\r\n        repeat._handlingMutations = false;\r\n        repeat.revertScrollCheckGuard();\r\n        repeat.updateBufferElements();\r\n        this.updateAllViews(repeat, 0);\r\n    };\r\n    return ArrayVirtualRepeatStrategy;\r\n}(aurelia_templating_resources__WEBPACK_IMPORTED_MODULE_2__[\"ArrayRepeatStrategy\"]));\n\nvar NullVirtualRepeatStrategy = (function (_super) {\r\n    __extends(NullVirtualRepeatStrategy, _super);\r\n    function NullVirtualRepeatStrategy() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    NullVirtualRepeatStrategy.prototype.getViewRange = function (repeat, scrollerInfo) {\r\n        return [0, 0];\r\n    };\r\n    NullVirtualRepeatStrategy.prototype.updateBuffers = function (repeat, firstIndex) { };\r\n    NullVirtualRepeatStrategy.prototype.onAttached = function () { };\r\n    NullVirtualRepeatStrategy.prototype.isNearTop = function () {\r\n        return false;\r\n    };\r\n    NullVirtualRepeatStrategy.prototype.isNearBottom = function () {\r\n        return false;\r\n    };\r\n    NullVirtualRepeatStrategy.prototype.initCalculation = function (repeat, items) {\r\n        repeat.itemHeight\r\n            = repeat.minViewsRequired\r\n                = 0;\r\n        return 2;\r\n    };\r\n    NullVirtualRepeatStrategy.prototype.createFirstRow = function () {\r\n        return null;\r\n    };\r\n    NullVirtualRepeatStrategy.prototype.instanceMutated = function () { };\r\n    NullVirtualRepeatStrategy.prototype.instanceChanged = function (repeat) {\r\n        repeat.removeAllViews(true, false);\r\n        repeat.resetCalculation();\r\n    };\r\n    NullVirtualRepeatStrategy.prototype.remeasure = function (repeat) { };\r\n    NullVirtualRepeatStrategy.prototype.updateAllViews = function () { };\r\n    return NullVirtualRepeatStrategy;\r\n}(aurelia_templating_resources__WEBPACK_IMPORTED_MODULE_2__[\"NullRepeatStrategy\"]));\n\nvar VirtualRepeatStrategyLocator = (function () {\r\n    function VirtualRepeatStrategyLocator() {\r\n        this.matchers = [];\r\n        this.strategies = [];\r\n        this.addStrategy(function (items) { return items === null || items === undefined; }, new NullVirtualRepeatStrategy());\r\n        this.addStrategy(function (items) { return items instanceof Array; }, new ArrayVirtualRepeatStrategy());\r\n    }\r\n    VirtualRepeatStrategyLocator.prototype.addStrategy = function (matcher, strategy) {\r\n        this.matchers.push(matcher);\r\n        this.strategies.push(strategy);\r\n    };\r\n    VirtualRepeatStrategyLocator.prototype.getStrategy = function (items) {\r\n        var matchers = this.matchers;\r\n        for (var i = 0, ii = matchers.length; i < ii; ++i) {\r\n            if (matchers[i](items)) {\r\n                return this.strategies[i];\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    return VirtualRepeatStrategyLocator;\r\n}());\n\nvar DefaultTemplateStrategy = (function () {\r\n    function DefaultTemplateStrategy() {\r\n    }\r\n    DefaultTemplateStrategy.prototype.getScrollContainer = function (element) {\r\n        return getScrollerElement(element);\r\n    };\r\n    DefaultTemplateStrategy.prototype.moveViewFirst = function (view, topBuffer) {\r\n        insertBeforeNode(view, aurelia_pal__WEBPACK_IMPORTED_MODULE_3__[\"DOM\"].nextElementSibling(topBuffer));\r\n    };\r\n    DefaultTemplateStrategy.prototype.moveViewLast = function (view, bottomBuffer) {\r\n        var previousSibling = bottomBuffer.previousSibling;\r\n        var referenceNode = previousSibling.nodeType === 8 && previousSibling.data === 'anchor' ? previousSibling : bottomBuffer;\r\n        insertBeforeNode(view, referenceNode);\r\n    };\r\n    DefaultTemplateStrategy.prototype.createBuffers = function (element) {\r\n        var parent = element.parentNode;\r\n        return [\r\n            parent.insertBefore(aurelia_pal__WEBPACK_IMPORTED_MODULE_3__[\"DOM\"].createElement('div'), element),\r\n            parent.insertBefore(aurelia_pal__WEBPACK_IMPORTED_MODULE_3__[\"DOM\"].createElement('div'), element.nextSibling)\r\n        ];\r\n    };\r\n    DefaultTemplateStrategy.prototype.removeBuffers = function (el, topBuffer, bottomBuffer) {\r\n        var parent = el.parentNode;\r\n        parent.removeChild(topBuffer);\r\n        parent.removeChild(bottomBuffer);\r\n    };\r\n    DefaultTemplateStrategy.prototype.getFirstElement = function (topBuffer, bottomBuffer) {\r\n        var firstEl = topBuffer.nextElementSibling;\r\n        return firstEl === bottomBuffer ? null : firstEl;\r\n    };\r\n    DefaultTemplateStrategy.prototype.getLastElement = function (topBuffer, bottomBuffer) {\r\n        var lastEl = bottomBuffer.previousElementSibling;\r\n        return lastEl === topBuffer ? null : lastEl;\r\n    };\r\n    return DefaultTemplateStrategy;\r\n}());\n\nvar BaseTableTemplateStrategy = (function (_super) {\r\n    __extends(BaseTableTemplateStrategy, _super);\r\n    function BaseTableTemplateStrategy() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    BaseTableTemplateStrategy.prototype.getScrollContainer = function (element) {\r\n        return getScrollerElement(this.getTable(element));\r\n    };\r\n    BaseTableTemplateStrategy.prototype.createBuffers = function (element) {\r\n        var parent = element.parentNode;\r\n        return [\r\n            parent.insertBefore(aurelia_pal__WEBPACK_IMPORTED_MODULE_3__[\"DOM\"].createElement('tr'), element),\r\n            parent.insertBefore(aurelia_pal__WEBPACK_IMPORTED_MODULE_3__[\"DOM\"].createElement('tr'), element.nextSibling)\r\n        ];\r\n    };\r\n    return BaseTableTemplateStrategy;\r\n}(DefaultTemplateStrategy));\r\nvar TableBodyStrategy = (function (_super) {\r\n    __extends(TableBodyStrategy, _super);\r\n    function TableBodyStrategy() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    TableBodyStrategy.prototype.getTable = function (element) {\r\n        return element.parentNode;\r\n    };\r\n    return TableBodyStrategy;\r\n}(BaseTableTemplateStrategy));\r\nvar TableRowStrategy = (function (_super) {\r\n    __extends(TableRowStrategy, _super);\r\n    function TableRowStrategy() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    TableRowStrategy.prototype.getTable = function (element) {\r\n        return element.parentNode.parentNode;\r\n    };\r\n    return TableRowStrategy;\r\n}(BaseTableTemplateStrategy));\n\nvar ListTemplateStrategy = (function (_super) {\r\n    __extends(ListTemplateStrategy, _super);\r\n    function ListTemplateStrategy() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    ListTemplateStrategy.prototype.createBuffers = function (element) {\r\n        var parent = element.parentNode;\r\n        return [\r\n            parent.insertBefore(aurelia_pal__WEBPACK_IMPORTED_MODULE_3__[\"DOM\"].createElement('li'), element),\r\n            parent.insertBefore(aurelia_pal__WEBPACK_IMPORTED_MODULE_3__[\"DOM\"].createElement('li'), element.nextSibling)\r\n        ];\r\n    };\r\n    return ListTemplateStrategy;\r\n}(DefaultTemplateStrategy));\n\nvar TemplateStrategyLocator = (function () {\r\n    function TemplateStrategyLocator(container) {\r\n        this.container = container;\r\n    }\r\n    TemplateStrategyLocator.prototype.getStrategy = function (element) {\r\n        var parent = element.parentNode;\r\n        var container = this.container;\r\n        if (parent === null) {\r\n            return container.get(DefaultTemplateStrategy);\r\n        }\r\n        var parentTagName = parent.tagName;\r\n        if (parentTagName === 'TBODY' || parentTagName === 'THEAD' || parentTagName === 'TFOOT') {\r\n            return container.get(TableRowStrategy);\r\n        }\r\n        if (parentTagName === 'TABLE') {\r\n            return container.get(TableBodyStrategy);\r\n        }\r\n        if (parentTagName === 'OL' || parentTagName === 'UL') {\r\n            return container.get(ListTemplateStrategy);\r\n        }\r\n        return container.get(DefaultTemplateStrategy);\r\n    };\r\n    TemplateStrategyLocator.inject = [aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_4__[\"Container\"]];\r\n    return TemplateStrategyLocator;\r\n}());\n\nvar VirtualizationEvents = Object.assign(Object.create(null), {\r\n    scrollerSizeChange: 'virtual-repeat-scroller-size-changed',\r\n    itemSizeChange: 'virtual-repeat-item-size-changed'\r\n});\n\nvar getResizeObserverClass = function () { return aurelia_pal__WEBPACK_IMPORTED_MODULE_3__[\"PLATFORM\"].global.ResizeObserver; };\n\nvar VirtualRepeat = (function (_super) {\r\n    __extends(VirtualRepeat, _super);\r\n    function VirtualRepeat(element, viewFactory, instruction, viewSlot, viewResources, observerLocator, collectionStrategyLocator, templateStrategyLocator) {\r\n        var _this = _super.call(this, {\r\n            local: 'item',\r\n            viewsRequireLifecycle: Object(aurelia_templating_resources__WEBPACK_IMPORTED_MODULE_2__[\"viewsRequireLifecycle\"])(viewFactory)\r\n        }) || this;\r\n        _this.$first = 0;\r\n        _this._isAttached = false;\r\n        _this._ticking = false;\r\n        _this._calledGetMore = false;\r\n        _this._skipNextScrollHandle = false;\r\n        _this._handlingMutations = false;\r\n        _this._lastGetMore = 0;\r\n        _this.element = element;\r\n        _this.viewFactory = viewFactory;\r\n        _this.instruction = instruction;\r\n        _this.viewSlot = viewSlot;\r\n        _this.lookupFunctions = viewResources['lookupFunctions'];\r\n        _this.observerLocator = observerLocator;\r\n        _this.taskQueue = observerLocator.taskQueue;\r\n        _this.strategyLocator = collectionStrategyLocator;\r\n        _this.templateStrategyLocator = templateStrategyLocator;\r\n        _this.edgeDistance = 5;\r\n        _this.sourceExpression = Object(aurelia_templating_resources__WEBPACK_IMPORTED_MODULE_2__[\"getItemsSourceExpression\"])(_this.instruction, 'virtual-repeat.for');\r\n        _this.isOneTime = Object(aurelia_templating_resources__WEBPACK_IMPORTED_MODULE_2__[\"isOneTime\"])(_this.sourceExpression);\r\n        _this.topBufferHeight\r\n            = _this.bottomBufferHeight\r\n                = _this.itemHeight\r\n                    = _this.distanceToTop\r\n                        = 0;\r\n        _this.revertScrollCheckGuard = function () {\r\n            _this._ticking = false;\r\n        };\r\n        _this._onScroll = _this._onScroll.bind(_this);\r\n        return _this;\r\n    }\r\n    VirtualRepeat.inject = function () {\r\n        return [\r\n            aurelia_pal__WEBPACK_IMPORTED_MODULE_3__[\"DOM\"].Element,\r\n            aurelia_templating__WEBPACK_IMPORTED_MODULE_1__[\"BoundViewFactory\"],\r\n            aurelia_templating__WEBPACK_IMPORTED_MODULE_1__[\"TargetInstruction\"],\r\n            aurelia_templating__WEBPACK_IMPORTED_MODULE_1__[\"ViewSlot\"],\r\n            aurelia_templating__WEBPACK_IMPORTED_MODULE_1__[\"ViewResources\"],\r\n            aurelia_binding__WEBPACK_IMPORTED_MODULE_0__[\"ObserverLocator\"],\r\n            VirtualRepeatStrategyLocator,\r\n            TemplateStrategyLocator\r\n        ];\r\n    };\r\n    VirtualRepeat.$resource = function () {\r\n        return {\r\n            type: 'attribute',\r\n            name: 'virtual-repeat',\r\n            templateController: true,\r\n            bindables: ['items', 'local']\r\n        };\r\n    };\r\n    VirtualRepeat.prototype.bind = function (bindingContext, overrideContext) {\r\n        this.scope = { bindingContext: bindingContext, overrideContext: overrideContext };\r\n    };\r\n    VirtualRepeat.prototype.attached = function () {\r\n        var _this = this;\r\n        this._isAttached = true;\r\n        var element = this.element;\r\n        var templateStrategy = this.templateStrategy = this.templateStrategyLocator.getStrategy(element);\r\n        var scrollerEl = this.scrollerEl = templateStrategy.getScrollContainer(element);\r\n        var _a = templateStrategy.createBuffers(element), topBufferEl = _a[0], bottomBufferEl = _a[1];\r\n        var isFixedHeightContainer = scrollerEl !== htmlElement;\r\n        var scrollListener = this._onScroll;\r\n        this.topBufferEl = topBufferEl;\r\n        this.bottomBufferEl = bottomBufferEl;\r\n        this.itemsChanged();\r\n        this._currScrollerInfo = this.getScrollerInfo();\r\n        if (isFixedHeightContainer) {\r\n            scrollerEl.addEventListener('scroll', scrollListener);\r\n        }\r\n        else {\r\n            var firstElement = templateStrategy.getFirstElement(topBufferEl, bottomBufferEl);\r\n            this.distanceToTop = firstElement === null ? 0 : getElementDistanceToTopOfDocument(topBufferEl);\r\n            aurelia_pal__WEBPACK_IMPORTED_MODULE_3__[\"DOM\"].addEventListener('scroll', scrollListener, false);\r\n            this._calcDistanceToTopInterval = aurelia_pal__WEBPACK_IMPORTED_MODULE_3__[\"PLATFORM\"].global.setInterval(function () {\r\n                var prevDistanceToTop = _this.distanceToTop;\r\n                var currDistanceToTop = getElementDistanceToTopOfDocument(topBufferEl);\r\n                _this.distanceToTop = currDistanceToTop;\r\n                if (prevDistanceToTop !== currDistanceToTop) {\r\n                    var currentScrollerInfo = _this.getScrollerInfo();\r\n                    var prevScrollerInfo = _this._currScrollerInfo;\r\n                    _this._currScrollerInfo = currentScrollerInfo;\r\n                    _this._handleScroll(currentScrollerInfo, prevScrollerInfo);\r\n                }\r\n            }, 500);\r\n        }\r\n        this.strategy.onAttached(this);\r\n    };\r\n    VirtualRepeat.prototype.call = function (context, changes) {\r\n        this[context](this.items, changes);\r\n    };\r\n    VirtualRepeat.prototype.detached = function () {\r\n        var scrollCt = this.scrollerEl;\r\n        var scrollListener = this._onScroll;\r\n        if (hasOverflowScroll(scrollCt)) {\r\n            scrollCt.removeEventListener('scroll', scrollListener);\r\n        }\r\n        else {\r\n            aurelia_pal__WEBPACK_IMPORTED_MODULE_3__[\"DOM\"].removeEventListener('scroll', scrollListener, false);\r\n        }\r\n        this.unobserveScroller();\r\n        this._currScrollerContentRect = undefined;\r\n        this._isAttached\r\n            = false;\r\n        this._unsubscribeCollection();\r\n        this.resetCalculation();\r\n        this.templateStrategy.removeBuffers(this.element, this.topBufferEl, this.bottomBufferEl);\r\n        this.topBufferEl = this.bottomBufferEl = this.scrollerEl = null;\r\n        this.removeAllViews(true, false);\r\n        var $clearInterval = aurelia_pal__WEBPACK_IMPORTED_MODULE_3__[\"PLATFORM\"].global.clearInterval;\r\n        $clearInterval(this._calcDistanceToTopInterval);\r\n        $clearInterval(this._sizeInterval);\r\n        this.distanceToTop\r\n            = this._sizeInterval\r\n                = this._calcDistanceToTopInterval = 0;\r\n    };\r\n    VirtualRepeat.prototype.unbind = function () {\r\n        this.scope = null;\r\n        this.items = null;\r\n    };\r\n    VirtualRepeat.prototype.itemsChanged = function () {\r\n        var _this = this;\r\n        this._unsubscribeCollection();\r\n        if (!this.scope || !this._isAttached) {\r\n            return;\r\n        }\r\n        var items = this.items;\r\n        var strategy = this.strategy = this.strategyLocator.getStrategy(items);\r\n        if (strategy === null) {\r\n            throw new Error('Value is not iterateable for virtual repeat.');\r\n        }\r\n        if (!this.isOneTime && !this._observeInnerCollection()) {\r\n            this._observeCollection();\r\n        }\r\n        var calculationSignals = strategy.initCalculation(this, items);\r\n        strategy.instanceChanged(this, items, this.$first);\r\n        if (calculationSignals & 1) {\r\n            this.resetCalculation();\r\n        }\r\n        if ((calculationSignals & 2) === 0) {\r\n            var _a = aurelia_pal__WEBPACK_IMPORTED_MODULE_3__[\"PLATFORM\"].global, $setInterval = _a.setInterval, $clearInterval_1 = _a.clearInterval;\r\n            $clearInterval_1(this._sizeInterval);\r\n            this._sizeInterval = $setInterval(function () {\r\n                if (_this.items) {\r\n                    var firstView = _this.firstView() || _this.strategy.createFirstRow(_this);\r\n                    var newCalcSize = calcOuterHeight(firstView.firstChild);\r\n                    if (newCalcSize > 0) {\r\n                        $clearInterval_1(_this._sizeInterval);\r\n                        _this.itemsChanged();\r\n                    }\r\n                }\r\n                else {\r\n                    $clearInterval_1(_this._sizeInterval);\r\n                }\r\n            }, 500);\r\n        }\r\n        if (calculationSignals & 4) {\r\n            this.observeScroller(this.scrollerEl);\r\n        }\r\n    };\r\n    VirtualRepeat.prototype.handleCollectionMutated = function (collection, changes) {\r\n        if (this._ignoreMutation) {\r\n            return;\r\n        }\r\n        this._handlingMutations = true;\r\n        this.strategy.instanceMutated(this, collection, changes);\r\n    };\r\n    VirtualRepeat.prototype.handleInnerCollectionMutated = function (collection, changes) {\r\n        var _this = this;\r\n        if (this._ignoreMutation) {\r\n            return;\r\n        }\r\n        this._ignoreMutation = true;\r\n        var newItems = this.sourceExpression.evaluate(this.scope, this.lookupFunctions);\r\n        this.taskQueue.queueMicroTask(function () { return _this._ignoreMutation = false; });\r\n        if (newItems === this.items) {\r\n            this.itemsChanged();\r\n        }\r\n        else {\r\n            this.items = newItems;\r\n        }\r\n    };\r\n    VirtualRepeat.prototype.enableScroll = function () {\r\n        this._ticking = false;\r\n        this._handlingMutations = false;\r\n        this._skipNextScrollHandle = false;\r\n    };\r\n    VirtualRepeat.prototype.getScroller = function () {\r\n        return this.scrollerEl;\r\n    };\r\n    VirtualRepeat.prototype.getScrollerInfo = function () {\r\n        var scroller = this.scrollerEl;\r\n        return {\r\n            scroller: scroller,\r\n            scrollTop: scroller.scrollTop,\r\n            height: scroller === htmlElement\r\n                ? innerHeight\r\n                : calcScrollHeight(scroller)\r\n        };\r\n    };\r\n    VirtualRepeat.prototype.resetCalculation = function () {\r\n        this.$first\r\n            = this.topBufferHeight\r\n                = this.bottomBufferHeight\r\n                    = this.itemHeight\r\n                        = this.minViewsRequired = 0;\r\n        this._ignoreMutation\r\n            = this._handlingMutations\r\n                = this._ticking = false;\r\n        this.updateBufferElements(true);\r\n    };\r\n    VirtualRepeat.prototype._onScroll = function () {\r\n        var _this = this;\r\n        var isHandlingMutations = this._handlingMutations;\r\n        if (!this._ticking && !isHandlingMutations) {\r\n            var prevScrollerInfo_1 = this._currScrollerInfo;\r\n            var currentScrollerInfo_1 = this.getScrollerInfo();\r\n            this._currScrollerInfo = currentScrollerInfo_1;\r\n            this.taskQueue.queueMicroTask(function () {\r\n                _this._ticking = false;\r\n                _this._handleScroll(currentScrollerInfo_1, prevScrollerInfo_1);\r\n            });\r\n            this._ticking = true;\r\n        }\r\n        if (isHandlingMutations) {\r\n            this._handlingMutations = false;\r\n        }\r\n    };\r\n    VirtualRepeat.prototype._handleScroll = function (currentScrollerInfo, prevScrollerInfo) {\r\n        if (!this._isAttached) {\r\n            return;\r\n        }\r\n        if (this._skipNextScrollHandle) {\r\n            this._skipNextScrollHandle = false;\r\n            return;\r\n        }\r\n        var items = this.items;\r\n        if (!items) {\r\n            return;\r\n        }\r\n        var strategy = this.strategy;\r\n        var old_range_start_index = this.$first;\r\n        var old_range_end_index = this.lastViewIndex();\r\n        var _a = strategy.getViewRange(this, currentScrollerInfo), new_range_start_index = _a[0], new_range_end_index = _a[1];\r\n        var scrolling_state = new_range_start_index > old_range_start_index\r\n            ? 1\r\n            : new_range_start_index < old_range_start_index\r\n                ? 2\r\n                : 0;\r\n        var didMovedViews = 0;\r\n        if (new_range_start_index >= old_range_start_index && old_range_end_index === new_range_end_index\r\n            || new_range_end_index === old_range_end_index && old_range_end_index >= new_range_end_index) {\r\n            if (new_range_start_index >= old_range_start_index && old_range_end_index === new_range_end_index) {\r\n                if (strategy.isNearBottom(this, new_range_end_index)) {\r\n                    scrolling_state |= 8;\r\n                }\r\n            }\r\n            else if (strategy.isNearTop(this, new_range_start_index)) {\r\n                scrolling_state |= 4;\r\n            }\r\n        }\r\n        else {\r\n            if (new_range_start_index > old_range_start_index && old_range_end_index >= new_range_start_index && new_range_end_index >= old_range_end_index) {\r\n                var views_to_move_count = new_range_start_index - old_range_start_index;\r\n                this._moveViews(views_to_move_count, 1);\r\n                didMovedViews = 1;\r\n                if (strategy.isNearBottom(this, new_range_end_index)) {\r\n                    scrolling_state |= 8;\r\n                }\r\n            }\r\n            else if (old_range_start_index > new_range_start_index && old_range_start_index <= new_range_end_index && old_range_end_index >= new_range_end_index) {\r\n                var views_to_move_count = old_range_end_index - new_range_end_index;\r\n                this._moveViews(views_to_move_count, -1);\r\n                didMovedViews = 1;\r\n                if (strategy.isNearTop(this, new_range_start_index)) {\r\n                    scrolling_state |= 4;\r\n                }\r\n            }\r\n            else if (old_range_end_index < new_range_start_index || old_range_start_index > new_range_end_index) {\r\n                strategy.remeasure(this);\r\n                if (old_range_end_index < new_range_start_index) {\r\n                    if (strategy.isNearBottom(this, new_range_end_index)) {\r\n                        scrolling_state |= 8;\r\n                    }\r\n                }\r\n                else if (strategy.isNearTop(this, new_range_start_index)) {\r\n                    scrolling_state |= 4;\r\n                }\r\n            }\r\n            else {\r\n                console.warn('Scroll intersection not handled');\r\n                strategy.remeasure(this);\r\n            }\r\n        }\r\n        if (didMovedViews === 1) {\r\n            this.$first = new_range_start_index;\r\n            strategy.updateBuffers(this, new_range_start_index);\r\n        }\r\n        if ((scrolling_state & (1 | 8)) === (1 | 8)\r\n            || (scrolling_state & (2 | 4)) === (2 | 4)) {\r\n            this.getMore(new_range_start_index, (scrolling_state & 4) > 0, (scrolling_state & 8) > 0);\r\n        }\r\n    };\r\n    VirtualRepeat.prototype._moveViews = function (viewsCount, direction) {\r\n        var repeat = this;\r\n        if (direction === -1) {\r\n            var startIndex = repeat.firstViewIndex();\r\n            while (viewsCount--) {\r\n                var view = repeat.lastView();\r\n                rebindAndMoveView(repeat, view, --startIndex, false);\r\n            }\r\n        }\r\n        else {\r\n            var lastIndex = repeat.lastViewIndex();\r\n            while (viewsCount--) {\r\n                var view = repeat.view(0);\r\n                rebindAndMoveView(repeat, view, ++lastIndex, true);\r\n            }\r\n        }\r\n    };\r\n    VirtualRepeat.prototype.getMore = function (topIndex, isNearTop, isNearBottom, force) {\r\n        var _this = this;\r\n        if (isNearTop || isNearBottom || force) {\r\n            if (!this._calledGetMore) {\r\n                var executeGetMore = function (time) {\r\n                    if (time - _this._lastGetMore < 16) {\r\n                        return;\r\n                    }\r\n                    _this._lastGetMore = time;\r\n                    _this._calledGetMore = true;\r\n                    var revertCalledGetMore = function () {\r\n                        _this._calledGetMore = false;\r\n                    };\r\n                    var firstView = _this.firstView();\r\n                    if (firstView === null) {\r\n                        revertCalledGetMore();\r\n                        return;\r\n                    }\r\n                    var firstViewElement = firstView.firstChild;\r\n                    var scrollNextAttrName = 'infinite-scroll-next';\r\n                    var func = firstViewElement\r\n                        && firstViewElement.au\r\n                        && firstViewElement.au[scrollNextAttrName]\r\n                        ? firstViewElement.au[scrollNextAttrName].instruction.attributes[scrollNextAttrName]\r\n                        : undefined;\r\n                    if (func === undefined) {\r\n                        revertCalledGetMore();\r\n                    }\r\n                    else {\r\n                        var scrollContext = {\r\n                            topIndex: topIndex,\r\n                            isAtBottom: isNearBottom,\r\n                            isAtTop: isNearTop\r\n                        };\r\n                        var overrideContext = _this.scope.overrideContext;\r\n                        overrideContext.$scrollContext = scrollContext;\r\n                        if (typeof func === 'string') {\r\n                            var bindingContext = overrideContext.bindingContext;\r\n                            var getMoreFuncName = firstView.firstChild.getAttribute(scrollNextAttrName);\r\n                            var funcCall = bindingContext[getMoreFuncName];\r\n                            if (typeof funcCall === 'function') {\r\n                                revertCalledGetMore();\r\n                                var result = funcCall.call(bindingContext, topIndex, isNearBottom, isNearTop);\r\n                                if (result instanceof Promise) {\r\n                                    _this._calledGetMore = true;\r\n                                    return result.then(function () {\r\n                                        revertCalledGetMore();\r\n                                    });\r\n                                }\r\n                            }\r\n                            else {\r\n                                throw new Error(\"'\" + scrollNextAttrName + \"' must be a function or evaluate to one\");\r\n                            }\r\n                        }\r\n                        else if (func.sourceExpression) {\r\n                            revertCalledGetMore();\r\n                            return func.sourceExpression.evaluate(_this.scope);\r\n                        }\r\n                        else {\r\n                            throw new Error(\"'\" + scrollNextAttrName + \"' must be a function or evaluate to one\");\r\n                        }\r\n                    }\r\n                };\r\n                $raf(executeGetMore);\r\n            }\r\n        }\r\n    };\r\n    VirtualRepeat.prototype.updateBufferElements = function (skipUpdate) {\r\n        this.topBufferEl.style.height = this.topBufferHeight + \"px\";\r\n        this.bottomBufferEl.style.height = this.bottomBufferHeight + \"px\";\r\n        if (skipUpdate) {\r\n            this._ticking = true;\r\n            $raf(this.revertScrollCheckGuard);\r\n        }\r\n    };\r\n    VirtualRepeat.prototype._unsubscribeCollection = function () {\r\n        var collectionObserver = this.collectionObserver;\r\n        if (collectionObserver) {\r\n            collectionObserver.unsubscribe(this.callContext, this);\r\n            this.collectionObserver = this.callContext = null;\r\n        }\r\n    };\r\n    VirtualRepeat.prototype.firstView = function () {\r\n        return this.view(0);\r\n    };\r\n    VirtualRepeat.prototype.lastView = function () {\r\n        return this.view(this.viewCount() - 1);\r\n    };\r\n    VirtualRepeat.prototype.firstViewIndex = function () {\r\n        var firstView = this.firstView();\r\n        return firstView === null ? -1 : firstView.overrideContext.$index;\r\n    };\r\n    VirtualRepeat.prototype.lastViewIndex = function () {\r\n        var lastView = this.lastView();\r\n        return lastView === null ? -1 : lastView.overrideContext.$index;\r\n    };\r\n    VirtualRepeat.prototype.observeScroller = function (scrollerEl) {\r\n        var _this = this;\r\n        var sizeChangeHandler = function (newRect) {\r\n            $raf(function () {\r\n                if (newRect === _this._currScrollerContentRect) {\r\n                    _this.itemsChanged();\r\n                }\r\n            });\r\n        };\r\n        var ResizeObserverConstructor = getResizeObserverClass();\r\n        if (typeof ResizeObserverConstructor === 'function') {\r\n            var observer = this._scrollerResizeObserver;\r\n            if (observer) {\r\n                observer.disconnect();\r\n            }\r\n            observer = this._scrollerResizeObserver = new ResizeObserverConstructor(function (entries) {\r\n                var oldRect = _this._currScrollerContentRect;\r\n                var newRect = entries[0].contentRect;\r\n                _this._currScrollerContentRect = newRect;\r\n                if (oldRect === undefined || newRect.height !== oldRect.height || newRect.width !== oldRect.width) {\r\n                    sizeChangeHandler(newRect);\r\n                }\r\n            });\r\n            observer.observe(scrollerEl);\r\n        }\r\n        var elEvents = this._scrollerEvents;\r\n        if (elEvents) {\r\n            elEvents.disposeAll();\r\n        }\r\n        var sizeChangeEventsHandler = function () {\r\n            $raf(function () {\r\n                _this.itemsChanged();\r\n            });\r\n        };\r\n        elEvents = this._scrollerEvents = new aurelia_templating__WEBPACK_IMPORTED_MODULE_1__[\"ElementEvents\"](scrollerEl);\r\n        elEvents.subscribe(VirtualizationEvents.scrollerSizeChange, sizeChangeEventsHandler, false);\r\n        elEvents.subscribe(VirtualizationEvents.itemSizeChange, sizeChangeEventsHandler, false);\r\n    };\r\n    VirtualRepeat.prototype.unobserveScroller = function () {\r\n        var observer = this._scrollerResizeObserver;\r\n        if (observer) {\r\n            observer.disconnect();\r\n        }\r\n        var scrollerEvents = this._scrollerEvents;\r\n        if (scrollerEvents) {\r\n            scrollerEvents.disposeAll();\r\n        }\r\n        this._scrollerResizeObserver\r\n            = this._scrollerEvents = undefined;\r\n    };\r\n    VirtualRepeat.prototype._observeInnerCollection = function () {\r\n        var items = this._getInnerCollection();\r\n        var strategy = this.strategyLocator.getStrategy(items);\r\n        if (!strategy) {\r\n            return false;\r\n        }\r\n        var collectionObserver = strategy.getCollectionObserver(this.observerLocator, items);\r\n        if (!collectionObserver) {\r\n            return false;\r\n        }\r\n        var context = \"handleInnerCollectionMutated\";\r\n        this.collectionObserver = collectionObserver;\r\n        this.callContext = context;\r\n        collectionObserver.subscribe(context, this);\r\n        return true;\r\n    };\r\n    VirtualRepeat.prototype._getInnerCollection = function () {\r\n        var expression = Object(aurelia_templating_resources__WEBPACK_IMPORTED_MODULE_2__[\"unwrapExpression\"])(this.sourceExpression);\r\n        if (!expression) {\r\n            return null;\r\n        }\r\n        return expression.evaluate(this.scope, null);\r\n    };\r\n    VirtualRepeat.prototype._observeCollection = function () {\r\n        var collectionObserver = this.strategy.getCollectionObserver(this.observerLocator, this.items);\r\n        if (collectionObserver) {\r\n            this.callContext = \"handleCollectionMutated\";\r\n            this.collectionObserver = collectionObserver;\r\n            collectionObserver.subscribe(this.callContext, this);\r\n        }\r\n    };\r\n    VirtualRepeat.prototype.viewCount = function () {\r\n        return this.viewSlot.children.length;\r\n    };\r\n    VirtualRepeat.prototype.views = function () {\r\n        return this.viewSlot.children;\r\n    };\r\n    VirtualRepeat.prototype.view = function (index) {\r\n        var viewSlot = this.viewSlot;\r\n        return index < 0 || index > viewSlot.children.length - 1 ? null : viewSlot.children[index];\r\n    };\r\n    VirtualRepeat.prototype.addView = function (bindingContext, overrideContext) {\r\n        var view = this.viewFactory.create();\r\n        view.bind(bindingContext, overrideContext);\r\n        this.viewSlot.add(view);\r\n        return view;\r\n    };\r\n    VirtualRepeat.prototype.insertView = function (index, bindingContext, overrideContext) {\r\n        var view = this.viewFactory.create();\r\n        view.bind(bindingContext, overrideContext);\r\n        this.viewSlot.insert(index, view);\r\n    };\r\n    VirtualRepeat.prototype.removeAllViews = function (returnToCache, skipAnimation) {\r\n        return this.viewSlot.removeAll(returnToCache, skipAnimation);\r\n    };\r\n    VirtualRepeat.prototype.removeView = function (index, returnToCache, skipAnimation) {\r\n        return this.viewSlot.removeAt(index, returnToCache, skipAnimation);\r\n    };\r\n    VirtualRepeat.prototype.updateBindings = function (view) {\r\n        var bindings = view.bindings;\r\n        var j = bindings.length;\r\n        while (j--) {\r\n            Object(aurelia_templating_resources__WEBPACK_IMPORTED_MODULE_2__[\"updateOneTimeBinding\"])(bindings[j]);\r\n        }\r\n        var controllers = view.controllers;\r\n        j = controllers.length;\r\n        while (j--) {\r\n            var boundProperties = controllers[j].boundProperties;\r\n            var k = boundProperties.length;\r\n            while (k--) {\r\n                var binding = boundProperties[k].binding;\r\n                Object(aurelia_templating_resources__WEBPACK_IMPORTED_MODULE_2__[\"updateOneTimeBinding\"])(binding);\r\n            }\r\n        }\r\n    };\r\n    return VirtualRepeat;\r\n}(aurelia_templating_resources__WEBPACK_IMPORTED_MODULE_2__[\"AbstractRepeater\"]));\n\nvar InfiniteScrollNext = (function () {\r\n    function InfiniteScrollNext() {\r\n    }\r\n    InfiniteScrollNext.$resource = function () {\r\n        return {\r\n            type: 'attribute',\r\n            name: 'infinite-scroll-next'\r\n        };\r\n    };\r\n    return InfiniteScrollNext;\r\n}());\n\nfunction configure(config) {\r\n    config.globalResources(VirtualRepeat, InfiniteScrollNext);\r\n}\n\n\n\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! promise-polyfill */ \"B/eG\")[\"default\"]))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXVyZWxpYS11aS12aXJ0dWFsaXphdGlvbi5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9hdXJlbGlhLXVpLXZpcnR1YWxpemF0aW9uL2Rpc3QvbmF0aXZlLW1vZHVsZXMvYXVyZWxpYS11aS12aXJ0dWFsaXphdGlvbi5qcz9iN2JiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IG1lcmdlU3BsaWNlLCBPYnNlcnZlckxvY2F0b3IgfSBmcm9tICdhdXJlbGlhLWJpbmRpbmcnO1xuaW1wb3J0IHsgQm91bmRWaWV3RmFjdG9yeSwgVGFyZ2V0SW5zdHJ1Y3Rpb24sIFZpZXdTbG90LCBWaWV3UmVzb3VyY2VzLCBFbGVtZW50RXZlbnRzIH0gZnJvbSAnYXVyZWxpYS10ZW1wbGF0aW5nJztcbmltcG9ydCB7IHVwZGF0ZU92ZXJyaWRlQ29udGV4dCwgY3JlYXRlRnVsbE92ZXJyaWRlQ29udGV4dCwgQXJyYXlSZXBlYXRTdHJhdGVneSwgTnVsbFJlcGVhdFN0cmF0ZWd5LCB2aWV3c1JlcXVpcmVMaWZlY3ljbGUsIGdldEl0ZW1zU291cmNlRXhwcmVzc2lvbiwgaXNPbmVUaW1lLCB1bndyYXBFeHByZXNzaW9uLCB1cGRhdGVPbmVUaW1lQmluZGluZywgQWJzdHJhY3RSZXBlYXRlciB9IGZyb20gJ2F1cmVsaWEtdGVtcGxhdGluZy1yZXNvdXJjZXMnO1xuaW1wb3J0IHsgRE9NLCBQTEFURk9STSB9IGZyb20gJ2F1cmVsaWEtcGFsJztcbmltcG9ydCB7IENvbnRhaW5lciB9IGZyb20gJ2F1cmVsaWEtZGVwZW5kZW5jeS1pbmplY3Rpb24nO1xuXG4vKiEgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbkxpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90IHVzZVxyXG50aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZVxyXG5MaWNlbnNlIGF0IGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG5cclxuVEhJUyBDT0RFIElTIFBST1ZJREVEIE9OIEFOICpBUyBJUyogQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWVxyXG5LSU5ELCBFSVRIRVIgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkcgV0lUSE9VVCBMSU1JVEFUSU9OIEFOWSBJTVBMSUVEXHJcbldBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBUSVRMRSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UsXHJcbk1FUkNIQU5UQUJMSVRZIE9SIE5PTi1JTkZSSU5HRU1FTlQuXHJcblxyXG5TZWUgdGhlIEFwYWNoZSBWZXJzaW9uIDIuMCBMaWNlbnNlIGZvciBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnNcclxuYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqL1xyXG4vKiBnbG9iYWwgUmVmbGVjdCwgUHJvbWlzZSAqL1xyXG5cclxudmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbihkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xyXG4gICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbn07XHJcblxyXG5mdW5jdGlvbiBfX2V4dGVuZHMoZCwgYikge1xyXG4gICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxuICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxyXG4gICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xyXG59XG5cbnZhciByZWJpbmRWaWV3ID0gZnVuY3Rpb24gKHJlcGVhdCwgdmlldywgY29sbGVjdGlvbkluZGV4LCBjb2xsZWN0aW9uKSB7XHJcbiAgICB2aWV3LmJpbmRpbmdDb250ZXh0W3JlcGVhdC5sb2NhbF0gPSBjb2xsZWN0aW9uW2NvbGxlY3Rpb25JbmRleF07XHJcbiAgICB1cGRhdGVPdmVycmlkZUNvbnRleHQodmlldy5vdmVycmlkZUNvbnRleHQsIGNvbGxlY3Rpb25JbmRleCwgY29sbGVjdGlvbi5sZW5ndGgpO1xyXG59O1xyXG52YXIgcmViaW5kQW5kTW92ZVZpZXcgPSBmdW5jdGlvbiAocmVwZWF0LCB2aWV3LCBpbmRleCwgbW92ZVRvQm90dG9tKSB7XHJcbiAgICB2YXIgaXRlbXMgPSByZXBlYXQuaXRlbXM7XHJcbiAgICB2YXIgdmlld1Nsb3QgPSByZXBlYXQudmlld1Nsb3Q7XHJcbiAgICB1cGRhdGVPdmVycmlkZUNvbnRleHQodmlldy5vdmVycmlkZUNvbnRleHQsIGluZGV4LCBpdGVtcy5sZW5ndGgpO1xyXG4gICAgdmlldy5iaW5kaW5nQ29udGV4dFtyZXBlYXQubG9jYWxdID0gaXRlbXNbaW5kZXhdO1xyXG4gICAgaWYgKG1vdmVUb0JvdHRvbSkge1xyXG4gICAgICAgIHZpZXdTbG90LmNoaWxkcmVuLnB1c2godmlld1Nsb3QuY2hpbGRyZW4uc2hpZnQoKSk7XHJcbiAgICAgICAgcmVwZWF0LnRlbXBsYXRlU3RyYXRlZ3kubW92ZVZpZXdMYXN0KHZpZXcsIHJlcGVhdC5ib3R0b21CdWZmZXJFbCk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICB2aWV3U2xvdC5jaGlsZHJlbi51bnNoaWZ0KHZpZXdTbG90LmNoaWxkcmVuLnNwbGljZSgtMSwgMSlbMF0pO1xyXG4gICAgICAgIHJlcGVhdC50ZW1wbGF0ZVN0cmF0ZWd5Lm1vdmVWaWV3Rmlyc3QodmlldywgcmVwZWF0LnRvcEJ1ZmZlckVsKTtcclxuICAgIH1cclxufTtcclxudmFyIGNhbGNNaW5WaWV3c1JlcXVpcmVkID0gZnVuY3Rpb24gKHNjcm9sbGVySGVpZ2h0LCBpdGVtSGVpZ2h0KSB7XHJcbiAgICByZXR1cm4gTWF0aCRmbG9vcihzY3JvbGxlckhlaWdodCAvIGl0ZW1IZWlnaHQpICsgMTtcclxufTtcclxudmFyIE1hdGgkYWJzID0gTWF0aC5hYnM7XHJcbnZhciBNYXRoJG1heCA9IE1hdGgubWF4O1xyXG52YXIgTWF0aCRtaW4gPSBNYXRoLm1pbjtcclxudmFyIE1hdGgkcm91bmQgPSBNYXRoLnJvdW5kO1xyXG52YXIgTWF0aCRmbG9vciA9IE1hdGguZmxvb3I7XHJcbnZhciAkaXNOYU4gPSBpc05hTjtcblxudmFyIGRvYyA9IGRvY3VtZW50O1xyXG52YXIgaHRtbEVsZW1lbnQgPSBkb2MuZG9jdW1lbnRFbGVtZW50O1xyXG52YXIgJHJhZiA9IHJlcXVlc3RBbmltYXRpb25GcmFtZTtcblxudmFyIGdldFNjcm9sbGVyRWxlbWVudCA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XHJcbiAgICB2YXIgY3VycmVudCA9IGVsZW1lbnQucGFyZW50Tm9kZTtcclxuICAgIHdoaWxlIChjdXJyZW50ICE9PSBudWxsICYmIGN1cnJlbnQgIT09IGh0bWxFbGVtZW50KSB7XHJcbiAgICAgICAgaWYgKGhhc092ZXJmbG93U2Nyb2xsKGN1cnJlbnQpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBjdXJyZW50O1xyXG4gICAgICAgIH1cclxuICAgICAgICBjdXJyZW50ID0gY3VycmVudC5wYXJlbnROb2RlO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGh0bWxFbGVtZW50O1xyXG59O1xyXG52YXIgZ2V0RWxlbWVudERpc3RhbmNlVG9Ub3BPZkRvY3VtZW50ID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcclxuICAgIHZhciBib3ggPSBlbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgdmFyIHNjcm9sbFRvcCA9IHdpbmRvdy5wYWdlWU9mZnNldDtcclxuICAgIHZhciBjbGllbnRUb3AgPSBodG1sRWxlbWVudC5jbGllbnRUb3A7XHJcbiAgICB2YXIgdG9wID0gYm94LnRvcCArIHNjcm9sbFRvcCAtIGNsaWVudFRvcDtcclxuICAgIHJldHVybiBNYXRoJHJvdW5kKHRvcCk7XHJcbn07XHJcbnZhciBoYXNPdmVyZmxvd1Njcm9sbCA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XHJcbiAgICB2YXIgc3R5bGUgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShlbGVtZW50KTtcclxuICAgIHJldHVybiBzdHlsZSAmJiAoc3R5bGUub3ZlcmZsb3dZID09PSAnc2Nyb2xsJyB8fCBzdHlsZS5vdmVyZmxvdyA9PT0gJ3Njcm9sbCcgfHwgc3R5bGUub3ZlcmZsb3dZID09PSAnYXV0bycgfHwgc3R5bGUub3ZlcmZsb3cgPT09ICdhdXRvJyk7XHJcbn07XHJcbnZhciBnZXRTdHlsZVZhbHVlcyA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XHJcbiAgICB2YXIgc3R5bGVzID0gW107XHJcbiAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xyXG4gICAgICAgIHN0eWxlc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTtcclxuICAgIH1cclxuICAgIHZhciBjdXJyZW50U3R5bGUgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShlbGVtZW50KTtcclxuICAgIHZhciB2YWx1ZSA9IDA7XHJcbiAgICB2YXIgc3R5bGVWYWx1ZSA9IDA7XHJcbiAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBzdHlsZXMubGVuZ3RoOyBpaSA+IGk7ICsraSkge1xyXG4gICAgICAgIHN0eWxlVmFsdWUgPSBwYXJzZUZsb2F0KGN1cnJlbnRTdHlsZVtzdHlsZXNbaV1dKTtcclxuICAgICAgICB2YWx1ZSArPSAkaXNOYU4oc3R5bGVWYWx1ZSkgPyAwIDogc3R5bGVWYWx1ZTtcclxuICAgIH1cclxuICAgIHJldHVybiB2YWx1ZTtcclxufTtcclxudmFyIGNhbGNPdXRlckhlaWdodCA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XHJcbiAgICB2YXIgaGVpZ2h0ID0gZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5oZWlnaHQ7XHJcbiAgICBoZWlnaHQgKz0gZ2V0U3R5bGVWYWx1ZXMoZWxlbWVudCwgJ21hcmdpblRvcCcsICdtYXJnaW5Cb3R0b20nKTtcclxuICAgIHJldHVybiBoZWlnaHQ7XHJcbn07XHJcbnZhciBjYWxjU2Nyb2xsSGVpZ2h0ID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcclxuICAgIHZhciBoZWlnaHQgPSBlbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmhlaWdodDtcclxuICAgIGhlaWdodCAtPSBnZXRTdHlsZVZhbHVlcyhlbGVtZW50LCAnYm9yZGVyVG9wV2lkdGgnLCAnYm9yZGVyQm90dG9tV2lkdGgnKTtcclxuICAgIHJldHVybiBoZWlnaHQ7XHJcbn07XHJcbnZhciBpbnNlcnRCZWZvcmVOb2RlID0gZnVuY3Rpb24gKHZpZXcsIGJvdHRvbUJ1ZmZlcikge1xyXG4gICAgYm90dG9tQnVmZmVyLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHZpZXcubGFzdENoaWxkLCBib3R0b21CdWZmZXIpO1xyXG59O1xyXG52YXIgZ2V0RGlzdGFuY2VUb1BhcmVudCA9IGZ1bmN0aW9uIChjaGlsZCwgcGFyZW50KSB7XHJcbiAgICB2YXIgb2Zmc2V0UGFyZW50ID0gY2hpbGQub2Zmc2V0UGFyZW50O1xyXG4gICAgdmFyIGNoaWxkT2Zmc2V0VG9wID0gY2hpbGQub2Zmc2V0VG9wO1xyXG4gICAgaWYgKG9mZnNldFBhcmVudCA9PT0gbnVsbCB8fCBvZmZzZXRQYXJlbnQgPT09IHBhcmVudCkge1xyXG4gICAgICAgIHJldHVybiBjaGlsZE9mZnNldFRvcDtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIGlmIChvZmZzZXRQYXJlbnQuY29udGFpbnMocGFyZW50KSkge1xyXG4gICAgICAgICAgICByZXR1cm4gY2hpbGRPZmZzZXRUb3AgLSBwYXJlbnQub2Zmc2V0VG9wO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIGNoaWxkT2Zmc2V0VG9wICsgZ2V0RGlzdGFuY2VUb1BhcmVudChvZmZzZXRQYXJlbnQsIHBhcmVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xuXG52YXIgQXJyYXlWaXJ0dWFsUmVwZWF0U3RyYXRlZ3kgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgX19leHRlbmRzKEFycmF5VmlydHVhbFJlcGVhdFN0cmF0ZWd5LCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gQXJyYXlWaXJ0dWFsUmVwZWF0U3RyYXRlZ3koKSB7XHJcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xyXG4gICAgfVxyXG4gICAgQXJyYXlWaXJ0dWFsUmVwZWF0U3RyYXRlZ3kucHJvdG90eXBlLmNyZWF0ZUZpcnN0Um93ID0gZnVuY3Rpb24gKHJlcGVhdCkge1xyXG4gICAgICAgIHZhciBvdmVycmlkZUNvbnRleHQgPSBjcmVhdGVGdWxsT3ZlcnJpZGVDb250ZXh0KHJlcGVhdCwgcmVwZWF0Lml0ZW1zWzBdLCAwLCAxKTtcclxuICAgICAgICByZXR1cm4gcmVwZWF0LmFkZFZpZXcob3ZlcnJpZGVDb250ZXh0LmJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpO1xyXG4gICAgfTtcclxuICAgIEFycmF5VmlydHVhbFJlcGVhdFN0cmF0ZWd5LnByb3RvdHlwZS5pbml0Q2FsY3VsYXRpb24gPSBmdW5jdGlvbiAocmVwZWF0LCBpdGVtcykge1xyXG4gICAgICAgIHZhciBpdGVtQ291bnQgPSBpdGVtcy5sZW5ndGg7XHJcbiAgICAgICAgaWYgKCEoaXRlbUNvdW50ID4gMCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIDE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBzY3JvbGxlckluZm8gPSByZXBlYXQuZ2V0U2Nyb2xsZXJJbmZvKCk7XHJcbiAgICAgICAgdmFyIGV4aXN0aW5nVmlld0NvdW50ID0gcmVwZWF0LnZpZXdDb3VudCgpO1xyXG4gICAgICAgIGlmIChpdGVtQ291bnQgPiAwICYmIGV4aXN0aW5nVmlld0NvdW50ID09PSAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlRmlyc3RSb3cocmVwZWF0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGZpcnN0VmlldyA9IHJlcGVhdC5maXJzdFZpZXcoKTtcclxuICAgICAgICB2YXIgaXRlbUhlaWdodCA9IGNhbGNPdXRlckhlaWdodChmaXJzdFZpZXcuZmlyc3RDaGlsZCk7XHJcbiAgICAgICAgaWYgKGl0ZW1IZWlnaHQgPT09IDApIHtcclxuICAgICAgICAgICAgcmV0dXJuIDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJlcGVhdC5pdGVtSGVpZ2h0ID0gaXRlbUhlaWdodDtcclxuICAgICAgICB2YXIgc2Nyb2xsX2VsX2hlaWdodCA9IHNjcm9sbGVySW5mby5oZWlnaHQ7XHJcbiAgICAgICAgdmFyIGVsZW1lbnRzSW5WaWV3ID0gcmVwZWF0Lm1pblZpZXdzUmVxdWlyZWQgPSBjYWxjTWluVmlld3NSZXF1aXJlZChzY3JvbGxfZWxfaGVpZ2h0LCBpdGVtSGVpZ2h0KTtcclxuICAgICAgICByZXR1cm4gMiB8IDQ7XHJcbiAgICB9O1xyXG4gICAgQXJyYXlWaXJ0dWFsUmVwZWF0U3RyYXRlZ3kucHJvdG90eXBlLm9uQXR0YWNoZWQgPSBmdW5jdGlvbiAocmVwZWF0KSB7XHJcbiAgICAgICAgaWYgKHJlcGVhdC5pdGVtcy5sZW5ndGggPCByZXBlYXQubWluVmlld3NSZXF1aXJlZCkge1xyXG4gICAgICAgICAgICByZXBlYXQuZ2V0TW9yZSgwLCB0cnVlLCB0aGlzLmlzTmVhckJvdHRvbShyZXBlYXQsIHJlcGVhdC5sYXN0Vmlld0luZGV4KCkpLCB0cnVlKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgQXJyYXlWaXJ0dWFsUmVwZWF0U3RyYXRlZ3kucHJvdG90eXBlLmdldFZpZXdSYW5nZSA9IGZ1bmN0aW9uIChyZXBlYXQsIHNjcm9sbGVySW5mbykge1xyXG4gICAgICAgIHZhciB0b3BCdWZmZXJFbCA9IHJlcGVhdC50b3BCdWZmZXJFbDtcclxuICAgICAgICB2YXIgc2Nyb2xsZXJFbCA9IHJlcGVhdC5zY3JvbGxlckVsO1xyXG4gICAgICAgIHZhciBpdGVtSGVpZ2h0ID0gcmVwZWF0Lml0ZW1IZWlnaHQ7XHJcbiAgICAgICAgdmFyIHJlYWxTY3JvbGxUb3AgPSAwO1xyXG4gICAgICAgIHZhciBpc0ZpeGVkSGVpZ2h0Q29udGFpbmVyID0gc2Nyb2xsZXJJbmZvLnNjcm9sbGVyICE9PSBodG1sRWxlbWVudDtcclxuICAgICAgICBpZiAoaXNGaXhlZEhlaWdodENvbnRhaW5lcikge1xyXG4gICAgICAgICAgICB2YXIgdG9wQnVmZmVyRGlzdGFuY2UgPSBnZXREaXN0YW5jZVRvUGFyZW50KHRvcEJ1ZmZlckVsLCBzY3JvbGxlckVsKTtcclxuICAgICAgICAgICAgdmFyIHNjcm9sbGVyU2Nyb2xsVG9wID0gc2Nyb2xsZXJJbmZvLnNjcm9sbFRvcDtcclxuICAgICAgICAgICAgcmVhbFNjcm9sbFRvcCA9IE1hdGgkbWF4KDAsIHNjcm9sbGVyU2Nyb2xsVG9wIC0gTWF0aCRhYnModG9wQnVmZmVyRGlzdGFuY2UpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJlYWxTY3JvbGxUb3AgPSBwYWdlWU9mZnNldCAtIHJlcGVhdC5kaXN0YW5jZVRvVG9wO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgcmVhbFZpZXdDb3VudCA9IHJlcGVhdC5taW5WaWV3c1JlcXVpcmVkICogMjtcclxuICAgICAgICB2YXIgZmlyc3RWaXNpYmxlSW5kZXggPSBNYXRoJG1heCgwLCBpdGVtSGVpZ2h0ID4gMCA/IE1hdGgkZmxvb3IocmVhbFNjcm9sbFRvcCAvIGl0ZW1IZWlnaHQpIDogMCk7XHJcbiAgICAgICAgdmFyIGxhc3RWaXNpYmxlSW5kZXggPSBNYXRoJG1pbihyZXBlYXQuaXRlbXMubGVuZ3RoIC0gMSwgZmlyc3RWaXNpYmxlSW5kZXggKyAocmVhbFZpZXdDb3VudCAtIDEpKTtcclxuICAgICAgICBmaXJzdFZpc2libGVJbmRleCA9IE1hdGgkbWF4KDAsIE1hdGgkbWluKGZpcnN0VmlzaWJsZUluZGV4LCBsYXN0VmlzaWJsZUluZGV4IC0gKHJlYWxWaWV3Q291bnQgLSAxKSkpO1xyXG4gICAgICAgIHJldHVybiBbZmlyc3RWaXNpYmxlSW5kZXgsIGxhc3RWaXNpYmxlSW5kZXhdO1xyXG4gICAgfTtcclxuICAgIEFycmF5VmlydHVhbFJlcGVhdFN0cmF0ZWd5LnByb3RvdHlwZS51cGRhdGVCdWZmZXJzID0gZnVuY3Rpb24gKHJlcGVhdCwgZmlyc3RJbmRleCkge1xyXG4gICAgICAgIHZhciBpdGVtSGVpZ2h0ID0gcmVwZWF0Lml0ZW1IZWlnaHQ7XHJcbiAgICAgICAgdmFyIGl0ZW1Db3VudCA9IHJlcGVhdC5pdGVtcy5sZW5ndGg7XHJcbiAgICAgICAgcmVwZWF0LnRvcEJ1ZmZlckhlaWdodCA9IGZpcnN0SW5kZXggKiBpdGVtSGVpZ2h0O1xyXG4gICAgICAgIHJlcGVhdC5ib3R0b21CdWZmZXJIZWlnaHQgPSAoaXRlbUNvdW50IC0gZmlyc3RJbmRleCAtIHJlcGVhdC52aWV3Q291bnQoKSkgKiBpdGVtSGVpZ2h0O1xyXG4gICAgICAgIHJlcGVhdC51cGRhdGVCdWZmZXJFbGVtZW50cyh0cnVlKTtcclxuICAgIH07XHJcbiAgICBBcnJheVZpcnR1YWxSZXBlYXRTdHJhdGVneS5wcm90b3R5cGUuaXNOZWFyVG9wID0gZnVuY3Rpb24gKHJlcGVhdCwgZmlyc3RJbmRleCkge1xyXG4gICAgICAgIHZhciBpdGVtQ291bnQgPSByZXBlYXQuaXRlbXMubGVuZ3RoO1xyXG4gICAgICAgIHJldHVybiBpdGVtQ291bnQgPiAwXHJcbiAgICAgICAgICAgID8gZmlyc3RJbmRleCA8IHJlcGVhdC5lZGdlRGlzdGFuY2VcclxuICAgICAgICAgICAgOiBmYWxzZTtcclxuICAgIH07XHJcbiAgICBBcnJheVZpcnR1YWxSZXBlYXRTdHJhdGVneS5wcm90b3R5cGUuaXNOZWFyQm90dG9tID0gZnVuY3Rpb24gKHJlcGVhdCwgbGFzdEluZGV4KSB7XHJcbiAgICAgICAgdmFyIGl0ZW1Db3VudCA9IHJlcGVhdC5pdGVtcy5sZW5ndGg7XHJcbiAgICAgICAgcmV0dXJuIGxhc3RJbmRleCA9PT0gLTFcclxuICAgICAgICAgICAgPyB0cnVlXHJcbiAgICAgICAgICAgIDogaXRlbUNvdW50ID4gMFxyXG4gICAgICAgICAgICAgICAgPyBsYXN0SW5kZXggPiAoaXRlbUNvdW50IC0gcmVwZWF0LmVkZ2VEaXN0YW5jZSlcclxuICAgICAgICAgICAgICAgIDogZmFsc2U7XHJcbiAgICB9O1xyXG4gICAgQXJyYXlWaXJ0dWFsUmVwZWF0U3RyYXRlZ3kucHJvdG90eXBlLmluc3RhbmNlQ2hhbmdlZCA9IGZ1bmN0aW9uIChyZXBlYXQsIGl0ZW1zLCBmaXJzdCkge1xyXG4gICAgICAgIGlmICh0aGlzLl9pblBsYWNlUHJvY2Vzc0l0ZW1zKHJlcGVhdCwgaXRlbXMsIGZpcnN0KSkge1xyXG4gICAgICAgICAgICB0aGlzLl9yZW1lYXN1cmUocmVwZWF0LCByZXBlYXQuaXRlbUhlaWdodCwgcmVwZWF0Lm1pblZpZXdzUmVxdWlyZWQgKiAyLCBpdGVtcy5sZW5ndGgsIHJlcGVhdC4kZmlyc3QpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBBcnJheVZpcnR1YWxSZXBlYXRTdHJhdGVneS5wcm90b3R5cGUuaW5zdGFuY2VNdXRhdGVkID0gZnVuY3Rpb24gKHJlcGVhdCwgYXJyYXksIHNwbGljZXMpIHtcclxuICAgICAgICB0aGlzLl9zdGFuZGFyZFByb2Nlc3NJbnN0YW5jZU11dGF0ZWQocmVwZWF0LCBhcnJheSwgc3BsaWNlcyk7XHJcbiAgICB9O1xyXG4gICAgQXJyYXlWaXJ0dWFsUmVwZWF0U3RyYXRlZ3kucHJvdG90eXBlLl9pblBsYWNlUHJvY2Vzc0l0ZW1zID0gZnVuY3Rpb24gKCRyZXBlYXQsIGl0ZW1zLCBmaXJzdEluZGV4KSB7XHJcbiAgICAgICAgdmFyIHJlcGVhdCA9ICRyZXBlYXQ7XHJcbiAgICAgICAgdmFyIGN1cnJJdGVtQ291bnQgPSBpdGVtcy5sZW5ndGg7XHJcbiAgICAgICAgaWYgKGN1cnJJdGVtQ291bnQgPT09IDApIHtcclxuICAgICAgICAgICAgcmVwZWF0LnJlbW92ZUFsbFZpZXdzKHRydWUsIGZhbHNlKTtcclxuICAgICAgICAgICAgcmVwZWF0LnJlc2V0Q2FsY3VsYXRpb24oKTtcclxuICAgICAgICAgICAgcmVwZWF0Ll9fcXVldWVkU3BsaWNlcyA9IHJlcGVhdC5fX2FycmF5ID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBtYXhfdmlld3NfY291bnQgPSByZXBlYXQubWluVmlld3NSZXF1aXJlZCAqIDI7XHJcbiAgICAgICAgdmFyIHJlYWxWaWV3c0NvdW50ID0gcmVwZWF0LnZpZXdDb3VudCgpO1xyXG4gICAgICAgIHdoaWxlIChyZWFsVmlld3NDb3VudCA+IGN1cnJJdGVtQ291bnQpIHtcclxuICAgICAgICAgICAgcmVhbFZpZXdzQ291bnQtLTtcclxuICAgICAgICAgICAgcmVwZWF0LnJlbW92ZVZpZXcocmVhbFZpZXdzQ291bnQsIHRydWUsIGZhbHNlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgd2hpbGUgKHJlYWxWaWV3c0NvdW50ID4gbWF4X3ZpZXdzX2NvdW50KSB7XHJcbiAgICAgICAgICAgIHJlYWxWaWV3c0NvdW50LS07XHJcbiAgICAgICAgICAgIHJlcGVhdC5yZW1vdmVWaWV3KHJlYWxWaWV3c0NvdW50LCB0cnVlLCBmYWxzZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJlYWxWaWV3c0NvdW50ID0gTWF0aCRtaW4ocmVhbFZpZXdzQ291bnQsIG1heF92aWV3c19jb3VudCk7XHJcbiAgICAgICAgdmFyIGxvY2FsID0gcmVwZWF0LmxvY2FsO1xyXG4gICAgICAgIHZhciBsYXN0SW5kZXggPSBjdXJySXRlbUNvdW50IC0gMTtcclxuICAgICAgICBpZiAoZmlyc3RJbmRleCArIHJlYWxWaWV3c0NvdW50ID4gbGFzdEluZGV4KSB7XHJcbiAgICAgICAgICAgIGZpcnN0SW5kZXggPSBNYXRoJG1heCgwLCBjdXJySXRlbUNvdW50IC0gcmVhbFZpZXdzQ291bnQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXBlYXQuJGZpcnN0ID0gZmlyc3RJbmRleDtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJlYWxWaWV3c0NvdW50OyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIGN1cnJJbmRleCA9IGkgKyBmaXJzdEluZGV4O1xyXG4gICAgICAgICAgICB2YXIgdmlldyA9IHJlcGVhdC52aWV3KGkpO1xyXG4gICAgICAgICAgICB2YXIgbGFzdCA9IGN1cnJJbmRleCA9PT0gY3Vyckl0ZW1Db3VudCAtIDE7XHJcbiAgICAgICAgICAgIHZhciBtaWRkbGUgPSBjdXJySW5kZXggIT09IDAgJiYgIWxhc3Q7XHJcbiAgICAgICAgICAgIHZhciBiaW5kaW5nQ29udGV4dCA9IHZpZXcuYmluZGluZ0NvbnRleHQ7XHJcbiAgICAgICAgICAgIHZhciBvdmVycmlkZUNvbnRleHQgPSB2aWV3Lm92ZXJyaWRlQ29udGV4dDtcclxuICAgICAgICAgICAgaWYgKGJpbmRpbmdDb250ZXh0W2xvY2FsXSA9PT0gaXRlbXNbY3VyckluZGV4XVxyXG4gICAgICAgICAgICAgICAgJiYgb3ZlcnJpZGVDb250ZXh0LiRpbmRleCA9PT0gY3VyckluZGV4XHJcbiAgICAgICAgICAgICAgICAmJiBvdmVycmlkZUNvbnRleHQuJG1pZGRsZSA9PT0gbWlkZGxlXHJcbiAgICAgICAgICAgICAgICAmJiBvdmVycmlkZUNvbnRleHQuJGxhc3QgPT09IGxhc3QpIHtcclxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGJpbmRpbmdDb250ZXh0W2xvY2FsXSA9IGl0ZW1zW2N1cnJJbmRleF07XHJcbiAgICAgICAgICAgIG92ZXJyaWRlQ29udGV4dC4kZmlyc3QgPSBjdXJySW5kZXggPT09IDA7XHJcbiAgICAgICAgICAgIG92ZXJyaWRlQ29udGV4dC4kbWlkZGxlID0gbWlkZGxlO1xyXG4gICAgICAgICAgICBvdmVycmlkZUNvbnRleHQuJGxhc3QgPSBsYXN0O1xyXG4gICAgICAgICAgICBvdmVycmlkZUNvbnRleHQuJGluZGV4ID0gY3VyckluZGV4O1xyXG4gICAgICAgICAgICB2YXIgb2RkID0gY3VyckluZGV4ICUgMiA9PT0gMTtcclxuICAgICAgICAgICAgb3ZlcnJpZGVDb250ZXh0LiRvZGQgPSBvZGQ7XHJcbiAgICAgICAgICAgIG92ZXJyaWRlQ29udGV4dC4kZXZlbiA9ICFvZGQ7XHJcbiAgICAgICAgICAgIHJlcGVhdC51cGRhdGVCaW5kaW5ncyh2aWV3KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIG1pbkxlbmd0aCA9IE1hdGgkbWluKG1heF92aWV3c19jb3VudCwgY3Vyckl0ZW1Db3VudCk7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IHJlYWxWaWV3c0NvdW50OyBpIDwgbWluTGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIG92ZXJyaWRlQ29udGV4dCA9IGNyZWF0ZUZ1bGxPdmVycmlkZUNvbnRleHQocmVwZWF0LCBpdGVtc1tpXSwgaSwgY3Vyckl0ZW1Db3VudCk7XHJcbiAgICAgICAgICAgIHJlcGVhdC5hZGRWaWV3KG92ZXJyaWRlQ29udGV4dC5iaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9O1xyXG4gICAgQXJyYXlWaXJ0dWFsUmVwZWF0U3RyYXRlZ3kucHJvdG90eXBlLl9zdGFuZGFyZFByb2Nlc3NJbnN0YW5jZU11dGF0ZWQgPSBmdW5jdGlvbiAoJHJlcGVhdCwgYXJyYXksIHNwbGljZXMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciByZXBlYXQgPSAkcmVwZWF0O1xyXG4gICAgICAgIGlmIChyZXBlYXQuX19xdWV1ZWRTcGxpY2VzKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IHNwbGljZXMubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIF9hID0gc3BsaWNlc1tpXSwgaW5kZXggPSBfYS5pbmRleCwgcmVtb3ZlZCA9IF9hLnJlbW92ZWQsIGFkZGVkQ291bnQgPSBfYS5hZGRlZENvdW50O1xyXG4gICAgICAgICAgICAgICAgbWVyZ2VTcGxpY2UocmVwZWF0Ll9fcXVldWVkU3BsaWNlcywgaW5kZXgsIHJlbW92ZWQsIGFkZGVkQ291bnQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJlcGVhdC5fX2FycmF5ID0gYXJyYXkuc2xpY2UoMCk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGFycmF5Lmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICByZXBlYXQucmVtb3ZlQWxsVmlld3ModHJ1ZSwgZmFsc2UpO1xyXG4gICAgICAgICAgICByZXBlYXQucmVzZXRDYWxjdWxhdGlvbigpO1xyXG4gICAgICAgICAgICByZXBlYXQuX19xdWV1ZWRTcGxpY2VzID0gcmVwZWF0Ll9fYXJyYXkgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIG1heWJlUHJvbWlzZSA9IHRoaXMuX3J1blNwbGljZXMocmVwZWF0LCBhcnJheS5zbGljZSgwKSwgc3BsaWNlcyk7XHJcbiAgICAgICAgaWYgKG1heWJlUHJvbWlzZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcclxuICAgICAgICAgICAgdmFyIHF1ZXVlZFNwbGljZXNfMSA9IHJlcGVhdC5fX3F1ZXVlZFNwbGljZXMgPSBbXTtcclxuICAgICAgICAgICAgdmFyIHJ1blF1ZXVlZFNwbGljZXNfMSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGlmICghcXVldWVkU3BsaWNlc18xLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlcGVhdC5fX3F1ZXVlZFNwbGljZXMgPSByZXBlYXQuX19hcnJheSA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB2YXIgbmV4dFByb21pc2UgPSBfdGhpcy5fcnVuU3BsaWNlcyhyZXBlYXQsIHJlcGVhdC5fX2FycmF5LCBxdWV1ZWRTcGxpY2VzXzEpIHx8IFByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICAgICAgbmV4dFByb21pc2UudGhlbihydW5RdWV1ZWRTcGxpY2VzXzEpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBtYXliZVByb21pc2UudGhlbihydW5RdWV1ZWRTcGxpY2VzXzEpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBBcnJheVZpcnR1YWxSZXBlYXRTdHJhdGVneS5wcm90b3R5cGUuX3J1blNwbGljZXMgPSBmdW5jdGlvbiAocmVwZWF0LCBuZXdBcnJheSwgc3BsaWNlcykge1xyXG4gICAgICAgIHZhciBmaXJzdEluZGV4ID0gcmVwZWF0LiRmaXJzdDtcclxuICAgICAgICB2YXIgdG90YWxSZW1vdmVkQ291bnQgPSAwO1xyXG4gICAgICAgIHZhciB0b3RhbEFkZGVkQ291bnQgPSAwO1xyXG4gICAgICAgIHZhciBzcGxpY2U7XHJcbiAgICAgICAgdmFyIGkgPSAwO1xyXG4gICAgICAgIHZhciBzcGxpY2VDb3VudCA9IHNwbGljZXMubGVuZ3RoO1xyXG4gICAgICAgIHZhciBuZXdBcnJheVNpemUgPSBuZXdBcnJheS5sZW5ndGg7XHJcbiAgICAgICAgdmFyIGFsbFNwbGljZXNBcmVJbnBsYWNlID0gdHJ1ZTtcclxuICAgICAgICBmb3IgKGkgPSAwOyBzcGxpY2VDb3VudCA+IGk7IGkrKykge1xyXG4gICAgICAgICAgICBzcGxpY2UgPSBzcGxpY2VzW2ldO1xyXG4gICAgICAgICAgICB2YXIgcmVtb3ZlZENvdW50ID0gc3BsaWNlLnJlbW92ZWQubGVuZ3RoO1xyXG4gICAgICAgICAgICB2YXIgYWRkZWRDb3VudCA9IHNwbGljZS5hZGRlZENvdW50O1xyXG4gICAgICAgICAgICB0b3RhbFJlbW92ZWRDb3VudCArPSByZW1vdmVkQ291bnQ7XHJcbiAgICAgICAgICAgIHRvdGFsQWRkZWRDb3VudCArPSBhZGRlZENvdW50O1xyXG4gICAgICAgICAgICBpZiAocmVtb3ZlZENvdW50ICE9PSBhZGRlZENvdW50KSB7XHJcbiAgICAgICAgICAgICAgICBhbGxTcGxpY2VzQXJlSW5wbGFjZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChhbGxTcGxpY2VzQXJlSW5wbGFjZSkge1xyXG4gICAgICAgICAgICB2YXIgbGFzdEluZGV4ID0gcmVwZWF0Lmxhc3RWaWV3SW5kZXgoKTtcclxuICAgICAgICAgICAgdmFyIHJlcGVhdFZpZXdTbG90ID0gcmVwZWF0LnZpZXdTbG90O1xyXG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBzcGxpY2VDb3VudCA+IGk7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgc3BsaWNlID0gc3BsaWNlc1tpXTtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGNvbGxlY3Rpb25JbmRleCA9IHNwbGljZS5pbmRleDsgY29sbGVjdGlvbkluZGV4IDwgc3BsaWNlLmluZGV4ICsgc3BsaWNlLmFkZGVkQ291bnQ7IGNvbGxlY3Rpb25JbmRleCsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbGxlY3Rpb25JbmRleCA+PSBmaXJzdEluZGV4ICYmIGNvbGxlY3Rpb25JbmRleCA8PSBsYXN0SW5kZXgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZpZXdJbmRleCA9IGNvbGxlY3Rpb25JbmRleCAtIGZpcnN0SW5kZXg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvdmVycmlkZUNvbnRleHQgPSBjcmVhdGVGdWxsT3ZlcnJpZGVDb250ZXh0KHJlcGVhdCwgbmV3QXJyYXlbY29sbGVjdGlvbkluZGV4XSwgY29sbGVjdGlvbkluZGV4LCBuZXdBcnJheVNpemUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXBlYXQucmVtb3ZlVmlldyh2aWV3SW5kZXgsIHRydWUsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXBlYXQuaW5zZXJ0Vmlldyh2aWV3SW5kZXgsIG92ZXJyaWRlQ29udGV4dC5iaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgZmlyc3RJbmRleEFmdGVyTXV0YXRpb24gPSBmaXJzdEluZGV4O1xyXG4gICAgICAgIHZhciBpdGVtSGVpZ2h0ID0gcmVwZWF0Lml0ZW1IZWlnaHQ7XHJcbiAgICAgICAgdmFyIG9yaWdpbmFsU2l6ZSA9IG5ld0FycmF5U2l6ZSArIHRvdGFsUmVtb3ZlZENvdW50IC0gdG90YWxBZGRlZENvdW50O1xyXG4gICAgICAgIHZhciBjdXJyVmlld0NvdW50ID0gcmVwZWF0LnZpZXdDb3VudCgpO1xyXG4gICAgICAgIHZhciBuZXdWaWV3Q291bnQgPSBjdXJyVmlld0NvdW50O1xyXG4gICAgICAgIGlmIChvcmlnaW5hbFNpemUgPT09IDAgJiYgaXRlbUhlaWdodCA9PT0gMCkge1xyXG4gICAgICAgICAgICByZXBlYXQucmVzZXRDYWxjdWxhdGlvbigpO1xyXG4gICAgICAgICAgICByZXBlYXQuaXRlbXNDaGFuZ2VkKCk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGFsbF9zcGxpY2VzX2FyZV9wb3NpdGl2ZV9hbmRfYmVmb3JlX3ZpZXdfcG9ydCA9IHRvdGFsUmVtb3ZlZENvdW50ID09PSAwXHJcbiAgICAgICAgICAgICYmIHRvdGFsQWRkZWRDb3VudCA+IDBcclxuICAgICAgICAgICAgJiYgc3BsaWNlcy5ldmVyeShmdW5jdGlvbiAoc3BsaWNlKSB7IHJldHVybiBzcGxpY2UuaW5kZXggPD0gZmlyc3RJbmRleDsgfSk7XHJcbiAgICAgICAgaWYgKGFsbF9zcGxpY2VzX2FyZV9wb3NpdGl2ZV9hbmRfYmVmb3JlX3ZpZXdfcG9ydCkge1xyXG4gICAgICAgICAgICByZXBlYXQuJGZpcnN0ID0gZmlyc3RJbmRleCArIHRvdGFsQWRkZWRDb3VudCAtIDE7XHJcbiAgICAgICAgICAgIHJlcGVhdC50b3BCdWZmZXJIZWlnaHQgKz0gdG90YWxBZGRlZENvdW50ICogaXRlbUhlaWdodDtcclxuICAgICAgICAgICAgcmVwZWF0LmVuYWJsZVNjcm9sbCgpO1xyXG4gICAgICAgICAgICB2YXIgc2Nyb2xsZXJJbmZvID0gcmVwZWF0LmdldFNjcm9sbGVySW5mbygpO1xyXG4gICAgICAgICAgICB2YXIgc2Nyb2xsZXJfc2Nyb2xsX3RvcCA9IHNjcm9sbGVySW5mby5zY3JvbGxUb3A7XHJcbiAgICAgICAgICAgIHZhciB0b3BfYnVmZmVyX2Rpc3RhbmNlID0gZ2V0RGlzdGFuY2VUb1BhcmVudChyZXBlYXQudG9wQnVmZmVyRWwsIHNjcm9sbGVySW5mby5zY3JvbGxlcik7XHJcbiAgICAgICAgICAgIHZhciByZWFsX3Njcm9sbF90b3AgPSBNYXRoJG1heCgwLCBzY3JvbGxlcl9zY3JvbGxfdG9wID09PSAwXHJcbiAgICAgICAgICAgICAgICA/IDBcclxuICAgICAgICAgICAgICAgIDogKHNjcm9sbGVyX3Njcm9sbF90b3AgLSB0b3BfYnVmZmVyX2Rpc3RhbmNlKSk7XHJcbiAgICAgICAgICAgIHZhciBmaXJzdF9pbmRleF9hZnRlcl9zY3JvbGxfYWRqdXN0bWVudCA9IHJlYWxfc2Nyb2xsX3RvcCA9PT0gMFxyXG4gICAgICAgICAgICAgICAgPyAwXHJcbiAgICAgICAgICAgICAgICA6IE1hdGgkZmxvb3IocmVhbF9zY3JvbGxfdG9wIC8gaXRlbUhlaWdodCk7XHJcbiAgICAgICAgICAgIGlmIChzY3JvbGxlcl9zY3JvbGxfdG9wID4gdG9wX2J1ZmZlcl9kaXN0YW5jZVxyXG4gICAgICAgICAgICAgICAgJiYgZmlyc3RfaW5kZXhfYWZ0ZXJfc2Nyb2xsX2FkanVzdG1lbnQgPT09IGZpcnN0SW5kZXgpIHtcclxuICAgICAgICAgICAgICAgIHJlcGVhdC51cGRhdGVCdWZmZXJFbGVtZW50cyhmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICByZXBlYXQuc2Nyb2xsZXJFbC5zY3JvbGxUb3AgPSByZWFsX3Njcm9sbF90b3AgKyB0b3RhbEFkZGVkQ291bnQgKiBpdGVtSGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcmVtZWFzdXJlKHJlcGVhdCwgaXRlbUhlaWdodCwgbmV3Vmlld0NvdW50LCBuZXdBcnJheVNpemUsIGZpcnN0SW5kZXgpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBsYXN0Vmlld0luZGV4ID0gcmVwZWF0Lmxhc3RWaWV3SW5kZXgoKTtcclxuICAgICAgICB2YXIgYWxsX3NwbGljZXNfYXJlX2FmdGVyX3ZpZXdfcG9ydCA9IGN1cnJWaWV3Q291bnQgPiByZXBlYXQubWluVmlld3NSZXF1aXJlZFxyXG4gICAgICAgICAgICAmJiBzcGxpY2VzLmV2ZXJ5KGZ1bmN0aW9uIChzKSB7IHJldHVybiBzLmluZGV4ID4gbGFzdFZpZXdJbmRleDsgfSk7XHJcbiAgICAgICAgaWYgKGFsbF9zcGxpY2VzX2FyZV9hZnRlcl92aWV3X3BvcnQpIHtcclxuICAgICAgICAgICAgcmVwZWF0LmJvdHRvbUJ1ZmZlckhlaWdodCA9IE1hdGgkbWF4KDAsIG5ld0FycmF5U2l6ZSAtIGZpcnN0SW5kZXggLSBjdXJyVmlld0NvdW50KSAqIGl0ZW1IZWlnaHQ7XHJcbiAgICAgICAgICAgIHJlcGVhdC51cGRhdGVCdWZmZXJFbGVtZW50cyh0cnVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHZhciB2aWV3c1JlcXVpcmVkQ291bnQgPSByZXBlYXQubWluVmlld3NSZXF1aXJlZCAqIDI7XHJcbiAgICAgICAgICAgIGlmICh2aWV3c1JlcXVpcmVkQ291bnQgPT09IDApIHtcclxuICAgICAgICAgICAgICAgIHZhciBzY3JvbGxlckluZm8gPSByZXBlYXQuZ2V0U2Nyb2xsZXJJbmZvKCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgbWluVmlld3NSZXF1aXJlZCA9IGNhbGNNaW5WaWV3c1JlcXVpcmVkKHNjcm9sbGVySW5mby5oZWlnaHQsIGl0ZW1IZWlnaHQpO1xyXG4gICAgICAgICAgICAgICAgcmVwZWF0Lm1pblZpZXdzUmVxdWlyZWQgPSBtaW5WaWV3c1JlcXVpcmVkO1xyXG4gICAgICAgICAgICAgICAgdmlld3NSZXF1aXJlZENvdW50ID0gbWluVmlld3NSZXF1aXJlZCAqIDI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZm9yIChpID0gMDsgc3BsaWNlQ291bnQgPiBpOyArK2kpIHtcclxuICAgICAgICAgICAgICAgIHZhciBfYSA9IHNwbGljZXNbaV0sIGFkZGVkQ291bnQgPSBfYS5hZGRlZENvdW50LCByZW1vdmVkQ291bnQgPSBfYS5yZW1vdmVkLmxlbmd0aCwgc3BsaWNlSW5kZXggPSBfYS5pbmRleDtcclxuICAgICAgICAgICAgICAgIHZhciByZW1vdmVEZWx0YSA9IHJlbW92ZWRDb3VudCAtIGFkZGVkQ291bnQ7XHJcbiAgICAgICAgICAgICAgICBpZiAoZmlyc3RJbmRleEFmdGVyTXV0YXRpb24gPiBzcGxpY2VJbmRleCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZpcnN0SW5kZXhBZnRlck11dGF0aW9uID0gTWF0aCRtYXgoMCwgZmlyc3RJbmRleEFmdGVyTXV0YXRpb24gLSByZW1vdmVEZWx0YSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbmV3Vmlld0NvdW50ID0gMDtcclxuICAgICAgICAgICAgaWYgKG5ld0FycmF5U2l6ZSA8PSByZXBlYXQubWluVmlld3NSZXF1aXJlZCkge1xyXG4gICAgICAgICAgICAgICAgZmlyc3RJbmRleEFmdGVyTXV0YXRpb24gPSAwO1xyXG4gICAgICAgICAgICAgICAgbmV3Vmlld0NvdW50ID0gbmV3QXJyYXlTaXplO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKG5ld0FycmF5U2l6ZSA8PSB2aWV3c1JlcXVpcmVkQ291bnQpIHtcclxuICAgICAgICAgICAgICAgICAgICBuZXdWaWV3Q291bnQgPSBuZXdBcnJheVNpemU7XHJcbiAgICAgICAgICAgICAgICAgICAgZmlyc3RJbmRleEFmdGVyTXV0YXRpb24gPSAwO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbmV3Vmlld0NvdW50ID0gdmlld3NSZXF1aXJlZENvdW50O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBuZXdUb3BCdWZmZXJJdGVtQ291bnQgPSBuZXdBcnJheVNpemUgPj0gZmlyc3RJbmRleEFmdGVyTXV0YXRpb25cclxuICAgICAgICAgICAgICAgID8gZmlyc3RJbmRleEFmdGVyTXV0YXRpb25cclxuICAgICAgICAgICAgICAgIDogMDtcclxuICAgICAgICAgICAgdmFyIHZpZXdDb3VudERlbHRhID0gbmV3Vmlld0NvdW50IC0gY3VyclZpZXdDb3VudDtcclxuICAgICAgICAgICAgaWYgKHZpZXdDb3VudERlbHRhID4gMCkge1xyXG4gICAgICAgICAgICAgICAgZm9yIChpID0gMDsgdmlld0NvdW50RGVsdGEgPiBpOyArK2kpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgY29sbGVjdGlvbkluZGV4ID0gZmlyc3RJbmRleEFmdGVyTXV0YXRpb24gKyBjdXJyVmlld0NvdW50ICsgaTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgb3ZlcnJpZGVDb250ZXh0ID0gY3JlYXRlRnVsbE92ZXJyaWRlQ29udGV4dChyZXBlYXQsIG5ld0FycmF5W2NvbGxlY3Rpb25JbmRleF0sIGNvbGxlY3Rpb25JbmRleCwgbmV3QXJyYXkubGVuZ3RoKTtcclxuICAgICAgICAgICAgICAgICAgICByZXBlYXQuYWRkVmlldyhvdmVycmlkZUNvbnRleHQuYmluZGluZ0NvbnRleHQsIG92ZXJyaWRlQ29udGV4dCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaWkgPSBNYXRoJGFicyh2aWV3Q291bnREZWx0YSk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpaSA+IGk7ICsraSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlcGVhdC5yZW1vdmVWaWV3KG5ld1ZpZXdDb3VudCwgdHJ1ZSwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBuZXdCb3RCdWZmZXJJdGVtQ291bnQgPSBNYXRoJG1heCgwLCBuZXdBcnJheVNpemUgLSBuZXdUb3BCdWZmZXJJdGVtQ291bnQgLSBuZXdWaWV3Q291bnQpO1xyXG4gICAgICAgICAgICByZXBlYXQuJGZpcnN0ID0gZmlyc3RJbmRleEFmdGVyTXV0YXRpb247XHJcbiAgICAgICAgICAgIHJlcGVhdC50b3BCdWZmZXJIZWlnaHQgPSBuZXdUb3BCdWZmZXJJdGVtQ291bnQgKiBpdGVtSGVpZ2h0O1xyXG4gICAgICAgICAgICByZXBlYXQuYm90dG9tQnVmZmVySGVpZ2h0ID0gbmV3Qm90QnVmZmVySXRlbUNvdW50ICogaXRlbUhlaWdodDtcclxuICAgICAgICAgICAgcmVwZWF0LnVwZGF0ZUJ1ZmZlckVsZW1lbnRzKHRydWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9yZW1lYXN1cmUocmVwZWF0LCBpdGVtSGVpZ2h0LCBuZXdWaWV3Q291bnQsIG5ld0FycmF5U2l6ZSwgZmlyc3RJbmRleEFmdGVyTXV0YXRpb24pO1xyXG4gICAgfTtcclxuICAgIEFycmF5VmlydHVhbFJlcGVhdFN0cmF0ZWd5LnByb3RvdHlwZS51cGRhdGVBbGxWaWV3cyA9IGZ1bmN0aW9uIChyZXBlYXQsIHN0YXJ0SW5kZXgpIHtcclxuICAgICAgICB2YXIgdmlld3MgPSByZXBlYXQudmlld1Nsb3QuY2hpbGRyZW47XHJcbiAgICAgICAgdmFyIHZpZXdMZW5ndGggPSB2aWV3cy5sZW5ndGg7XHJcbiAgICAgICAgdmFyIGNvbGxlY3Rpb24gPSByZXBlYXQuaXRlbXM7XHJcbiAgICAgICAgdmFyIGRlbHRhID0gTWF0aCRmbG9vcihyZXBlYXQudG9wQnVmZmVySGVpZ2h0IC8gcmVwZWF0Lml0ZW1IZWlnaHQpO1xyXG4gICAgICAgIHZhciBjb2xsZWN0aW9uSW5kZXggPSAwO1xyXG4gICAgICAgIHZhciB2aWV3O1xyXG4gICAgICAgIGZvciAoOyB2aWV3TGVuZ3RoID4gc3RhcnRJbmRleDsgKytzdGFydEluZGV4KSB7XHJcbiAgICAgICAgICAgIGNvbGxlY3Rpb25JbmRleCA9IHN0YXJ0SW5kZXggKyBkZWx0YTtcclxuICAgICAgICAgICAgdmlldyA9IHJlcGVhdC52aWV3KHN0YXJ0SW5kZXgpO1xyXG4gICAgICAgICAgICByZWJpbmRWaWV3KHJlcGVhdCwgdmlldywgY29sbGVjdGlvbkluZGV4LCBjb2xsZWN0aW9uKTtcclxuICAgICAgICAgICAgcmVwZWF0LnVwZGF0ZUJpbmRpbmdzKHZpZXcpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBBcnJheVZpcnR1YWxSZXBlYXRTdHJhdGVneS5wcm90b3R5cGUucmVtZWFzdXJlID0gZnVuY3Rpb24gKHJlcGVhdCkge1xyXG4gICAgICAgIHRoaXMuX3JlbWVhc3VyZShyZXBlYXQsIHJlcGVhdC5pdGVtSGVpZ2h0LCByZXBlYXQudmlld0NvdW50KCksIHJlcGVhdC5pdGVtcy5sZW5ndGgsIHJlcGVhdC5maXJzdFZpZXdJbmRleCgpKTtcclxuICAgIH07XHJcbiAgICBBcnJheVZpcnR1YWxSZXBlYXRTdHJhdGVneS5wcm90b3R5cGUuX3JlbWVhc3VyZSA9IGZ1bmN0aW9uIChyZXBlYXQsIGl0ZW1IZWlnaHQsIG5ld1ZpZXdDb3VudCwgbmV3QXJyYXlTaXplLCBmaXJzdEluZGV4KSB7XHJcbiAgICAgICAgdmFyIHNjcm9sbGVySW5mbyA9IHJlcGVhdC5nZXRTY3JvbGxlckluZm8oKTtcclxuICAgICAgICB2YXIgc2Nyb2xsZXJfc2Nyb2xsX3RvcCA9IHNjcm9sbGVySW5mby5zY3JvbGxUb3A7XHJcbiAgICAgICAgdmFyIHRvcF9idWZmZXJfZGlzdGFuY2UgPSBnZXREaXN0YW5jZVRvUGFyZW50KHJlcGVhdC50b3BCdWZmZXJFbCwgc2Nyb2xsZXJJbmZvLnNjcm9sbGVyKTtcclxuICAgICAgICB2YXIgcmVhbF9zY3JvbGxfdG9wID0gTWF0aCRtYXgoMCwgc2Nyb2xsZXJfc2Nyb2xsX3RvcCA9PT0gMFxyXG4gICAgICAgICAgICA/IDBcclxuICAgICAgICAgICAgOiAoc2Nyb2xsZXJfc2Nyb2xsX3RvcCAtIHRvcF9idWZmZXJfZGlzdGFuY2UpKTtcclxuICAgICAgICB2YXIgZmlyc3RfaW5kZXhfYWZ0ZXJfc2Nyb2xsX2FkanVzdG1lbnQgPSByZWFsX3Njcm9sbF90b3AgPT09IDBcclxuICAgICAgICAgICAgPyAwXHJcbiAgICAgICAgICAgIDogTWF0aCRmbG9vcihyZWFsX3Njcm9sbF90b3AgLyBpdGVtSGVpZ2h0KTtcclxuICAgICAgICBpZiAoZmlyc3RfaW5kZXhfYWZ0ZXJfc2Nyb2xsX2FkanVzdG1lbnQgKyBuZXdWaWV3Q291bnQgPj0gbmV3QXJyYXlTaXplKSB7XHJcbiAgICAgICAgICAgIGZpcnN0X2luZGV4X2FmdGVyX3Njcm9sbF9hZGp1c3RtZW50ID0gTWF0aCRtYXgoMCwgbmV3QXJyYXlTaXplIC0gbmV3Vmlld0NvdW50KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHRvcF9idWZmZXJfaXRlbV9jb3VudF9hZnRlcl9zY3JvbGxfYWRqdXN0bWVudCA9IGZpcnN0X2luZGV4X2FmdGVyX3Njcm9sbF9hZGp1c3RtZW50O1xyXG4gICAgICAgIHZhciBib3RfYnVmZmVyX2l0ZW1fY291bnRfYWZ0ZXJfc2Nyb2xsX2FkanVzdG1lbnQgPSBNYXRoJG1heCgwLCBuZXdBcnJheVNpemUgLSB0b3BfYnVmZmVyX2l0ZW1fY291bnRfYWZ0ZXJfc2Nyb2xsX2FkanVzdG1lbnQgLSBuZXdWaWV3Q291bnQpO1xyXG4gICAgICAgIHJlcGVhdC4kZmlyc3QgPSBmaXJzdF9pbmRleF9hZnRlcl9zY3JvbGxfYWRqdXN0bWVudDtcclxuICAgICAgICByZXBlYXQudG9wQnVmZmVySGVpZ2h0ID0gdG9wX2J1ZmZlcl9pdGVtX2NvdW50X2FmdGVyX3Njcm9sbF9hZGp1c3RtZW50ICogaXRlbUhlaWdodDtcclxuICAgICAgICByZXBlYXQuYm90dG9tQnVmZmVySGVpZ2h0ID0gYm90X2J1ZmZlcl9pdGVtX2NvdW50X2FmdGVyX3Njcm9sbF9hZGp1c3RtZW50ICogaXRlbUhlaWdodDtcclxuICAgICAgICByZXBlYXQuX2hhbmRsaW5nTXV0YXRpb25zID0gZmFsc2U7XHJcbiAgICAgICAgcmVwZWF0LnJldmVydFNjcm9sbENoZWNrR3VhcmQoKTtcclxuICAgICAgICByZXBlYXQudXBkYXRlQnVmZmVyRWxlbWVudHMoKTtcclxuICAgICAgICB0aGlzLnVwZGF0ZUFsbFZpZXdzKHJlcGVhdCwgMCk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEFycmF5VmlydHVhbFJlcGVhdFN0cmF0ZWd5O1xyXG59KEFycmF5UmVwZWF0U3RyYXRlZ3kpKTtcblxudmFyIE51bGxWaXJ0dWFsUmVwZWF0U3RyYXRlZ3kgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgX19leHRlbmRzKE51bGxWaXJ0dWFsUmVwZWF0U3RyYXRlZ3ksIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBOdWxsVmlydHVhbFJlcGVhdFN0cmF0ZWd5KCkge1xyXG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcclxuICAgIH1cclxuICAgIE51bGxWaXJ0dWFsUmVwZWF0U3RyYXRlZ3kucHJvdG90eXBlLmdldFZpZXdSYW5nZSA9IGZ1bmN0aW9uIChyZXBlYXQsIHNjcm9sbGVySW5mbykge1xyXG4gICAgICAgIHJldHVybiBbMCwgMF07XHJcbiAgICB9O1xyXG4gICAgTnVsbFZpcnR1YWxSZXBlYXRTdHJhdGVneS5wcm90b3R5cGUudXBkYXRlQnVmZmVycyA9IGZ1bmN0aW9uIChyZXBlYXQsIGZpcnN0SW5kZXgpIHsgfTtcclxuICAgIE51bGxWaXJ0dWFsUmVwZWF0U3RyYXRlZ3kucHJvdG90eXBlLm9uQXR0YWNoZWQgPSBmdW5jdGlvbiAoKSB7IH07XHJcbiAgICBOdWxsVmlydHVhbFJlcGVhdFN0cmF0ZWd5LnByb3RvdHlwZS5pc05lYXJUb3AgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfTtcclxuICAgIE51bGxWaXJ0dWFsUmVwZWF0U3RyYXRlZ3kucHJvdG90eXBlLmlzTmVhckJvdHRvbSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9O1xyXG4gICAgTnVsbFZpcnR1YWxSZXBlYXRTdHJhdGVneS5wcm90b3R5cGUuaW5pdENhbGN1bGF0aW9uID0gZnVuY3Rpb24gKHJlcGVhdCwgaXRlbXMpIHtcclxuICAgICAgICByZXBlYXQuaXRlbUhlaWdodFxyXG4gICAgICAgICAgICA9IHJlcGVhdC5taW5WaWV3c1JlcXVpcmVkXHJcbiAgICAgICAgICAgICAgICA9IDA7XHJcbiAgICAgICAgcmV0dXJuIDI7XHJcbiAgICB9O1xyXG4gICAgTnVsbFZpcnR1YWxSZXBlYXRTdHJhdGVneS5wcm90b3R5cGUuY3JlYXRlRmlyc3RSb3cgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9O1xyXG4gICAgTnVsbFZpcnR1YWxSZXBlYXRTdHJhdGVneS5wcm90b3R5cGUuaW5zdGFuY2VNdXRhdGVkID0gZnVuY3Rpb24gKCkgeyB9O1xyXG4gICAgTnVsbFZpcnR1YWxSZXBlYXRTdHJhdGVneS5wcm90b3R5cGUuaW5zdGFuY2VDaGFuZ2VkID0gZnVuY3Rpb24gKHJlcGVhdCkge1xyXG4gICAgICAgIHJlcGVhdC5yZW1vdmVBbGxWaWV3cyh0cnVlLCBmYWxzZSk7XHJcbiAgICAgICAgcmVwZWF0LnJlc2V0Q2FsY3VsYXRpb24oKTtcclxuICAgIH07XHJcbiAgICBOdWxsVmlydHVhbFJlcGVhdFN0cmF0ZWd5LnByb3RvdHlwZS5yZW1lYXN1cmUgPSBmdW5jdGlvbiAocmVwZWF0KSB7IH07XHJcbiAgICBOdWxsVmlydHVhbFJlcGVhdFN0cmF0ZWd5LnByb3RvdHlwZS51cGRhdGVBbGxWaWV3cyA9IGZ1bmN0aW9uICgpIHsgfTtcclxuICAgIHJldHVybiBOdWxsVmlydHVhbFJlcGVhdFN0cmF0ZWd5O1xyXG59KE51bGxSZXBlYXRTdHJhdGVneSkpO1xuXG52YXIgVmlydHVhbFJlcGVhdFN0cmF0ZWd5TG9jYXRvciA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBWaXJ0dWFsUmVwZWF0U3RyYXRlZ3lMb2NhdG9yKCkge1xyXG4gICAgICAgIHRoaXMubWF0Y2hlcnMgPSBbXTtcclxuICAgICAgICB0aGlzLnN0cmF0ZWdpZXMgPSBbXTtcclxuICAgICAgICB0aGlzLmFkZFN0cmF0ZWd5KGZ1bmN0aW9uIChpdGVtcykgeyByZXR1cm4gaXRlbXMgPT09IG51bGwgfHwgaXRlbXMgPT09IHVuZGVmaW5lZDsgfSwgbmV3IE51bGxWaXJ0dWFsUmVwZWF0U3RyYXRlZ3koKSk7XHJcbiAgICAgICAgdGhpcy5hZGRTdHJhdGVneShmdW5jdGlvbiAoaXRlbXMpIHsgcmV0dXJuIGl0ZW1zIGluc3RhbmNlb2YgQXJyYXk7IH0sIG5ldyBBcnJheVZpcnR1YWxSZXBlYXRTdHJhdGVneSgpKTtcclxuICAgIH1cclxuICAgIFZpcnR1YWxSZXBlYXRTdHJhdGVneUxvY2F0b3IucHJvdG90eXBlLmFkZFN0cmF0ZWd5ID0gZnVuY3Rpb24gKG1hdGNoZXIsIHN0cmF0ZWd5KSB7XHJcbiAgICAgICAgdGhpcy5tYXRjaGVycy5wdXNoKG1hdGNoZXIpO1xyXG4gICAgICAgIHRoaXMuc3RyYXRlZ2llcy5wdXNoKHN0cmF0ZWd5KTtcclxuICAgIH07XHJcbiAgICBWaXJ0dWFsUmVwZWF0U3RyYXRlZ3lMb2NhdG9yLnByb3RvdHlwZS5nZXRTdHJhdGVneSA9IGZ1bmN0aW9uIChpdGVtcykge1xyXG4gICAgICAgIHZhciBtYXRjaGVycyA9IHRoaXMubWF0Y2hlcnM7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGlpID0gbWF0Y2hlcnMubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xyXG4gICAgICAgICAgICBpZiAobWF0Y2hlcnNbaV0oaXRlbXMpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zdHJhdGVnaWVzW2ldO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBWaXJ0dWFsUmVwZWF0U3RyYXRlZ3lMb2NhdG9yO1xyXG59KCkpO1xuXG52YXIgRGVmYXVsdFRlbXBsYXRlU3RyYXRlZ3kgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRGVmYXVsdFRlbXBsYXRlU3RyYXRlZ3koKSB7XHJcbiAgICB9XHJcbiAgICBEZWZhdWx0VGVtcGxhdGVTdHJhdGVneS5wcm90b3R5cGUuZ2V0U2Nyb2xsQ29udGFpbmVyID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcclxuICAgICAgICByZXR1cm4gZ2V0U2Nyb2xsZXJFbGVtZW50KGVsZW1lbnQpO1xyXG4gICAgfTtcclxuICAgIERlZmF1bHRUZW1wbGF0ZVN0cmF0ZWd5LnByb3RvdHlwZS5tb3ZlVmlld0ZpcnN0ID0gZnVuY3Rpb24gKHZpZXcsIHRvcEJ1ZmZlcikge1xyXG4gICAgICAgIGluc2VydEJlZm9yZU5vZGUodmlldywgRE9NLm5leHRFbGVtZW50U2libGluZyh0b3BCdWZmZXIpKTtcclxuICAgIH07XHJcbiAgICBEZWZhdWx0VGVtcGxhdGVTdHJhdGVneS5wcm90b3R5cGUubW92ZVZpZXdMYXN0ID0gZnVuY3Rpb24gKHZpZXcsIGJvdHRvbUJ1ZmZlcikge1xyXG4gICAgICAgIHZhciBwcmV2aW91c1NpYmxpbmcgPSBib3R0b21CdWZmZXIucHJldmlvdXNTaWJsaW5nO1xyXG4gICAgICAgIHZhciByZWZlcmVuY2VOb2RlID0gcHJldmlvdXNTaWJsaW5nLm5vZGVUeXBlID09PSA4ICYmIHByZXZpb3VzU2libGluZy5kYXRhID09PSAnYW5jaG9yJyA/IHByZXZpb3VzU2libGluZyA6IGJvdHRvbUJ1ZmZlcjtcclxuICAgICAgICBpbnNlcnRCZWZvcmVOb2RlKHZpZXcsIHJlZmVyZW5jZU5vZGUpO1xyXG4gICAgfTtcclxuICAgIERlZmF1bHRUZW1wbGF0ZVN0cmF0ZWd5LnByb3RvdHlwZS5jcmVhdGVCdWZmZXJzID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcclxuICAgICAgICB2YXIgcGFyZW50ID0gZWxlbWVudC5wYXJlbnROb2RlO1xyXG4gICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgIHBhcmVudC5pbnNlcnRCZWZvcmUoRE9NLmNyZWF0ZUVsZW1lbnQoJ2RpdicpLCBlbGVtZW50KSxcclxuICAgICAgICAgICAgcGFyZW50Lmluc2VydEJlZm9yZShET00uY3JlYXRlRWxlbWVudCgnZGl2JyksIGVsZW1lbnQubmV4dFNpYmxpbmcpXHJcbiAgICAgICAgXTtcclxuICAgIH07XHJcbiAgICBEZWZhdWx0VGVtcGxhdGVTdHJhdGVneS5wcm90b3R5cGUucmVtb3ZlQnVmZmVycyA9IGZ1bmN0aW9uIChlbCwgdG9wQnVmZmVyLCBib3R0b21CdWZmZXIpIHtcclxuICAgICAgICB2YXIgcGFyZW50ID0gZWwucGFyZW50Tm9kZTtcclxuICAgICAgICBwYXJlbnQucmVtb3ZlQ2hpbGQodG9wQnVmZmVyKTtcclxuICAgICAgICBwYXJlbnQucmVtb3ZlQ2hpbGQoYm90dG9tQnVmZmVyKTtcclxuICAgIH07XHJcbiAgICBEZWZhdWx0VGVtcGxhdGVTdHJhdGVneS5wcm90b3R5cGUuZ2V0Rmlyc3RFbGVtZW50ID0gZnVuY3Rpb24gKHRvcEJ1ZmZlciwgYm90dG9tQnVmZmVyKSB7XHJcbiAgICAgICAgdmFyIGZpcnN0RWwgPSB0b3BCdWZmZXIubmV4dEVsZW1lbnRTaWJsaW5nO1xyXG4gICAgICAgIHJldHVybiBmaXJzdEVsID09PSBib3R0b21CdWZmZXIgPyBudWxsIDogZmlyc3RFbDtcclxuICAgIH07XHJcbiAgICBEZWZhdWx0VGVtcGxhdGVTdHJhdGVneS5wcm90b3R5cGUuZ2V0TGFzdEVsZW1lbnQgPSBmdW5jdGlvbiAodG9wQnVmZmVyLCBib3R0b21CdWZmZXIpIHtcclxuICAgICAgICB2YXIgbGFzdEVsID0gYm90dG9tQnVmZmVyLnByZXZpb3VzRWxlbWVudFNpYmxpbmc7XHJcbiAgICAgICAgcmV0dXJuIGxhc3RFbCA9PT0gdG9wQnVmZmVyID8gbnVsbCA6IGxhc3RFbDtcclxuICAgIH07XHJcbiAgICByZXR1cm4gRGVmYXVsdFRlbXBsYXRlU3RyYXRlZ3k7XHJcbn0oKSk7XG5cbnZhciBCYXNlVGFibGVUZW1wbGF0ZVN0cmF0ZWd5ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIF9fZXh0ZW5kcyhCYXNlVGFibGVUZW1wbGF0ZVN0cmF0ZWd5LCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gQmFzZVRhYmxlVGVtcGxhdGVTdHJhdGVneSgpIHtcclxuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XHJcbiAgICB9XHJcbiAgICBCYXNlVGFibGVUZW1wbGF0ZVN0cmF0ZWd5LnByb3RvdHlwZS5nZXRTY3JvbGxDb250YWluZXIgPSBmdW5jdGlvbiAoZWxlbWVudCkge1xyXG4gICAgICAgIHJldHVybiBnZXRTY3JvbGxlckVsZW1lbnQodGhpcy5nZXRUYWJsZShlbGVtZW50KSk7XHJcbiAgICB9O1xyXG4gICAgQmFzZVRhYmxlVGVtcGxhdGVTdHJhdGVneS5wcm90b3R5cGUuY3JlYXRlQnVmZmVycyA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XHJcbiAgICAgICAgdmFyIHBhcmVudCA9IGVsZW1lbnQucGFyZW50Tm9kZTtcclxuICAgICAgICByZXR1cm4gW1xyXG4gICAgICAgICAgICBwYXJlbnQuaW5zZXJ0QmVmb3JlKERPTS5jcmVhdGVFbGVtZW50KCd0cicpLCBlbGVtZW50KSxcclxuICAgICAgICAgICAgcGFyZW50Lmluc2VydEJlZm9yZShET00uY3JlYXRlRWxlbWVudCgndHInKSwgZWxlbWVudC5uZXh0U2libGluZylcclxuICAgICAgICBdO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBCYXNlVGFibGVUZW1wbGF0ZVN0cmF0ZWd5O1xyXG59KERlZmF1bHRUZW1wbGF0ZVN0cmF0ZWd5KSk7XHJcbnZhciBUYWJsZUJvZHlTdHJhdGVneSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICBfX2V4dGVuZHMoVGFibGVCb2R5U3RyYXRlZ3ksIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBUYWJsZUJvZHlTdHJhdGVneSgpIHtcclxuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XHJcbiAgICB9XHJcbiAgICBUYWJsZUJvZHlTdHJhdGVneS5wcm90b3R5cGUuZ2V0VGFibGUgPSBmdW5jdGlvbiAoZWxlbWVudCkge1xyXG4gICAgICAgIHJldHVybiBlbGVtZW50LnBhcmVudE5vZGU7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFRhYmxlQm9keVN0cmF0ZWd5O1xyXG59KEJhc2VUYWJsZVRlbXBsYXRlU3RyYXRlZ3kpKTtcclxudmFyIFRhYmxlUm93U3RyYXRlZ3kgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgX19leHRlbmRzKFRhYmxlUm93U3RyYXRlZ3ksIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBUYWJsZVJvd1N0cmF0ZWd5KCkge1xyXG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcclxuICAgIH1cclxuICAgIFRhYmxlUm93U3RyYXRlZ3kucHJvdG90eXBlLmdldFRhYmxlID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcclxuICAgICAgICByZXR1cm4gZWxlbWVudC5wYXJlbnROb2RlLnBhcmVudE5vZGU7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFRhYmxlUm93U3RyYXRlZ3k7XHJcbn0oQmFzZVRhYmxlVGVtcGxhdGVTdHJhdGVneSkpO1xuXG52YXIgTGlzdFRlbXBsYXRlU3RyYXRlZ3kgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgX19leHRlbmRzKExpc3RUZW1wbGF0ZVN0cmF0ZWd5LCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gTGlzdFRlbXBsYXRlU3RyYXRlZ3koKSB7XHJcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xyXG4gICAgfVxyXG4gICAgTGlzdFRlbXBsYXRlU3RyYXRlZ3kucHJvdG90eXBlLmNyZWF0ZUJ1ZmZlcnMgPSBmdW5jdGlvbiAoZWxlbWVudCkge1xyXG4gICAgICAgIHZhciBwYXJlbnQgPSBlbGVtZW50LnBhcmVudE5vZGU7XHJcbiAgICAgICAgcmV0dXJuIFtcclxuICAgICAgICAgICAgcGFyZW50Lmluc2VydEJlZm9yZShET00uY3JlYXRlRWxlbWVudCgnbGknKSwgZWxlbWVudCksXHJcbiAgICAgICAgICAgIHBhcmVudC5pbnNlcnRCZWZvcmUoRE9NLmNyZWF0ZUVsZW1lbnQoJ2xpJyksIGVsZW1lbnQubmV4dFNpYmxpbmcpXHJcbiAgICAgICAgXTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gTGlzdFRlbXBsYXRlU3RyYXRlZ3k7XHJcbn0oRGVmYXVsdFRlbXBsYXRlU3RyYXRlZ3kpKTtcblxudmFyIFRlbXBsYXRlU3RyYXRlZ3lMb2NhdG9yID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFRlbXBsYXRlU3RyYXRlZ3lMb2NhdG9yKGNvbnRhaW5lcikge1xyXG4gICAgICAgIHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyO1xyXG4gICAgfVxyXG4gICAgVGVtcGxhdGVTdHJhdGVneUxvY2F0b3IucHJvdG90eXBlLmdldFN0cmF0ZWd5ID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcclxuICAgICAgICB2YXIgcGFyZW50ID0gZWxlbWVudC5wYXJlbnROb2RlO1xyXG4gICAgICAgIHZhciBjb250YWluZXIgPSB0aGlzLmNvbnRhaW5lcjtcclxuICAgICAgICBpZiAocGFyZW50ID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBjb250YWluZXIuZ2V0KERlZmF1bHRUZW1wbGF0ZVN0cmF0ZWd5KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHBhcmVudFRhZ05hbWUgPSBwYXJlbnQudGFnTmFtZTtcclxuICAgICAgICBpZiAocGFyZW50VGFnTmFtZSA9PT0gJ1RCT0RZJyB8fCBwYXJlbnRUYWdOYW1lID09PSAnVEhFQUQnIHx8IHBhcmVudFRhZ05hbWUgPT09ICdURk9PVCcpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGNvbnRhaW5lci5nZXQoVGFibGVSb3dTdHJhdGVneSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChwYXJlbnRUYWdOYW1lID09PSAnVEFCTEUnKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBjb250YWluZXIuZ2V0KFRhYmxlQm9keVN0cmF0ZWd5KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHBhcmVudFRhZ05hbWUgPT09ICdPTCcgfHwgcGFyZW50VGFnTmFtZSA9PT0gJ1VMJykge1xyXG4gICAgICAgICAgICByZXR1cm4gY29udGFpbmVyLmdldChMaXN0VGVtcGxhdGVTdHJhdGVneSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBjb250YWluZXIuZ2V0KERlZmF1bHRUZW1wbGF0ZVN0cmF0ZWd5KTtcclxuICAgIH07XHJcbiAgICBUZW1wbGF0ZVN0cmF0ZWd5TG9jYXRvci5pbmplY3QgPSBbQ29udGFpbmVyXTtcclxuICAgIHJldHVybiBUZW1wbGF0ZVN0cmF0ZWd5TG9jYXRvcjtcclxufSgpKTtcblxudmFyIFZpcnR1YWxpemF0aW9uRXZlbnRzID0gT2JqZWN0LmFzc2lnbihPYmplY3QuY3JlYXRlKG51bGwpLCB7XHJcbiAgICBzY3JvbGxlclNpemVDaGFuZ2U6ICd2aXJ0dWFsLXJlcGVhdC1zY3JvbGxlci1zaXplLWNoYW5nZWQnLFxyXG4gICAgaXRlbVNpemVDaGFuZ2U6ICd2aXJ0dWFsLXJlcGVhdC1pdGVtLXNpemUtY2hhbmdlZCdcclxufSk7XG5cbnZhciBnZXRSZXNpemVPYnNlcnZlckNsYXNzID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gUExBVEZPUk0uZ2xvYmFsLlJlc2l6ZU9ic2VydmVyOyB9O1xuXG52YXIgVmlydHVhbFJlcGVhdCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICBfX2V4dGVuZHMoVmlydHVhbFJlcGVhdCwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIFZpcnR1YWxSZXBlYXQoZWxlbWVudCwgdmlld0ZhY3RvcnksIGluc3RydWN0aW9uLCB2aWV3U2xvdCwgdmlld1Jlc291cmNlcywgb2JzZXJ2ZXJMb2NhdG9yLCBjb2xsZWN0aW9uU3RyYXRlZ3lMb2NhdG9yLCB0ZW1wbGF0ZVN0cmF0ZWd5TG9jYXRvcikge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHtcclxuICAgICAgICAgICAgbG9jYWw6ICdpdGVtJyxcclxuICAgICAgICAgICAgdmlld3NSZXF1aXJlTGlmZWN5Y2xlOiB2aWV3c1JlcXVpcmVMaWZlY3ljbGUodmlld0ZhY3RvcnkpXHJcbiAgICAgICAgfSkgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy4kZmlyc3QgPSAwO1xyXG4gICAgICAgIF90aGlzLl9pc0F0dGFjaGVkID0gZmFsc2U7XHJcbiAgICAgICAgX3RoaXMuX3RpY2tpbmcgPSBmYWxzZTtcclxuICAgICAgICBfdGhpcy5fY2FsbGVkR2V0TW9yZSA9IGZhbHNlO1xyXG4gICAgICAgIF90aGlzLl9za2lwTmV4dFNjcm9sbEhhbmRsZSA9IGZhbHNlO1xyXG4gICAgICAgIF90aGlzLl9oYW5kbGluZ011dGF0aW9ucyA9IGZhbHNlO1xyXG4gICAgICAgIF90aGlzLl9sYXN0R2V0TW9yZSA9IDA7XHJcbiAgICAgICAgX3RoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XHJcbiAgICAgICAgX3RoaXMudmlld0ZhY3RvcnkgPSB2aWV3RmFjdG9yeTtcclxuICAgICAgICBfdGhpcy5pbnN0cnVjdGlvbiA9IGluc3RydWN0aW9uO1xyXG4gICAgICAgIF90aGlzLnZpZXdTbG90ID0gdmlld1Nsb3Q7XHJcbiAgICAgICAgX3RoaXMubG9va3VwRnVuY3Rpb25zID0gdmlld1Jlc291cmNlc1snbG9va3VwRnVuY3Rpb25zJ107XHJcbiAgICAgICAgX3RoaXMub2JzZXJ2ZXJMb2NhdG9yID0gb2JzZXJ2ZXJMb2NhdG9yO1xyXG4gICAgICAgIF90aGlzLnRhc2tRdWV1ZSA9IG9ic2VydmVyTG9jYXRvci50YXNrUXVldWU7XHJcbiAgICAgICAgX3RoaXMuc3RyYXRlZ3lMb2NhdG9yID0gY29sbGVjdGlvblN0cmF0ZWd5TG9jYXRvcjtcclxuICAgICAgICBfdGhpcy50ZW1wbGF0ZVN0cmF0ZWd5TG9jYXRvciA9IHRlbXBsYXRlU3RyYXRlZ3lMb2NhdG9yO1xyXG4gICAgICAgIF90aGlzLmVkZ2VEaXN0YW5jZSA9IDU7XHJcbiAgICAgICAgX3RoaXMuc291cmNlRXhwcmVzc2lvbiA9IGdldEl0ZW1zU291cmNlRXhwcmVzc2lvbihfdGhpcy5pbnN0cnVjdGlvbiwgJ3ZpcnR1YWwtcmVwZWF0LmZvcicpO1xyXG4gICAgICAgIF90aGlzLmlzT25lVGltZSA9IGlzT25lVGltZShfdGhpcy5zb3VyY2VFeHByZXNzaW9uKTtcclxuICAgICAgICBfdGhpcy50b3BCdWZmZXJIZWlnaHRcclxuICAgICAgICAgICAgPSBfdGhpcy5ib3R0b21CdWZmZXJIZWlnaHRcclxuICAgICAgICAgICAgICAgID0gX3RoaXMuaXRlbUhlaWdodFxyXG4gICAgICAgICAgICAgICAgICAgID0gX3RoaXMuZGlzdGFuY2VUb1RvcFxyXG4gICAgICAgICAgICAgICAgICAgICAgICA9IDA7XHJcbiAgICAgICAgX3RoaXMucmV2ZXJ0U2Nyb2xsQ2hlY2tHdWFyZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgX3RoaXMuX3RpY2tpbmcgPSBmYWxzZTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIF90aGlzLl9vblNjcm9sbCA9IF90aGlzLl9vblNjcm9sbC5iaW5kKF90aGlzKTtcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICBWaXJ0dWFsUmVwZWF0LmluamVjdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gW1xyXG4gICAgICAgICAgICBET00uRWxlbWVudCxcclxuICAgICAgICAgICAgQm91bmRWaWV3RmFjdG9yeSxcclxuICAgICAgICAgICAgVGFyZ2V0SW5zdHJ1Y3Rpb24sXHJcbiAgICAgICAgICAgIFZpZXdTbG90LFxyXG4gICAgICAgICAgICBWaWV3UmVzb3VyY2VzLFxyXG4gICAgICAgICAgICBPYnNlcnZlckxvY2F0b3IsXHJcbiAgICAgICAgICAgIFZpcnR1YWxSZXBlYXRTdHJhdGVneUxvY2F0b3IsXHJcbiAgICAgICAgICAgIFRlbXBsYXRlU3RyYXRlZ3lMb2NhdG9yXHJcbiAgICAgICAgXTtcclxuICAgIH07XHJcbiAgICBWaXJ0dWFsUmVwZWF0LiRyZXNvdXJjZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICB0eXBlOiAnYXR0cmlidXRlJyxcclxuICAgICAgICAgICAgbmFtZTogJ3ZpcnR1YWwtcmVwZWF0JyxcclxuICAgICAgICAgICAgdGVtcGxhdGVDb250cm9sbGVyOiB0cnVlLFxyXG4gICAgICAgICAgICBiaW5kYWJsZXM6IFsnaXRlbXMnLCAnbG9jYWwnXVxyXG4gICAgICAgIH07XHJcbiAgICB9O1xyXG4gICAgVmlydHVhbFJlcGVhdC5wcm90b3R5cGUuYmluZCA9IGZ1bmN0aW9uIChiaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KSB7XHJcbiAgICAgICAgdGhpcy5zY29wZSA9IHsgYmluZGluZ0NvbnRleHQ6IGJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQ6IG92ZXJyaWRlQ29udGV4dCB9O1xyXG4gICAgfTtcclxuICAgIFZpcnR1YWxSZXBlYXQucHJvdG90eXBlLmF0dGFjaGVkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5faXNBdHRhY2hlZCA9IHRydWU7XHJcbiAgICAgICAgdmFyIGVsZW1lbnQgPSB0aGlzLmVsZW1lbnQ7XHJcbiAgICAgICAgdmFyIHRlbXBsYXRlU3RyYXRlZ3kgPSB0aGlzLnRlbXBsYXRlU3RyYXRlZ3kgPSB0aGlzLnRlbXBsYXRlU3RyYXRlZ3lMb2NhdG9yLmdldFN0cmF0ZWd5KGVsZW1lbnQpO1xyXG4gICAgICAgIHZhciBzY3JvbGxlckVsID0gdGhpcy5zY3JvbGxlckVsID0gdGVtcGxhdGVTdHJhdGVneS5nZXRTY3JvbGxDb250YWluZXIoZWxlbWVudCk7XHJcbiAgICAgICAgdmFyIF9hID0gdGVtcGxhdGVTdHJhdGVneS5jcmVhdGVCdWZmZXJzKGVsZW1lbnQpLCB0b3BCdWZmZXJFbCA9IF9hWzBdLCBib3R0b21CdWZmZXJFbCA9IF9hWzFdO1xyXG4gICAgICAgIHZhciBpc0ZpeGVkSGVpZ2h0Q29udGFpbmVyID0gc2Nyb2xsZXJFbCAhPT0gaHRtbEVsZW1lbnQ7XHJcbiAgICAgICAgdmFyIHNjcm9sbExpc3RlbmVyID0gdGhpcy5fb25TY3JvbGw7XHJcbiAgICAgICAgdGhpcy50b3BCdWZmZXJFbCA9IHRvcEJ1ZmZlckVsO1xyXG4gICAgICAgIHRoaXMuYm90dG9tQnVmZmVyRWwgPSBib3R0b21CdWZmZXJFbDtcclxuICAgICAgICB0aGlzLml0ZW1zQ2hhbmdlZCgpO1xyXG4gICAgICAgIHRoaXMuX2N1cnJTY3JvbGxlckluZm8gPSB0aGlzLmdldFNjcm9sbGVySW5mbygpO1xyXG4gICAgICAgIGlmIChpc0ZpeGVkSGVpZ2h0Q29udGFpbmVyKSB7XHJcbiAgICAgICAgICAgIHNjcm9sbGVyRWwuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgc2Nyb2xsTGlzdGVuZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdmFyIGZpcnN0RWxlbWVudCA9IHRlbXBsYXRlU3RyYXRlZ3kuZ2V0Rmlyc3RFbGVtZW50KHRvcEJ1ZmZlckVsLCBib3R0b21CdWZmZXJFbCk7XHJcbiAgICAgICAgICAgIHRoaXMuZGlzdGFuY2VUb1RvcCA9IGZpcnN0RWxlbWVudCA9PT0gbnVsbCA/IDAgOiBnZXRFbGVtZW50RGlzdGFuY2VUb1RvcE9mRG9jdW1lbnQodG9wQnVmZmVyRWwpO1xyXG4gICAgICAgICAgICBET00uYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgc2Nyb2xsTGlzdGVuZXIsIGZhbHNlKTtcclxuICAgICAgICAgICAgdGhpcy5fY2FsY0Rpc3RhbmNlVG9Ub3BJbnRlcnZhbCA9IFBMQVRGT1JNLmdsb2JhbC5zZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcHJldkRpc3RhbmNlVG9Ub3AgPSBfdGhpcy5kaXN0YW5jZVRvVG9wO1xyXG4gICAgICAgICAgICAgICAgdmFyIGN1cnJEaXN0YW5jZVRvVG9wID0gZ2V0RWxlbWVudERpc3RhbmNlVG9Ub3BPZkRvY3VtZW50KHRvcEJ1ZmZlckVsKTtcclxuICAgICAgICAgICAgICAgIF90aGlzLmRpc3RhbmNlVG9Ub3AgPSBjdXJyRGlzdGFuY2VUb1RvcDtcclxuICAgICAgICAgICAgICAgIGlmIChwcmV2RGlzdGFuY2VUb1RvcCAhPT0gY3VyckRpc3RhbmNlVG9Ub3ApIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgY3VycmVudFNjcm9sbGVySW5mbyA9IF90aGlzLmdldFNjcm9sbGVySW5mbygpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBwcmV2U2Nyb2xsZXJJbmZvID0gX3RoaXMuX2N1cnJTY3JvbGxlckluZm87XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuX2N1cnJTY3JvbGxlckluZm8gPSBjdXJyZW50U2Nyb2xsZXJJbmZvO1xyXG4gICAgICAgICAgICAgICAgICAgIF90aGlzLl9oYW5kbGVTY3JvbGwoY3VycmVudFNjcm9sbGVySW5mbywgcHJldlNjcm9sbGVySW5mbyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIDUwMCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc3RyYXRlZ3kub25BdHRhY2hlZCh0aGlzKTtcclxuICAgIH07XHJcbiAgICBWaXJ0dWFsUmVwZWF0LnByb3RvdHlwZS5jYWxsID0gZnVuY3Rpb24gKGNvbnRleHQsIGNoYW5nZXMpIHtcclxuICAgICAgICB0aGlzW2NvbnRleHRdKHRoaXMuaXRlbXMsIGNoYW5nZXMpO1xyXG4gICAgfTtcclxuICAgIFZpcnR1YWxSZXBlYXQucHJvdG90eXBlLmRldGFjaGVkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBzY3JvbGxDdCA9IHRoaXMuc2Nyb2xsZXJFbDtcclxuICAgICAgICB2YXIgc2Nyb2xsTGlzdGVuZXIgPSB0aGlzLl9vblNjcm9sbDtcclxuICAgICAgICBpZiAoaGFzT3ZlcmZsb3dTY3JvbGwoc2Nyb2xsQ3QpKSB7XHJcbiAgICAgICAgICAgIHNjcm9sbEN0LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHNjcm9sbExpc3RlbmVyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIERPTS5yZW1vdmVFdmVudExpc3RlbmVyKCdzY3JvbGwnLCBzY3JvbGxMaXN0ZW5lciwgZmFsc2UpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnVub2JzZXJ2ZVNjcm9sbGVyKCk7XHJcbiAgICAgICAgdGhpcy5fY3VyclNjcm9sbGVyQ29udGVudFJlY3QgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgdGhpcy5faXNBdHRhY2hlZFxyXG4gICAgICAgICAgICA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX3Vuc3Vic2NyaWJlQ29sbGVjdGlvbigpO1xyXG4gICAgICAgIHRoaXMucmVzZXRDYWxjdWxhdGlvbigpO1xyXG4gICAgICAgIHRoaXMudGVtcGxhdGVTdHJhdGVneS5yZW1vdmVCdWZmZXJzKHRoaXMuZWxlbWVudCwgdGhpcy50b3BCdWZmZXJFbCwgdGhpcy5ib3R0b21CdWZmZXJFbCk7XHJcbiAgICAgICAgdGhpcy50b3BCdWZmZXJFbCA9IHRoaXMuYm90dG9tQnVmZmVyRWwgPSB0aGlzLnNjcm9sbGVyRWwgPSBudWxsO1xyXG4gICAgICAgIHRoaXMucmVtb3ZlQWxsVmlld3ModHJ1ZSwgZmFsc2UpO1xyXG4gICAgICAgIHZhciAkY2xlYXJJbnRlcnZhbCA9IFBMQVRGT1JNLmdsb2JhbC5jbGVhckludGVydmFsO1xyXG4gICAgICAgICRjbGVhckludGVydmFsKHRoaXMuX2NhbGNEaXN0YW5jZVRvVG9wSW50ZXJ2YWwpO1xyXG4gICAgICAgICRjbGVhckludGVydmFsKHRoaXMuX3NpemVJbnRlcnZhbCk7XHJcbiAgICAgICAgdGhpcy5kaXN0YW5jZVRvVG9wXHJcbiAgICAgICAgICAgID0gdGhpcy5fc2l6ZUludGVydmFsXHJcbiAgICAgICAgICAgICAgICA9IHRoaXMuX2NhbGNEaXN0YW5jZVRvVG9wSW50ZXJ2YWwgPSAwO1xyXG4gICAgfTtcclxuICAgIFZpcnR1YWxSZXBlYXQucHJvdG90eXBlLnVuYmluZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aGlzLnNjb3BlID0gbnVsbDtcclxuICAgICAgICB0aGlzLml0ZW1zID0gbnVsbDtcclxuICAgIH07XHJcbiAgICBWaXJ0dWFsUmVwZWF0LnByb3RvdHlwZS5pdGVtc0NoYW5nZWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB0aGlzLl91bnN1YnNjcmliZUNvbGxlY3Rpb24oKTtcclxuICAgICAgICBpZiAoIXRoaXMuc2NvcGUgfHwgIXRoaXMuX2lzQXR0YWNoZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgaXRlbXMgPSB0aGlzLml0ZW1zO1xyXG4gICAgICAgIHZhciBzdHJhdGVneSA9IHRoaXMuc3RyYXRlZ3kgPSB0aGlzLnN0cmF0ZWd5TG9jYXRvci5nZXRTdHJhdGVneShpdGVtcyk7XHJcbiAgICAgICAgaWYgKHN0cmF0ZWd5ID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVmFsdWUgaXMgbm90IGl0ZXJhdGVhYmxlIGZvciB2aXJ0dWFsIHJlcGVhdC4nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCF0aGlzLmlzT25lVGltZSAmJiAhdGhpcy5fb2JzZXJ2ZUlubmVyQ29sbGVjdGlvbigpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX29ic2VydmVDb2xsZWN0aW9uKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBjYWxjdWxhdGlvblNpZ25hbHMgPSBzdHJhdGVneS5pbml0Q2FsY3VsYXRpb24odGhpcywgaXRlbXMpO1xyXG4gICAgICAgIHN0cmF0ZWd5Lmluc3RhbmNlQ2hhbmdlZCh0aGlzLCBpdGVtcywgdGhpcy4kZmlyc3QpO1xyXG4gICAgICAgIGlmIChjYWxjdWxhdGlvblNpZ25hbHMgJiAxKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVzZXRDYWxjdWxhdGlvbigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoKGNhbGN1bGF0aW9uU2lnbmFscyAmIDIpID09PSAwKSB7XHJcbiAgICAgICAgICAgIHZhciBfYSA9IFBMQVRGT1JNLmdsb2JhbCwgJHNldEludGVydmFsID0gX2Euc2V0SW50ZXJ2YWwsICRjbGVhckludGVydmFsXzEgPSBfYS5jbGVhckludGVydmFsO1xyXG4gICAgICAgICAgICAkY2xlYXJJbnRlcnZhbF8xKHRoaXMuX3NpemVJbnRlcnZhbCk7XHJcbiAgICAgICAgICAgIHRoaXMuX3NpemVJbnRlcnZhbCA9ICRzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMuaXRlbXMpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZmlyc3RWaWV3ID0gX3RoaXMuZmlyc3RWaWV3KCkgfHwgX3RoaXMuc3RyYXRlZ3kuY3JlYXRlRmlyc3RSb3coX3RoaXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXdDYWxjU2l6ZSA9IGNhbGNPdXRlckhlaWdodChmaXJzdFZpZXcuZmlyc3RDaGlsZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5ld0NhbGNTaXplID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkY2xlYXJJbnRlcnZhbF8xKF90aGlzLl9zaXplSW50ZXJ2YWwpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5pdGVtc0NoYW5nZWQoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAkY2xlYXJJbnRlcnZhbF8xKF90aGlzLl9zaXplSW50ZXJ2YWwpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCA1MDApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoY2FsY3VsYXRpb25TaWduYWxzICYgNCkge1xyXG4gICAgICAgICAgICB0aGlzLm9ic2VydmVTY3JvbGxlcih0aGlzLnNjcm9sbGVyRWwpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBWaXJ0dWFsUmVwZWF0LnByb3RvdHlwZS5oYW5kbGVDb2xsZWN0aW9uTXV0YXRlZCA9IGZ1bmN0aW9uIChjb2xsZWN0aW9uLCBjaGFuZ2VzKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2lnbm9yZU11dGF0aW9uKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5faGFuZGxpbmdNdXRhdGlvbnMgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuc3RyYXRlZ3kuaW5zdGFuY2VNdXRhdGVkKHRoaXMsIGNvbGxlY3Rpb24sIGNoYW5nZXMpO1xyXG4gICAgfTtcclxuICAgIFZpcnR1YWxSZXBlYXQucHJvdG90eXBlLmhhbmRsZUlubmVyQ29sbGVjdGlvbk11dGF0ZWQgPSBmdW5jdGlvbiAoY29sbGVjdGlvbiwgY2hhbmdlcykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgaWYgKHRoaXMuX2lnbm9yZU11dGF0aW9uKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5faWdub3JlTXV0YXRpb24gPSB0cnVlO1xyXG4gICAgICAgIHZhciBuZXdJdGVtcyA9IHRoaXMuc291cmNlRXhwcmVzc2lvbi5ldmFsdWF0ZSh0aGlzLnNjb3BlLCB0aGlzLmxvb2t1cEZ1bmN0aW9ucyk7XHJcbiAgICAgICAgdGhpcy50YXNrUXVldWUucXVldWVNaWNyb1Rhc2soZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuX2lnbm9yZU11dGF0aW9uID0gZmFsc2U7IH0pO1xyXG4gICAgICAgIGlmIChuZXdJdGVtcyA9PT0gdGhpcy5pdGVtcykge1xyXG4gICAgICAgICAgICB0aGlzLml0ZW1zQ2hhbmdlZCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5pdGVtcyA9IG5ld0l0ZW1zO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBWaXJ0dWFsUmVwZWF0LnByb3RvdHlwZS5lbmFibGVTY3JvbGwgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5fdGlja2luZyA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX2hhbmRsaW5nTXV0YXRpb25zID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5fc2tpcE5leHRTY3JvbGxIYW5kbGUgPSBmYWxzZTtcclxuICAgIH07XHJcbiAgICBWaXJ0dWFsUmVwZWF0LnByb3RvdHlwZS5nZXRTY3JvbGxlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zY3JvbGxlckVsO1xyXG4gICAgfTtcclxuICAgIFZpcnR1YWxSZXBlYXQucHJvdG90eXBlLmdldFNjcm9sbGVySW5mbyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgc2Nyb2xsZXIgPSB0aGlzLnNjcm9sbGVyRWw7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgc2Nyb2xsZXI6IHNjcm9sbGVyLFxyXG4gICAgICAgICAgICBzY3JvbGxUb3A6IHNjcm9sbGVyLnNjcm9sbFRvcCxcclxuICAgICAgICAgICAgaGVpZ2h0OiBzY3JvbGxlciA9PT0gaHRtbEVsZW1lbnRcclxuICAgICAgICAgICAgICAgID8gaW5uZXJIZWlnaHRcclxuICAgICAgICAgICAgICAgIDogY2FsY1Njcm9sbEhlaWdodChzY3JvbGxlcilcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuICAgIFZpcnR1YWxSZXBlYXQucHJvdG90eXBlLnJlc2V0Q2FsY3VsYXRpb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy4kZmlyc3RcclxuICAgICAgICAgICAgPSB0aGlzLnRvcEJ1ZmZlckhlaWdodFxyXG4gICAgICAgICAgICAgICAgPSB0aGlzLmJvdHRvbUJ1ZmZlckhlaWdodFxyXG4gICAgICAgICAgICAgICAgICAgID0gdGhpcy5pdGVtSGVpZ2h0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgID0gdGhpcy5taW5WaWV3c1JlcXVpcmVkID0gMDtcclxuICAgICAgICB0aGlzLl9pZ25vcmVNdXRhdGlvblxyXG4gICAgICAgICAgICA9IHRoaXMuX2hhbmRsaW5nTXV0YXRpb25zXHJcbiAgICAgICAgICAgICAgICA9IHRoaXMuX3RpY2tpbmcgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLnVwZGF0ZUJ1ZmZlckVsZW1lbnRzKHRydWUpO1xyXG4gICAgfTtcclxuICAgIFZpcnR1YWxSZXBlYXQucHJvdG90eXBlLl9vblNjcm9sbCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBpc0hhbmRsaW5nTXV0YXRpb25zID0gdGhpcy5faGFuZGxpbmdNdXRhdGlvbnM7XHJcbiAgICAgICAgaWYgKCF0aGlzLl90aWNraW5nICYmICFpc0hhbmRsaW5nTXV0YXRpb25zKSB7XHJcbiAgICAgICAgICAgIHZhciBwcmV2U2Nyb2xsZXJJbmZvXzEgPSB0aGlzLl9jdXJyU2Nyb2xsZXJJbmZvO1xyXG4gICAgICAgICAgICB2YXIgY3VycmVudFNjcm9sbGVySW5mb18xID0gdGhpcy5nZXRTY3JvbGxlckluZm8oKTtcclxuICAgICAgICAgICAgdGhpcy5fY3VyclNjcm9sbGVySW5mbyA9IGN1cnJlbnRTY3JvbGxlckluZm9fMTtcclxuICAgICAgICAgICAgdGhpcy50YXNrUXVldWUucXVldWVNaWNyb1Rhc2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgX3RoaXMuX3RpY2tpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIF90aGlzLl9oYW5kbGVTY3JvbGwoY3VycmVudFNjcm9sbGVySW5mb18xLCBwcmV2U2Nyb2xsZXJJbmZvXzEpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy5fdGlja2luZyA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChpc0hhbmRsaW5nTXV0YXRpb25zKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsaW5nTXV0YXRpb25zID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFZpcnR1YWxSZXBlYXQucHJvdG90eXBlLl9oYW5kbGVTY3JvbGwgPSBmdW5jdGlvbiAoY3VycmVudFNjcm9sbGVySW5mbywgcHJldlNjcm9sbGVySW5mbykge1xyXG4gICAgICAgIGlmICghdGhpcy5faXNBdHRhY2hlZCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLl9za2lwTmV4dFNjcm9sbEhhbmRsZSkge1xyXG4gICAgICAgICAgICB0aGlzLl9za2lwTmV4dFNjcm9sbEhhbmRsZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBpdGVtcyA9IHRoaXMuaXRlbXM7XHJcbiAgICAgICAgaWYgKCFpdGVtcykge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBzdHJhdGVneSA9IHRoaXMuc3RyYXRlZ3k7XHJcbiAgICAgICAgdmFyIG9sZF9yYW5nZV9zdGFydF9pbmRleCA9IHRoaXMuJGZpcnN0O1xyXG4gICAgICAgIHZhciBvbGRfcmFuZ2VfZW5kX2luZGV4ID0gdGhpcy5sYXN0Vmlld0luZGV4KCk7XHJcbiAgICAgICAgdmFyIF9hID0gc3RyYXRlZ3kuZ2V0Vmlld1JhbmdlKHRoaXMsIGN1cnJlbnRTY3JvbGxlckluZm8pLCBuZXdfcmFuZ2Vfc3RhcnRfaW5kZXggPSBfYVswXSwgbmV3X3JhbmdlX2VuZF9pbmRleCA9IF9hWzFdO1xyXG4gICAgICAgIHZhciBzY3JvbGxpbmdfc3RhdGUgPSBuZXdfcmFuZ2Vfc3RhcnRfaW5kZXggPiBvbGRfcmFuZ2Vfc3RhcnRfaW5kZXhcclxuICAgICAgICAgICAgPyAxXHJcbiAgICAgICAgICAgIDogbmV3X3JhbmdlX3N0YXJ0X2luZGV4IDwgb2xkX3JhbmdlX3N0YXJ0X2luZGV4XHJcbiAgICAgICAgICAgICAgICA/IDJcclxuICAgICAgICAgICAgICAgIDogMDtcclxuICAgICAgICB2YXIgZGlkTW92ZWRWaWV3cyA9IDA7XHJcbiAgICAgICAgaWYgKG5ld19yYW5nZV9zdGFydF9pbmRleCA+PSBvbGRfcmFuZ2Vfc3RhcnRfaW5kZXggJiYgb2xkX3JhbmdlX2VuZF9pbmRleCA9PT0gbmV3X3JhbmdlX2VuZF9pbmRleFxyXG4gICAgICAgICAgICB8fCBuZXdfcmFuZ2VfZW5kX2luZGV4ID09PSBvbGRfcmFuZ2VfZW5kX2luZGV4ICYmIG9sZF9yYW5nZV9lbmRfaW5kZXggPj0gbmV3X3JhbmdlX2VuZF9pbmRleCkge1xyXG4gICAgICAgICAgICBpZiAobmV3X3JhbmdlX3N0YXJ0X2luZGV4ID49IG9sZF9yYW5nZV9zdGFydF9pbmRleCAmJiBvbGRfcmFuZ2VfZW5kX2luZGV4ID09PSBuZXdfcmFuZ2VfZW5kX2luZGV4KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoc3RyYXRlZ3kuaXNOZWFyQm90dG9tKHRoaXMsIG5ld19yYW5nZV9lbmRfaW5kZXgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2Nyb2xsaW5nX3N0YXRlIHw9IDg7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoc3RyYXRlZ3kuaXNOZWFyVG9wKHRoaXMsIG5ld19yYW5nZV9zdGFydF9pbmRleCkpIHtcclxuICAgICAgICAgICAgICAgIHNjcm9sbGluZ19zdGF0ZSB8PSA0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAobmV3X3JhbmdlX3N0YXJ0X2luZGV4ID4gb2xkX3JhbmdlX3N0YXJ0X2luZGV4ICYmIG9sZF9yYW5nZV9lbmRfaW5kZXggPj0gbmV3X3JhbmdlX3N0YXJ0X2luZGV4ICYmIG5ld19yYW5nZV9lbmRfaW5kZXggPj0gb2xkX3JhbmdlX2VuZF9pbmRleCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHZpZXdzX3RvX21vdmVfY291bnQgPSBuZXdfcmFuZ2Vfc3RhcnRfaW5kZXggLSBvbGRfcmFuZ2Vfc3RhcnRfaW5kZXg7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9tb3ZlVmlld3Modmlld3NfdG9fbW92ZV9jb3VudCwgMSk7XHJcbiAgICAgICAgICAgICAgICBkaWRNb3ZlZFZpZXdzID0gMTtcclxuICAgICAgICAgICAgICAgIGlmIChzdHJhdGVneS5pc05lYXJCb3R0b20odGhpcywgbmV3X3JhbmdlX2VuZF9pbmRleCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBzY3JvbGxpbmdfc3RhdGUgfD0gODtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChvbGRfcmFuZ2Vfc3RhcnRfaW5kZXggPiBuZXdfcmFuZ2Vfc3RhcnRfaW5kZXggJiYgb2xkX3JhbmdlX3N0YXJ0X2luZGV4IDw9IG5ld19yYW5nZV9lbmRfaW5kZXggJiYgb2xkX3JhbmdlX2VuZF9pbmRleCA+PSBuZXdfcmFuZ2VfZW5kX2luZGV4KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdmlld3NfdG9fbW92ZV9jb3VudCA9IG9sZF9yYW5nZV9lbmRfaW5kZXggLSBuZXdfcmFuZ2VfZW5kX2luZGV4O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fbW92ZVZpZXdzKHZpZXdzX3RvX21vdmVfY291bnQsIC0xKTtcclxuICAgICAgICAgICAgICAgIGRpZE1vdmVkVmlld3MgPSAxO1xyXG4gICAgICAgICAgICAgICAgaWYgKHN0cmF0ZWd5LmlzTmVhclRvcCh0aGlzLCBuZXdfcmFuZ2Vfc3RhcnRfaW5kZXgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2Nyb2xsaW5nX3N0YXRlIHw9IDQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAob2xkX3JhbmdlX2VuZF9pbmRleCA8IG5ld19yYW5nZV9zdGFydF9pbmRleCB8fCBvbGRfcmFuZ2Vfc3RhcnRfaW5kZXggPiBuZXdfcmFuZ2VfZW5kX2luZGV4KSB7XHJcbiAgICAgICAgICAgICAgICBzdHJhdGVneS5yZW1lYXN1cmUodGhpcyk7XHJcbiAgICAgICAgICAgICAgICBpZiAob2xkX3JhbmdlX2VuZF9pbmRleCA8IG5ld19yYW5nZV9zdGFydF9pbmRleCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzdHJhdGVneS5pc05lYXJCb3R0b20odGhpcywgbmV3X3JhbmdlX2VuZF9pbmRleCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2Nyb2xsaW5nX3N0YXRlIHw9IDg7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoc3RyYXRlZ3kuaXNOZWFyVG9wKHRoaXMsIG5ld19yYW5nZV9zdGFydF9pbmRleCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBzY3JvbGxpbmdfc3RhdGUgfD0gNDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybignU2Nyb2xsIGludGVyc2VjdGlvbiBub3QgaGFuZGxlZCcpO1xyXG4gICAgICAgICAgICAgICAgc3RyYXRlZ3kucmVtZWFzdXJlKHRoaXMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChkaWRNb3ZlZFZpZXdzID09PSAxKSB7XHJcbiAgICAgICAgICAgIHRoaXMuJGZpcnN0ID0gbmV3X3JhbmdlX3N0YXJ0X2luZGV4O1xyXG4gICAgICAgICAgICBzdHJhdGVneS51cGRhdGVCdWZmZXJzKHRoaXMsIG5ld19yYW5nZV9zdGFydF9pbmRleCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICgoc2Nyb2xsaW5nX3N0YXRlICYgKDEgfCA4KSkgPT09ICgxIHwgOClcclxuICAgICAgICAgICAgfHwgKHNjcm9sbGluZ19zdGF0ZSAmICgyIHwgNCkpID09PSAoMiB8IDQpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZ2V0TW9yZShuZXdfcmFuZ2Vfc3RhcnRfaW5kZXgsIChzY3JvbGxpbmdfc3RhdGUgJiA0KSA+IDAsIChzY3JvbGxpbmdfc3RhdGUgJiA4KSA+IDApO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBWaXJ0dWFsUmVwZWF0LnByb3RvdHlwZS5fbW92ZVZpZXdzID0gZnVuY3Rpb24gKHZpZXdzQ291bnQsIGRpcmVjdGlvbikge1xyXG4gICAgICAgIHZhciByZXBlYXQgPSB0aGlzO1xyXG4gICAgICAgIGlmIChkaXJlY3Rpb24gPT09IC0xKSB7XHJcbiAgICAgICAgICAgIHZhciBzdGFydEluZGV4ID0gcmVwZWF0LmZpcnN0Vmlld0luZGV4KCk7XHJcbiAgICAgICAgICAgIHdoaWxlICh2aWV3c0NvdW50LS0pIHtcclxuICAgICAgICAgICAgICAgIHZhciB2aWV3ID0gcmVwZWF0Lmxhc3RWaWV3KCk7XHJcbiAgICAgICAgICAgICAgICByZWJpbmRBbmRNb3ZlVmlldyhyZXBlYXQsIHZpZXcsIC0tc3RhcnRJbmRleCwgZmFsc2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB2YXIgbGFzdEluZGV4ID0gcmVwZWF0Lmxhc3RWaWV3SW5kZXgoKTtcclxuICAgICAgICAgICAgd2hpbGUgKHZpZXdzQ291bnQtLSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHZpZXcgPSByZXBlYXQudmlldygwKTtcclxuICAgICAgICAgICAgICAgIHJlYmluZEFuZE1vdmVWaWV3KHJlcGVhdCwgdmlldywgKytsYXN0SW5kZXgsIHRydWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFZpcnR1YWxSZXBlYXQucHJvdG90eXBlLmdldE1vcmUgPSBmdW5jdGlvbiAodG9wSW5kZXgsIGlzTmVhclRvcCwgaXNOZWFyQm90dG9tLCBmb3JjZSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgaWYgKGlzTmVhclRvcCB8fCBpc05lYXJCb3R0b20gfHwgZm9yY2UpIHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLl9jYWxsZWRHZXRNb3JlKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZXhlY3V0ZUdldE1vcmUgPSBmdW5jdGlvbiAodGltZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aW1lIC0gX3RoaXMuX2xhc3RHZXRNb3JlIDwgMTYpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5fbGFzdEdldE1vcmUgPSB0aW1lO1xyXG4gICAgICAgICAgICAgICAgICAgIF90aGlzLl9jYWxsZWRHZXRNb3JlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcmV2ZXJ0Q2FsbGVkR2V0TW9yZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuX2NhbGxlZEdldE1vcmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBmaXJzdFZpZXcgPSBfdGhpcy5maXJzdFZpZXcoKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZmlyc3RWaWV3ID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldmVydENhbGxlZEdldE1vcmUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB2YXIgZmlyc3RWaWV3RWxlbWVudCA9IGZpcnN0Vmlldy5maXJzdENoaWxkO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBzY3JvbGxOZXh0QXR0ck5hbWUgPSAnaW5maW5pdGUtc2Nyb2xsLW5leHQnO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBmdW5jID0gZmlyc3RWaWV3RWxlbWVudFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAmJiBmaXJzdFZpZXdFbGVtZW50LmF1XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICYmIGZpcnN0Vmlld0VsZW1lbnQuYXVbc2Nyb2xsTmV4dEF0dHJOYW1lXVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA/IGZpcnN0Vmlld0VsZW1lbnQuYXVbc2Nyb2xsTmV4dEF0dHJOYW1lXS5pbnN0cnVjdGlvbi5hdHRyaWJ1dGVzW3Njcm9sbE5leHRBdHRyTmFtZV1cclxuICAgICAgICAgICAgICAgICAgICAgICAgOiB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZ1bmMgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXZlcnRDYWxsZWRHZXRNb3JlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2Nyb2xsQ29udGV4dCA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvcEluZGV4OiB0b3BJbmRleCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzQXRCb3R0b206IGlzTmVhckJvdHRvbSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzQXRUb3A6IGlzTmVhclRvcFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgb3ZlcnJpZGVDb250ZXh0ID0gX3RoaXMuc2NvcGUub3ZlcnJpZGVDb250ZXh0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvdmVycmlkZUNvbnRleHQuJHNjcm9sbENvbnRleHQgPSBzY3JvbGxDb250ZXh0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGZ1bmMgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYmluZGluZ0NvbnRleHQgPSBvdmVycmlkZUNvbnRleHQuYmluZGluZ0NvbnRleHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ2V0TW9yZUZ1bmNOYW1lID0gZmlyc3RWaWV3LmZpcnN0Q2hpbGQuZ2V0QXR0cmlidXRlKHNjcm9sbE5leHRBdHRyTmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZnVuY0NhbGwgPSBiaW5kaW5nQ29udGV4dFtnZXRNb3JlRnVuY05hbWVdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBmdW5jQ2FsbCA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldmVydENhbGxlZEdldE1vcmUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gZnVuY0NhbGwuY2FsbChiaW5kaW5nQ29udGV4dCwgdG9wSW5kZXgsIGlzTmVhckJvdHRvbSwgaXNOZWFyVG9wKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0IGluc3RhbmNlb2YgUHJvbWlzZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5fY2FsbGVkR2V0TW9yZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXZlcnRDYWxsZWRHZXRNb3JlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIidcIiArIHNjcm9sbE5leHRBdHRyTmFtZSArIFwiJyBtdXN0IGJlIGEgZnVuY3Rpb24gb3IgZXZhbHVhdGUgdG8gb25lXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGZ1bmMuc291cmNlRXhwcmVzc2lvbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV2ZXJ0Q2FsbGVkR2V0TW9yZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmMuc291cmNlRXhwcmVzc2lvbi5ldmFsdWF0ZShfdGhpcy5zY29wZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCInXCIgKyBzY3JvbGxOZXh0QXR0ck5hbWUgKyBcIicgbXVzdCBiZSBhIGZ1bmN0aW9uIG9yIGV2YWx1YXRlIHRvIG9uZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAkcmFmKGV4ZWN1dGVHZXRNb3JlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBWaXJ0dWFsUmVwZWF0LnByb3RvdHlwZS51cGRhdGVCdWZmZXJFbGVtZW50cyA9IGZ1bmN0aW9uIChza2lwVXBkYXRlKSB7XHJcbiAgICAgICAgdGhpcy50b3BCdWZmZXJFbC5zdHlsZS5oZWlnaHQgPSB0aGlzLnRvcEJ1ZmZlckhlaWdodCArIFwicHhcIjtcclxuICAgICAgICB0aGlzLmJvdHRvbUJ1ZmZlckVsLnN0eWxlLmhlaWdodCA9IHRoaXMuYm90dG9tQnVmZmVySGVpZ2h0ICsgXCJweFwiO1xyXG4gICAgICAgIGlmIChza2lwVXBkYXRlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3RpY2tpbmcgPSB0cnVlO1xyXG4gICAgICAgICAgICAkcmFmKHRoaXMucmV2ZXJ0U2Nyb2xsQ2hlY2tHdWFyZCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFZpcnR1YWxSZXBlYXQucHJvdG90eXBlLl91bnN1YnNjcmliZUNvbGxlY3Rpb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGNvbGxlY3Rpb25PYnNlcnZlciA9IHRoaXMuY29sbGVjdGlvbk9ic2VydmVyO1xyXG4gICAgICAgIGlmIChjb2xsZWN0aW9uT2JzZXJ2ZXIpIHtcclxuICAgICAgICAgICAgY29sbGVjdGlvbk9ic2VydmVyLnVuc3Vic2NyaWJlKHRoaXMuY2FsbENvbnRleHQsIHRoaXMpO1xyXG4gICAgICAgICAgICB0aGlzLmNvbGxlY3Rpb25PYnNlcnZlciA9IHRoaXMuY2FsbENvbnRleHQgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBWaXJ0dWFsUmVwZWF0LnByb3RvdHlwZS5maXJzdFZpZXcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMudmlldygwKTtcclxuICAgIH07XHJcbiAgICBWaXJ0dWFsUmVwZWF0LnByb3RvdHlwZS5sYXN0VmlldyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy52aWV3KHRoaXMudmlld0NvdW50KCkgLSAxKTtcclxuICAgIH07XHJcbiAgICBWaXJ0dWFsUmVwZWF0LnByb3RvdHlwZS5maXJzdFZpZXdJbmRleCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgZmlyc3RWaWV3ID0gdGhpcy5maXJzdFZpZXcoKTtcclxuICAgICAgICByZXR1cm4gZmlyc3RWaWV3ID09PSBudWxsID8gLTEgOiBmaXJzdFZpZXcub3ZlcnJpZGVDb250ZXh0LiRpbmRleDtcclxuICAgIH07XHJcbiAgICBWaXJ0dWFsUmVwZWF0LnByb3RvdHlwZS5sYXN0Vmlld0luZGV4ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBsYXN0VmlldyA9IHRoaXMubGFzdFZpZXcoKTtcclxuICAgICAgICByZXR1cm4gbGFzdFZpZXcgPT09IG51bGwgPyAtMSA6IGxhc3RWaWV3Lm92ZXJyaWRlQ29udGV4dC4kaW5kZXg7XHJcbiAgICB9O1xyXG4gICAgVmlydHVhbFJlcGVhdC5wcm90b3R5cGUub2JzZXJ2ZVNjcm9sbGVyID0gZnVuY3Rpb24gKHNjcm9sbGVyRWwpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciBzaXplQ2hhbmdlSGFuZGxlciA9IGZ1bmN0aW9uIChuZXdSZWN0KSB7XHJcbiAgICAgICAgICAgICRyYWYoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKG5ld1JlY3QgPT09IF90aGlzLl9jdXJyU2Nyb2xsZXJDb250ZW50UmVjdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIF90aGlzLml0ZW1zQ2hhbmdlZCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBSZXNpemVPYnNlcnZlckNvbnN0cnVjdG9yID0gZ2V0UmVzaXplT2JzZXJ2ZXJDbGFzcygpO1xyXG4gICAgICAgIGlmICh0eXBlb2YgUmVzaXplT2JzZXJ2ZXJDb25zdHJ1Y3RvciA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICB2YXIgb2JzZXJ2ZXIgPSB0aGlzLl9zY3JvbGxlclJlc2l6ZU9ic2VydmVyO1xyXG4gICAgICAgICAgICBpZiAob2JzZXJ2ZXIpIHtcclxuICAgICAgICAgICAgICAgIG9ic2VydmVyLmRpc2Nvbm5lY3QoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBvYnNlcnZlciA9IHRoaXMuX3Njcm9sbGVyUmVzaXplT2JzZXJ2ZXIgPSBuZXcgUmVzaXplT2JzZXJ2ZXJDb25zdHJ1Y3RvcihmdW5jdGlvbiAoZW50cmllcykge1xyXG4gICAgICAgICAgICAgICAgdmFyIG9sZFJlY3QgPSBfdGhpcy5fY3VyclNjcm9sbGVyQ29udGVudFJlY3Q7XHJcbiAgICAgICAgICAgICAgICB2YXIgbmV3UmVjdCA9IGVudHJpZXNbMF0uY29udGVudFJlY3Q7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5fY3VyclNjcm9sbGVyQ29udGVudFJlY3QgPSBuZXdSZWN0O1xyXG4gICAgICAgICAgICAgICAgaWYgKG9sZFJlY3QgPT09IHVuZGVmaW5lZCB8fCBuZXdSZWN0LmhlaWdodCAhPT0gb2xkUmVjdC5oZWlnaHQgfHwgbmV3UmVjdC53aWR0aCAhPT0gb2xkUmVjdC53aWR0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNpemVDaGFuZ2VIYW5kbGVyKG5ld1JlY3QpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgb2JzZXJ2ZXIub2JzZXJ2ZShzY3JvbGxlckVsKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGVsRXZlbnRzID0gdGhpcy5fc2Nyb2xsZXJFdmVudHM7XHJcbiAgICAgICAgaWYgKGVsRXZlbnRzKSB7XHJcbiAgICAgICAgICAgIGVsRXZlbnRzLmRpc3Bvc2VBbGwoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHNpemVDaGFuZ2VFdmVudHNIYW5kbGVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkcmFmKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLml0ZW1zQ2hhbmdlZCgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIGVsRXZlbnRzID0gdGhpcy5fc2Nyb2xsZXJFdmVudHMgPSBuZXcgRWxlbWVudEV2ZW50cyhzY3JvbGxlckVsKTtcclxuICAgICAgICBlbEV2ZW50cy5zdWJzY3JpYmUoVmlydHVhbGl6YXRpb25FdmVudHMuc2Nyb2xsZXJTaXplQ2hhbmdlLCBzaXplQ2hhbmdlRXZlbnRzSGFuZGxlciwgZmFsc2UpO1xyXG4gICAgICAgIGVsRXZlbnRzLnN1YnNjcmliZShWaXJ0dWFsaXphdGlvbkV2ZW50cy5pdGVtU2l6ZUNoYW5nZSwgc2l6ZUNoYW5nZUV2ZW50c0hhbmRsZXIsIGZhbHNlKTtcclxuICAgIH07XHJcbiAgICBWaXJ0dWFsUmVwZWF0LnByb3RvdHlwZS51bm9ic2VydmVTY3JvbGxlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgb2JzZXJ2ZXIgPSB0aGlzLl9zY3JvbGxlclJlc2l6ZU9ic2VydmVyO1xyXG4gICAgICAgIGlmIChvYnNlcnZlcikge1xyXG4gICAgICAgICAgICBvYnNlcnZlci5kaXNjb25uZWN0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBzY3JvbGxlckV2ZW50cyA9IHRoaXMuX3Njcm9sbGVyRXZlbnRzO1xyXG4gICAgICAgIGlmIChzY3JvbGxlckV2ZW50cykge1xyXG4gICAgICAgICAgICBzY3JvbGxlckV2ZW50cy5kaXNwb3NlQWxsKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX3Njcm9sbGVyUmVzaXplT2JzZXJ2ZXJcclxuICAgICAgICAgICAgPSB0aGlzLl9zY3JvbGxlckV2ZW50cyA9IHVuZGVmaW5lZDtcclxuICAgIH07XHJcbiAgICBWaXJ0dWFsUmVwZWF0LnByb3RvdHlwZS5fb2JzZXJ2ZUlubmVyQ29sbGVjdGlvbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgaXRlbXMgPSB0aGlzLl9nZXRJbm5lckNvbGxlY3Rpb24oKTtcclxuICAgICAgICB2YXIgc3RyYXRlZ3kgPSB0aGlzLnN0cmF0ZWd5TG9jYXRvci5nZXRTdHJhdGVneShpdGVtcyk7XHJcbiAgICAgICAgaWYgKCFzdHJhdGVneSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBjb2xsZWN0aW9uT2JzZXJ2ZXIgPSBzdHJhdGVneS5nZXRDb2xsZWN0aW9uT2JzZXJ2ZXIodGhpcy5vYnNlcnZlckxvY2F0b3IsIGl0ZW1zKTtcclxuICAgICAgICBpZiAoIWNvbGxlY3Rpb25PYnNlcnZlcikge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBjb250ZXh0ID0gXCJoYW5kbGVJbm5lckNvbGxlY3Rpb25NdXRhdGVkXCI7XHJcbiAgICAgICAgdGhpcy5jb2xsZWN0aW9uT2JzZXJ2ZXIgPSBjb2xsZWN0aW9uT2JzZXJ2ZXI7XHJcbiAgICAgICAgdGhpcy5jYWxsQ29udGV4dCA9IGNvbnRleHQ7XHJcbiAgICAgICAgY29sbGVjdGlvbk9ic2VydmVyLnN1YnNjcmliZShjb250ZXh0LCB0aGlzKTtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH07XHJcbiAgICBWaXJ0dWFsUmVwZWF0LnByb3RvdHlwZS5fZ2V0SW5uZXJDb2xsZWN0aW9uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBleHByZXNzaW9uID0gdW53cmFwRXhwcmVzc2lvbih0aGlzLnNvdXJjZUV4cHJlc3Npb24pO1xyXG4gICAgICAgIGlmICghZXhwcmVzc2lvbikge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGV4cHJlc3Npb24uZXZhbHVhdGUodGhpcy5zY29wZSwgbnVsbCk7XHJcbiAgICB9O1xyXG4gICAgVmlydHVhbFJlcGVhdC5wcm90b3R5cGUuX29ic2VydmVDb2xsZWN0aW9uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBjb2xsZWN0aW9uT2JzZXJ2ZXIgPSB0aGlzLnN0cmF0ZWd5LmdldENvbGxlY3Rpb25PYnNlcnZlcih0aGlzLm9ic2VydmVyTG9jYXRvciwgdGhpcy5pdGVtcyk7XHJcbiAgICAgICAgaWYgKGNvbGxlY3Rpb25PYnNlcnZlcikge1xyXG4gICAgICAgICAgICB0aGlzLmNhbGxDb250ZXh0ID0gXCJoYW5kbGVDb2xsZWN0aW9uTXV0YXRlZFwiO1xyXG4gICAgICAgICAgICB0aGlzLmNvbGxlY3Rpb25PYnNlcnZlciA9IGNvbGxlY3Rpb25PYnNlcnZlcjtcclxuICAgICAgICAgICAgY29sbGVjdGlvbk9ic2VydmVyLnN1YnNjcmliZSh0aGlzLmNhbGxDb250ZXh0LCB0aGlzKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgVmlydHVhbFJlcGVhdC5wcm90b3R5cGUudmlld0NvdW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnZpZXdTbG90LmNoaWxkcmVuLmxlbmd0aDtcclxuICAgIH07XHJcbiAgICBWaXJ0dWFsUmVwZWF0LnByb3RvdHlwZS52aWV3cyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy52aWV3U2xvdC5jaGlsZHJlbjtcclxuICAgIH07XHJcbiAgICBWaXJ0dWFsUmVwZWF0LnByb3RvdHlwZS52aWV3ID0gZnVuY3Rpb24gKGluZGV4KSB7XHJcbiAgICAgICAgdmFyIHZpZXdTbG90ID0gdGhpcy52aWV3U2xvdDtcclxuICAgICAgICByZXR1cm4gaW5kZXggPCAwIHx8IGluZGV4ID4gdmlld1Nsb3QuY2hpbGRyZW4ubGVuZ3RoIC0gMSA/IG51bGwgOiB2aWV3U2xvdC5jaGlsZHJlbltpbmRleF07XHJcbiAgICB9O1xyXG4gICAgVmlydHVhbFJlcGVhdC5wcm90b3R5cGUuYWRkVmlldyA9IGZ1bmN0aW9uIChiaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KSB7XHJcbiAgICAgICAgdmFyIHZpZXcgPSB0aGlzLnZpZXdGYWN0b3J5LmNyZWF0ZSgpO1xyXG4gICAgICAgIHZpZXcuYmluZChiaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KTtcclxuICAgICAgICB0aGlzLnZpZXdTbG90LmFkZCh2aWV3KTtcclxuICAgICAgICByZXR1cm4gdmlldztcclxuICAgIH07XHJcbiAgICBWaXJ0dWFsUmVwZWF0LnByb3RvdHlwZS5pbnNlcnRWaWV3ID0gZnVuY3Rpb24gKGluZGV4LCBiaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KSB7XHJcbiAgICAgICAgdmFyIHZpZXcgPSB0aGlzLnZpZXdGYWN0b3J5LmNyZWF0ZSgpO1xyXG4gICAgICAgIHZpZXcuYmluZChiaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KTtcclxuICAgICAgICB0aGlzLnZpZXdTbG90Lmluc2VydChpbmRleCwgdmlldyk7XHJcbiAgICB9O1xyXG4gICAgVmlydHVhbFJlcGVhdC5wcm90b3R5cGUucmVtb3ZlQWxsVmlld3MgPSBmdW5jdGlvbiAocmV0dXJuVG9DYWNoZSwgc2tpcEFuaW1hdGlvbikge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnZpZXdTbG90LnJlbW92ZUFsbChyZXR1cm5Ub0NhY2hlLCBza2lwQW5pbWF0aW9uKTtcclxuICAgIH07XHJcbiAgICBWaXJ0dWFsUmVwZWF0LnByb3RvdHlwZS5yZW1vdmVWaWV3ID0gZnVuY3Rpb24gKGluZGV4LCByZXR1cm5Ub0NhY2hlLCBza2lwQW5pbWF0aW9uKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMudmlld1Nsb3QucmVtb3ZlQXQoaW5kZXgsIHJldHVyblRvQ2FjaGUsIHNraXBBbmltYXRpb24pO1xyXG4gICAgfTtcclxuICAgIFZpcnR1YWxSZXBlYXQucHJvdG90eXBlLnVwZGF0ZUJpbmRpbmdzID0gZnVuY3Rpb24gKHZpZXcpIHtcclxuICAgICAgICB2YXIgYmluZGluZ3MgPSB2aWV3LmJpbmRpbmdzO1xyXG4gICAgICAgIHZhciBqID0gYmluZGluZ3MubGVuZ3RoO1xyXG4gICAgICAgIHdoaWxlIChqLS0pIHtcclxuICAgICAgICAgICAgdXBkYXRlT25lVGltZUJpbmRpbmcoYmluZGluZ3Nbal0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgY29udHJvbGxlcnMgPSB2aWV3LmNvbnRyb2xsZXJzO1xyXG4gICAgICAgIGogPSBjb250cm9sbGVycy5sZW5ndGg7XHJcbiAgICAgICAgd2hpbGUgKGotLSkge1xyXG4gICAgICAgICAgICB2YXIgYm91bmRQcm9wZXJ0aWVzID0gY29udHJvbGxlcnNbal0uYm91bmRQcm9wZXJ0aWVzO1xyXG4gICAgICAgICAgICB2YXIgayA9IGJvdW5kUHJvcGVydGllcy5sZW5ndGg7XHJcbiAgICAgICAgICAgIHdoaWxlIChrLS0pIHtcclxuICAgICAgICAgICAgICAgIHZhciBiaW5kaW5nID0gYm91bmRQcm9wZXJ0aWVzW2tdLmJpbmRpbmc7XHJcbiAgICAgICAgICAgICAgICB1cGRhdGVPbmVUaW1lQmluZGluZyhiaW5kaW5nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICByZXR1cm4gVmlydHVhbFJlcGVhdDtcclxufShBYnN0cmFjdFJlcGVhdGVyKSk7XG5cbnZhciBJbmZpbml0ZVNjcm9sbE5leHQgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gSW5maW5pdGVTY3JvbGxOZXh0KCkge1xyXG4gICAgfVxyXG4gICAgSW5maW5pdGVTY3JvbGxOZXh0LiRyZXNvdXJjZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICB0eXBlOiAnYXR0cmlidXRlJyxcclxuICAgICAgICAgICAgbmFtZTogJ2luZmluaXRlLXNjcm9sbC1uZXh0J1xyXG4gICAgICAgIH07XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEluZmluaXRlU2Nyb2xsTmV4dDtcclxufSgpKTtcblxuZnVuY3Rpb24gY29uZmlndXJlKGNvbmZpZykge1xyXG4gICAgY29uZmlnLmdsb2JhbFJlc291cmNlcyhWaXJ0dWFsUmVwZWF0LCBJbmZpbml0ZVNjcm9sbE5leHQpO1xyXG59XG5cbmV4cG9ydCB7IGNvbmZpZ3VyZSwgVmlydHVhbFJlcGVhdCwgSW5maW5pdGVTY3JvbGxOZXh0LCBWaXJ0dWFsaXphdGlvbkV2ZW50cyB9O1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///aurelia-ui-virtualization\n");

/***/ }),

/***/ "xbL7":
/*!**************************************************************!*\
  !*** ./node_modules/linked-list-typescript/lib/src/index.js ***!
  \**************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\nObject.defineProperty(exports, \"__esModule\", { value: true });\nclass LinkedList {\n    constructor(...values) {\n        this._head = this._tail = null;\n        this._length = 0;\n        if (values.length > 0) {\n            values.forEach((value) => {\n                this.append(value);\n            });\n        }\n    }\n    *iterator() {\n        let currentItem = this._head;\n        while (currentItem) {\n            yield currentItem.value;\n            currentItem = currentItem.next;\n        }\n    }\n    [Symbol.iterator]() {\n        return this.iterator();\n    }\n    get head() {\n        return this._head ? this._head.value : null;\n    }\n    get tail() {\n        return this._tail ? this._tail.value : null;\n    }\n    get length() {\n        return this._length;\n    }\n    // Adds the element at a specific position inside the linked list\n    insert(val, previousItem, checkDuplicates = false) {\n        if (checkDuplicates && this.isDuplicate(val)) {\n            return false;\n        }\n        let newItem = new LinkedListItem(val);\n        let currentItem = this._head;\n        if (!currentItem) {\n            return false;\n        }\n        else {\n            while (true) {\n                if (currentItem.value === previousItem) {\n                    newItem.next = currentItem.next;\n                    newItem.prev = currentItem;\n                    currentItem.next = newItem;\n                    if (newItem.next) {\n                        newItem.next.prev = newItem;\n                    }\n                    else {\n                        this._tail = newItem;\n                    }\n                    this._length++;\n                    return true;\n                }\n                else {\n                    if (currentItem.next) {\n                        currentItem = currentItem.next;\n                    }\n                    else {\n                        // can't locate previousItem\n                        return false;\n                    }\n                }\n            }\n        }\n    }\n    // Adds the element at the end of the linked list\n    append(val, checkDuplicates = false) {\n        if (checkDuplicates && this.isDuplicate(val)) {\n            return false;\n        }\n        let newItem = new LinkedListItem(val);\n        if (!this._tail) {\n            this._head = this._tail = newItem;\n        }\n        else {\n            this._tail.next = newItem;\n            newItem.prev = this._tail;\n            this._tail = newItem;\n        }\n        this._length++;\n        return true;\n    }\n    // Add the element at the beginning of the linked list\n    prepend(val, checkDuplicates = false) {\n        if (checkDuplicates && this.isDuplicate(val)) {\n            return false;\n        }\n        let newItem = new LinkedListItem(val);\n        if (!this._head) {\n            this._head = this._tail = newItem;\n        }\n        else {\n            newItem.next = this._head;\n            this._head.prev = newItem;\n            this._head = newItem;\n        }\n        this._length++;\n        return true;\n    }\n    remove(val) {\n        let currentItem = this._head;\n        if (!currentItem) {\n            return;\n        }\n        if (currentItem.value === val) {\n            this._head = currentItem.next;\n            this._head.prev = null;\n            currentItem.next = currentItem.prev = null;\n            this._length--;\n            return currentItem.value;\n        }\n        else {\n            while (true) {\n                if (currentItem.value === val) {\n                    if (currentItem.next) { // special case for last element\n                        currentItem.prev.next = currentItem.next;\n                        currentItem.next.prev = currentItem.prev;\n                        currentItem.next = currentItem.prev = null;\n                    }\n                    else {\n                        currentItem.prev.next = null;\n                        this._tail = currentItem.prev;\n                        currentItem.next = currentItem.prev = null;\n                    }\n                    this._length--;\n                    return currentItem.value;\n                }\n                else {\n                    if (currentItem.next) {\n                        currentItem = currentItem.next;\n                    }\n                    else {\n                        return;\n                    }\n                }\n            }\n        }\n    }\n    removeHead() {\n        let currentItem = this._head;\n        // empty list\n        if (!currentItem) {\n            return;\n        }\n        // single item list\n        if (!this._head.next) {\n            this._head = null;\n            this._tail = null;\n            // full list\n        }\n        else {\n            this._head.next.prev = null;\n            this._head = this._head.next;\n            currentItem.next = currentItem.prev = null;\n        }\n        this._length--;\n        return currentItem.value;\n    }\n    removeTail() {\n        let currentItem = this._tail;\n        // empty list\n        if (!currentItem) {\n            return;\n        }\n        // single item list\n        if (!this._tail.prev) {\n            this._head = null;\n            this._tail = null;\n            // full list\n        }\n        else {\n            this._tail.prev.next = null;\n            this._tail = this._tail.prev;\n            currentItem.next = currentItem.prev = null;\n        }\n        this._length--;\n        return currentItem.value;\n    }\n    first(num) {\n        let iter = this.iterator();\n        let result = [];\n        let n = Math.min(num, this.length);\n        for (let i = 0; i < n; i++) {\n            let val = iter.next();\n            result.push(val.value);\n        }\n        return result;\n    }\n    toArray() {\n        return [...this];\n    }\n    isDuplicate(val) {\n        let set = new Set(this.toArray());\n        return set.has(val);\n    }\n}\nexports.LinkedList = LinkedList;\nclass LinkedListItem {\n    constructor(val) {\n        this.value = val;\n        this.next = null;\n        this.prev = null;\n    }\n}\nexports.LinkedListItem = LinkedListItem;\n//# sourceMappingURL=index.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoieGJMNy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9saW5rZWQtbGlzdC10eXBlc2NyaXB0L2xpYi9zcmMvaW5kZXguanM/YzViMiJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmNsYXNzIExpbmtlZExpc3Qge1xuICAgIGNvbnN0cnVjdG9yKC4uLnZhbHVlcykge1xuICAgICAgICB0aGlzLl9oZWFkID0gdGhpcy5fdGFpbCA9IG51bGw7XG4gICAgICAgIHRoaXMuX2xlbmd0aCA9IDA7XG4gICAgICAgIGlmICh2YWx1ZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdmFsdWVzLmZvckVhY2goKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hcHBlbmQodmFsdWUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgKml0ZXJhdG9yKCkge1xuICAgICAgICBsZXQgY3VycmVudEl0ZW0gPSB0aGlzLl9oZWFkO1xuICAgICAgICB3aGlsZSAoY3VycmVudEl0ZW0pIHtcbiAgICAgICAgICAgIHlpZWxkIGN1cnJlbnRJdGVtLnZhbHVlO1xuICAgICAgICAgICAgY3VycmVudEl0ZW0gPSBjdXJyZW50SXRlbS5uZXh0O1xuICAgICAgICB9XG4gICAgfVxuICAgIFtTeW1ib2wuaXRlcmF0b3JdKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pdGVyYXRvcigpO1xuICAgIH1cbiAgICBnZXQgaGVhZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2hlYWQgPyB0aGlzLl9oZWFkLnZhbHVlIDogbnVsbDtcbiAgICB9XG4gICAgZ2V0IHRhaWwoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl90YWlsID8gdGhpcy5fdGFpbC52YWx1ZSA6IG51bGw7XG4gICAgfVxuICAgIGdldCBsZW5ndGgoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9sZW5ndGg7XG4gICAgfVxuICAgIC8vIEFkZHMgdGhlIGVsZW1lbnQgYXQgYSBzcGVjaWZpYyBwb3NpdGlvbiBpbnNpZGUgdGhlIGxpbmtlZCBsaXN0XG4gICAgaW5zZXJ0KHZhbCwgcHJldmlvdXNJdGVtLCBjaGVja0R1cGxpY2F0ZXMgPSBmYWxzZSkge1xuICAgICAgICBpZiAoY2hlY2tEdXBsaWNhdGVzICYmIHRoaXMuaXNEdXBsaWNhdGUodmFsKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGxldCBuZXdJdGVtID0gbmV3IExpbmtlZExpc3RJdGVtKHZhbCk7XG4gICAgICAgIGxldCBjdXJyZW50SXRlbSA9IHRoaXMuX2hlYWQ7XG4gICAgICAgIGlmICghY3VycmVudEl0ZW0pIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRJdGVtLnZhbHVlID09PSBwcmV2aW91c0l0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3SXRlbS5uZXh0ID0gY3VycmVudEl0ZW0ubmV4dDtcbiAgICAgICAgICAgICAgICAgICAgbmV3SXRlbS5wcmV2ID0gY3VycmVudEl0ZW07XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRJdGVtLm5leHQgPSBuZXdJdGVtO1xuICAgICAgICAgICAgICAgICAgICBpZiAobmV3SXRlbS5uZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdJdGVtLm5leHQucHJldiA9IG5ld0l0ZW07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl90YWlsID0gbmV3SXRlbTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9sZW5ndGgrKztcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudEl0ZW0ubmV4dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEl0ZW0gPSBjdXJyZW50SXRlbS5uZXh0O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2FuJ3QgbG9jYXRlIHByZXZpb3VzSXRlbVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIC8vIEFkZHMgdGhlIGVsZW1lbnQgYXQgdGhlIGVuZCBvZiB0aGUgbGlua2VkIGxpc3RcbiAgICBhcHBlbmQodmFsLCBjaGVja0R1cGxpY2F0ZXMgPSBmYWxzZSkge1xuICAgICAgICBpZiAoY2hlY2tEdXBsaWNhdGVzICYmIHRoaXMuaXNEdXBsaWNhdGUodmFsKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGxldCBuZXdJdGVtID0gbmV3IExpbmtlZExpc3RJdGVtKHZhbCk7XG4gICAgICAgIGlmICghdGhpcy5fdGFpbCkge1xuICAgICAgICAgICAgdGhpcy5faGVhZCA9IHRoaXMuX3RhaWwgPSBuZXdJdGVtO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fdGFpbC5uZXh0ID0gbmV3SXRlbTtcbiAgICAgICAgICAgIG5ld0l0ZW0ucHJldiA9IHRoaXMuX3RhaWw7XG4gICAgICAgICAgICB0aGlzLl90YWlsID0gbmV3SXRlbTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9sZW5ndGgrKztcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIC8vIEFkZCB0aGUgZWxlbWVudCBhdCB0aGUgYmVnaW5uaW5nIG9mIHRoZSBsaW5rZWQgbGlzdFxuICAgIHByZXBlbmQodmFsLCBjaGVja0R1cGxpY2F0ZXMgPSBmYWxzZSkge1xuICAgICAgICBpZiAoY2hlY2tEdXBsaWNhdGVzICYmIHRoaXMuaXNEdXBsaWNhdGUodmFsKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGxldCBuZXdJdGVtID0gbmV3IExpbmtlZExpc3RJdGVtKHZhbCk7XG4gICAgICAgIGlmICghdGhpcy5faGVhZCkge1xuICAgICAgICAgICAgdGhpcy5faGVhZCA9IHRoaXMuX3RhaWwgPSBuZXdJdGVtO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbmV3SXRlbS5uZXh0ID0gdGhpcy5faGVhZDtcbiAgICAgICAgICAgIHRoaXMuX2hlYWQucHJldiA9IG5ld0l0ZW07XG4gICAgICAgICAgICB0aGlzLl9oZWFkID0gbmV3SXRlbTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9sZW5ndGgrKztcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJlbW92ZSh2YWwpIHtcbiAgICAgICAgbGV0IGN1cnJlbnRJdGVtID0gdGhpcy5faGVhZDtcbiAgICAgICAgaWYgKCFjdXJyZW50SXRlbSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjdXJyZW50SXRlbS52YWx1ZSA9PT0gdmFsKSB7XG4gICAgICAgICAgICB0aGlzLl9oZWFkID0gY3VycmVudEl0ZW0ubmV4dDtcbiAgICAgICAgICAgIHRoaXMuX2hlYWQucHJldiA9IG51bGw7XG4gICAgICAgICAgICBjdXJyZW50SXRlbS5uZXh0ID0gY3VycmVudEl0ZW0ucHJldiA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl9sZW5ndGgtLTtcbiAgICAgICAgICAgIHJldHVybiBjdXJyZW50SXRlbS52YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRJdGVtLnZhbHVlID09PSB2YWwpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRJdGVtLm5leHQpIHsgLy8gc3BlY2lhbCBjYXNlIGZvciBsYXN0IGVsZW1lbnRcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRJdGVtLnByZXYubmV4dCA9IGN1cnJlbnRJdGVtLm5leHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50SXRlbS5uZXh0LnByZXYgPSBjdXJyZW50SXRlbS5wcmV2O1xuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEl0ZW0ubmV4dCA9IGN1cnJlbnRJdGVtLnByZXYgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEl0ZW0ucHJldi5uZXh0ID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3RhaWwgPSBjdXJyZW50SXRlbS5wcmV2O1xuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEl0ZW0ubmV4dCA9IGN1cnJlbnRJdGVtLnByZXYgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2xlbmd0aC0tO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY3VycmVudEl0ZW0udmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudEl0ZW0ubmV4dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEl0ZW0gPSBjdXJyZW50SXRlbS5uZXh0O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJlbW92ZUhlYWQoKSB7XG4gICAgICAgIGxldCBjdXJyZW50SXRlbSA9IHRoaXMuX2hlYWQ7XG4gICAgICAgIC8vIGVtcHR5IGxpc3RcbiAgICAgICAgaWYgKCFjdXJyZW50SXRlbSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIC8vIHNpbmdsZSBpdGVtIGxpc3RcbiAgICAgICAgaWYgKCF0aGlzLl9oZWFkLm5leHQpIHtcbiAgICAgICAgICAgIHRoaXMuX2hlYWQgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fdGFpbCA9IG51bGw7XG4gICAgICAgICAgICAvLyBmdWxsIGxpc3RcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX2hlYWQubmV4dC5wcmV2ID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX2hlYWQgPSB0aGlzLl9oZWFkLm5leHQ7XG4gICAgICAgICAgICBjdXJyZW50SXRlbS5uZXh0ID0gY3VycmVudEl0ZW0ucHJldiA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fbGVuZ3RoLS07XG4gICAgICAgIHJldHVybiBjdXJyZW50SXRlbS52YWx1ZTtcbiAgICB9XG4gICAgcmVtb3ZlVGFpbCgpIHtcbiAgICAgICAgbGV0IGN1cnJlbnRJdGVtID0gdGhpcy5fdGFpbDtcbiAgICAgICAgLy8gZW1wdHkgbGlzdFxuICAgICAgICBpZiAoIWN1cnJlbnRJdGVtKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgLy8gc2luZ2xlIGl0ZW0gbGlzdFxuICAgICAgICBpZiAoIXRoaXMuX3RhaWwucHJldikge1xuICAgICAgICAgICAgdGhpcy5faGVhZCA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl90YWlsID0gbnVsbDtcbiAgICAgICAgICAgIC8vIGZ1bGwgbGlzdFxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fdGFpbC5wcmV2Lm5leHQgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fdGFpbCA9IHRoaXMuX3RhaWwucHJldjtcbiAgICAgICAgICAgIGN1cnJlbnRJdGVtLm5leHQgPSBjdXJyZW50SXRlbS5wcmV2ID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9sZW5ndGgtLTtcbiAgICAgICAgcmV0dXJuIGN1cnJlbnRJdGVtLnZhbHVlO1xuICAgIH1cbiAgICBmaXJzdChudW0pIHtcbiAgICAgICAgbGV0IGl0ZXIgPSB0aGlzLml0ZXJhdG9yKCk7XG4gICAgICAgIGxldCByZXN1bHQgPSBbXTtcbiAgICAgICAgbGV0IG4gPSBNYXRoLm1pbihudW0sIHRoaXMubGVuZ3RoKTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBuOyBpKyspIHtcbiAgICAgICAgICAgIGxldCB2YWwgPSBpdGVyLm5leHQoKTtcbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKHZhbC52YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgdG9BcnJheSgpIHtcbiAgICAgICAgcmV0dXJuIFsuLi50aGlzXTtcbiAgICB9XG4gICAgaXNEdXBsaWNhdGUodmFsKSB7XG4gICAgICAgIGxldCBzZXQgPSBuZXcgU2V0KHRoaXMudG9BcnJheSgpKTtcbiAgICAgICAgcmV0dXJuIHNldC5oYXModmFsKTtcbiAgICB9XG59XG5leHBvcnRzLkxpbmtlZExpc3QgPSBMaW5rZWRMaXN0O1xuY2xhc3MgTGlua2VkTGlzdEl0ZW0ge1xuICAgIGNvbnN0cnVjdG9yKHZhbCkge1xuICAgICAgICB0aGlzLnZhbHVlID0gdmFsO1xuICAgICAgICB0aGlzLm5leHQgPSBudWxsO1xuICAgICAgICB0aGlzLnByZXYgPSBudWxsO1xuICAgIH1cbn1cbmV4cG9ydHMuTGlua2VkTGlzdEl0ZW0gPSBMaW5rZWRMaXN0SXRlbTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcCJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///xbL7\n");

/***/ })

}]);